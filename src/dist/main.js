/*! For license information please see main.js.LICENSE.txt */
(()=>{var t={377:(t,e,n)=>{var i=n(832),r=n(652),s=n(801),o=n(30),a=n(618),c=n(49),h=n(971);h.alea=i,h.xor128=r,h.xorwow=s,h.xorshift7=o,h.xor4096=a,h.tychei=c,t.exports=h},832:function(t,e,n){var i;!function(t,r,s){function o(t){var e,n=this,i=(e=4022871197,function(t){t=String(t);for(var n=0;n<t.length;n++){var i=.02519603282416938*(e+=t.charCodeAt(n));i-=e=i>>>0,e=(i*=e)>>>0,e+=4294967296*(i-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=i(" "),n.s1=i(" "),n.s2=i(" "),n.s0-=i(t),n.s0<0&&(n.s0+=1),n.s1-=i(t),n.s1<0&&(n.s1+=1),n.s2-=i(t),n.s2<0&&(n.s2+=1),i=null}function a(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function c(t,e){var n=new o(t),i=e&&e.state,r=n.next;return r.int32=function(){return 4294967296*n.next()|0},r.double=function(){return r()+11102230246251565e-32*(2097152*r()|0)},r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n.amdD&&n.amdO?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.alea=c}(0,t=n.nmd(t),n.amdD)},49:function(t,e,n){var i;!function(t,r,s){function o(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,i=e.d,r=e.a;return t=t<<25^t>>>7^n,n=n-i|0,i=i<<24^i>>>8^r,r=r-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-i|0,e.d=i<<16^n>>>16^r,e.a=r-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var i=0;i<n.length+20;i++)e.b^=0|n.charCodeAt(i),e.next()}function a(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function c(t,e){var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n.amdD&&n.amdO?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.tychei=c}(0,t=n.nmd(t),n.amdD)},652:function(t,e,n){var i;!function(t,r,s){function o(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var i=0;i<n.length+64;i++)e.x^=0|n.charCodeAt(i),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function c(t,e){var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n.amdD&&n.amdO?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.xor128=c}(0,t=n.nmd(t),n.amdD)},618:function(t,e,n){var i;!function(t,r,s){function o(t){var e=this;e.next=function(){var t,n,i=e.w,r=e.X,s=e.i;return e.w=i=i+1640531527|0,n=r[s+34&127],t=r[s=s+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=r[s]=n^t,e.i=s,n+(i^i>>>16)|0},function(t,e){var n,i,r,s,o,a=[],c=128;for(e===(0|e)?(i=e,e=null):(e+="\0",i=0,c=Math.max(c,e.length)),r=0,s=-32;s<c;++s)e&&(i^=e.charCodeAt((s+32)%e.length)),0===s&&(o=i),i^=i<<10,i^=i>>>15,i^=i<<4,i^=i>>>13,s>=0&&(o=o+1640531527|0,r=0==(n=a[127&s]^=i+o)?r+1:0);for(r>=128&&(a[127&(e&&e.length||0)]=-1),r=127,s=512;s>0;--s)i=a[r+34&127],n=a[r=r+1&127],i^=i<<13,n^=n<<17,i^=i>>>15,n^=n>>>12,a[r]=i^n;t.w=o,t.X=a,t.i=r}(e,t)}function a(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function c(t,e){null==t&&(t=+new Date);var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&(i.X&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n.amdD&&n.amdO?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.xor4096=c}(0,t=n.nmd(t),n.amdD)},30:function(t,e,n){var i;!function(t,r,s){function o(t){var e=this;e.next=function(){var t,n,i=e.x,r=e.i;return t=i[r],n=(t^=t>>>7)^t<<24,n^=(t=i[r+1&7])^t>>>10,n^=(t=i[r+3&7])^t>>>3,n^=(t=i[r+4&7])^t<<7,t=i[r+7&7],n^=(t^=t<<13)^t<<9,i[r]=n,e.i=r+1&7,n},function(t,e){var n,i=[];if(e===(0|e))i[0]=e;else for(e=""+e,n=0;n<e.length;++n)i[7&n]=i[7&n]<<15^e.charCodeAt(n)+i[n+1&7]<<13;for(;i.length<8;)i.push(0);for(n=0;n<8&&0===i[n];++n);for(8==n?i[7]=-1:i[n],t.x=i,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function a(t,e){return e.x=t.x.slice(),e.i=t.i,e}function c(t,e){null==t&&(t=+new Date);var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&(i.x&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n.amdD&&n.amdO?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.xorshift7=c}(0,t=n.nmd(t),n.amdD)},801:function(t,e,n){var i;!function(t,r,s){function o(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var i=0;i<n.length+64;i++)e.x^=0|n.charCodeAt(i),i==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function c(t,e){var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n.amdD&&n.amdO?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.xorwow=c}(0,t=n.nmd(t),n.amdD)},971:function(t,e,n){var i;!function(r,s,o){var a,c=256,h=o.pow(c,6),u=o.pow(2,52),l=2*u,d=255;function f(t,e,n){var i=[],d=y(g((e=1==e?{entropy:!0}:e||{}).entropy?[t,v(s)]:null==t?function(){try{var t;return a&&(t=a.randomBytes)?t=t(c):(t=new Uint8Array(c),(r.crypto||r.msCrypto).getRandomValues(t)),v(t)}catch(t){var e=r.navigator,n=e&&e.plugins;return[+new Date,r,n,r.screen,v(s)]}}():t,3),i),f=new p(i),w=function(){for(var t=f.g(6),e=h,n=0;t<u;)t=(t+n)*c,e*=c,n=f.g(1);for(;t>=l;)t/=2,e/=2,n>>>=1;return(t+n)/e};return w.int32=function(){return 0|f.g(4)},w.quick=function(){return f.g(4)/4294967296},w.double=w,y(v(f.S),s),(e.pass||n||function(t,e,n,i){return i&&(i.S&&m(i,f),t.state=function(){return m(f,{})}),n?(o.random=t,e):t})(w,d,"global"in e?e.global:this==o,e.state)}function p(t){var e,n=t.length,i=this,r=0,s=i.i=i.j=0,o=i.S=[];for(n||(t=[n++]);r<c;)o[r]=r++;for(r=0;r<c;r++)o[r]=o[s=d&s+t[r%n]+(e=o[r])],o[s]=e;(i.g=function(t){for(var e,n=0,r=i.i,s=i.j,o=i.S;t--;)e=o[r=d&r+1],n=n*c+o[d&(o[r]=o[s=d&s+e])+(o[s]=e)];return i.i=r,i.j=s,n})(c)}function m(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function g(t,e){var n,i=[],r=typeof t;if(e&&"object"==r)for(n in t)try{i.push(g(t[n],e-1))}catch(t){}return i.length?i:"string"==r?t:t+"\0"}function y(t,e){for(var n,i=t+"",r=0;r<i.length;)e[d&r]=d&(n^=19*e[d&r])+i.charCodeAt(r++);return v(e)}function v(t){return String.fromCharCode.apply(0,t)}if(y(o.random(),s),t.exports){t.exports=f;try{a=n(42)}catch(t){}}else void 0===(i=function(){return f}.call(e,n,e,t))||(t.exports=i)}("undefined"!=typeof self?self:this,[],Math)},42:()=>{}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var s=e[i]={id:i,loaded:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{"use strict";const t={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let e=0;e<t.length;e+=3){const r=t[e],s=e+1<t.length,o=s?t[e+1]:0,a=e+2<t.length,c=a?t[e+2]:0,h=r>>2,u=(3&r)<<4|o>>4;let l=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(l=64)),i.push(n[h],n[u],n[l],n[d])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):55296==(64512&r)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&t.charCodeAt(++i)),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128)}return e}(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=t[n++];e[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const s=((7&r)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(s>>10)),e[i++]=String.fromCharCode(56320+(1023&s))}else{const s=t[n++],o=t[n++];e[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let e=0;e<t.length;){const r=n[t.charAt(e++)],s=e<t.length?n[t.charAt(e)]:0;++e;const o=e<t.length?n[t.charAt(e)]:64;++e;const a=e<t.length?n[t.charAt(e)]:64;if(++e,null==r||null==s||null==o||null==a)throw Error();const c=r<<2|s>>4;if(i.push(c),64!==o){const t=s<<4&240|o>>2;if(i.push(t),64!==a){const t=o<<6&192|a;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class e{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function i(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function r(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(i())}function s(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function o(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function a(){const t=i();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}class c extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,c.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,h.prototype.create)}}class h{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,r=this.errors[t],s=r?function(t,e){return t.replace(u,((t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`}))}(r,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new c(i,o,n)}}const u=/\{\$([^}]+)}/g;function l(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const r of n){if(!i.includes(r))return!1;const n=t[r],s=e[r];if(d(n)&&d(s)){if(!l(n,s))return!1}else if(n!==s)return!1}for(const t of i)if(!n.includes(t))return!1;return!0}function d(t){return null!==t&&"object"==typeof t}function f(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach((t=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))})):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function p(t){const e={};return t.replace(/^\?/,"").split("&").forEach((t=>{if(t){const[n,i]=t.split("=");e[decodeURIComponent(n)]=decodeURIComponent(i)}})),e}function m(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}class g{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((()=>{t(this)})).catch((t=>{this.error(t)}))}next(t){this.forEachObserver((e=>{e.next(t)}))}error(t){this.forEachObserver((e=>{e.error(t)})),this.close(t)}complete(){this.forEachObserver((t=>{t.complete()})),this.close()}subscribe(t,e,n){let i;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");i=function(t,e){if("object"!=typeof t||null===t)return!1;for(const e of["next","error","complete"])if(e in t&&"function"==typeof t[e])return!0;return!1}(t)?t:{next:t,error:e,complete:n},void 0===i.next&&(i.next=y),void 0===i.error&&(i.error=y),void 0===i.complete&&(i.complete=y);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(t){}})),this.observers.push(i),r}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function y(){}function v(t){return t&&t._delegate?t._delegate:t}class w{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const T="[DEFAULT]";class I{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const t=new e;if(this.instancesDeferred.set(n,t),this.isInitialized(n)||this.shouldAutoInitialize())try{const e=this.getOrInitializeService({instanceIdentifier:n});e&&t.resolve(e)}catch(t){}}return this.instancesDeferred.get(n).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(i)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:T})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t="[DEFAULT]"){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t="[DEFAULT]"){return this.instances.has(t)}getOptions(t="[DEFAULT]"){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(i);return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(t),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&t(s,i),()=>{r.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===T?void 0:i),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var i;return n||null}normalizeInstanceIdentifier(t="[DEFAULT]"){return this.component?this.component.multipleInstances?t:T:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class b{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new I(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const E=[];var _,S;(S=_||(_={}))[S.DEBUG=0]="DEBUG",S[S.VERBOSE=1]="VERBOSE",S[S.INFO=2]="INFO",S[S.WARN=3]="WARN",S[S.ERROR=4]="ERROR",S[S.SILENT=5]="SILENT";const k={debug:_.DEBUG,verbose:_.VERBOSE,info:_.INFO,warn:_.WARN,error:_.ERROR,silent:_.SILENT},A=_.INFO,C={[_.DEBUG]:"log",[_.VERBOSE]:"log",[_.INFO]:"info",[_.WARN]:"warn",[_.ERROR]:"error"},N=(t,e,...n)=>{if(e<t.logLevel)return;const i=(new Date).toISOString(),r=C[e];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[r](`[${i}]  ${t.name}:`,...n)};class D{constructor(t){this.name=t,this._logLevel=A,this._logHandler=N,this._userLogHandler=null,E.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in _))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?k[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,_.DEBUG,...t),this._logHandler(this,_.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,_.VERBOSE,...t),this._logHandler(this,_.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,_.INFO,...t),this._logHandler(this,_.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,_.WARN,...t),this._logHandler(this,_.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,_.ERROR,...t),this._logHandler(this,_.ERROR,...t)}}class R{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const O="@firebase/app",P="0.7.14",L=new D("@firebase/app"),M={[O]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},x=new Map,U=new Map;function F(t,e){try{t.container.addComponent(e)}catch(n){L.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function V(t){const e=t.name;if(U.has(e))return L.debug(`There were multiple attempts to register component ${e}.`),!1;U.set(e,t);for(const e of x.values())F(e,t);return!0}function q(t,e){return t.container.getProvider(e)}const B=new h("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function."});class j{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new w("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw B.create("app-deleted",{appName:this._name})}}const G="9.6.4";function H(t="[DEFAULT]"){const e=x.get(t);if(!e)throw B.create("no-app",{appName:t});return e}function z(t,e,n){var i;let r=null!==(i=M[t])&&void 0!==i?i:t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const t=[`Unable to register library "${r}" with version "${e}":`];return s&&t.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void L.warn(t.join(" "))}V(new w(`${r}-version`,(()=>({library:r,version:e})),"VERSION"))}function K(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}V(new w("platform-logger",(t=>new R(t)),"PRIVATE")),z(O,P,""),z(O,P,"esm2017"),z("fire-js",""),z("firebase","9.6.4","app"),Object.create,Object.create;const $=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},W=new h("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),X=new D("@firebase/auth");function J(t,...e){X.logLevel<=_.ERROR&&X.error(`Auth (9.6.4): ${t}`,...e)}function Q(t,...e){throw tt(t,...e)}function Y(t,...e){return tt(t,...e)}function Z(t,e,n){const i=Object.assign(Object.assign({},$()),{[e]:n});return new h("auth","Firebase",i).create(e,{appName:t.name})}function tt(t,...e){if("string"!=typeof t){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return W.create(t,...e)}function et(t,e,...n){if(!t)throw tt(e,...n)}function nt(t){const e="INTERNAL ASSERTION FAILED: "+t;throw J(e),new Error(e)}function it(t,e){t||nt(e)}const rt=new Map;function st(t){it(t instanceof Function,"Expected a class definition");let e=rt.get(t);return e?(it(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,rt.set(t,e),e)}function ot(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function at(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}class ct{constructor(t,e){this.shortDelay=t,this.longDelay=e,it(e>t,"Short delay should be less than long delay!"),this.isMobile=r()||o()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===at()||"https:"===at()||s()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function ht(t,e){it(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class ut{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void nt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void nt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void nt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const lt={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},dt=new ct(3e4,6e4);function ft(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function pt(t,e,n,i,r={}){return mt(t,r,(async()=>{let r={},s={};i&&("GET"===e?s=i:r={body:JSON.stringify(i)});const o=f(Object.assign({key:t.config.apiKey},s)).slice(1),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/json",t.languageCode&&(a["X-Firebase-Locale"]=t.languageCode),ut.fetch()(yt(t,t.config.apiHost,n,o),Object.assign({method:e,headers:a,referrerPolicy:"no-referrer"},r))}))}async function mt(t,e,n){t._canInitEmulator=!1;const i=Object.assign(Object.assign({},lt),e);try{const e=new vt(t),r=await Promise.race([n(),e.promise]);e.clearNetworkTimeout();const s=await r.json();if("needConfirmation"in s)throw wt(t,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const e=r.ok?s.errorMessage:s.error.message,[n,o]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw wt(t,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw wt(t,"email-already-in-use",s);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw Z(t,a,o);Q(t,a)}}catch(e){if(e instanceof c)throw e;Q(t,"network-request-failed")}}async function gt(t,e,n,i,r={}){const s=await pt(t,e,n,i,r);return"mfaPendingCredential"in s&&Q(t,"multi-factor-auth-required",{_serverResponse:s}),s}function yt(t,e,n,i){const r=`${e}${n}?${i}`;return t.config.emulator?ht(t.config,r):`${t.config.apiScheme}://${r}`}class vt{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise(((t,e)=>{this.timer=setTimeout((()=>e(Y(this.auth,"network-request-failed"))),dt.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function wt(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=Y(t,e,i);return r.customData._tokenResponse=n,r}function Tt(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(t){}}function It(t){return 1e3*Number(t)}function bt(e){const[n,i,r]=e.split(".");if(void 0===n||void 0===i||void 0===r)return J("JWT malformed, contained fewer than 3 sections"),null;try{const e=function(e){try{return t.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}(i);return e?JSON.parse(e):(J("Failed to decode base64 JWT payload"),null)}catch(t){return J("Caught error parsing JWT payload as JSON",t),null}}async function Et(t,e,n=!1){if(n)return e;try{return await e}catch(e){throw e instanceof c&&function({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}(e)&&t.auth.currentUser===t&&await t.auth.signOut(),e}}class _t{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout((async()=>{await this.iteration()}),e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===t.code&&this.schedule(!0))}this.schedule()}}class St{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=Tt(this.lastLoginAt),this.creationTime=Tt(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function kt(t){var e;const n=t.auth,i=await t.getIdToken(),r=await Et(t,async function(t,e){return pt(t,"POST","/v1/accounts:lookup",e)}(n,{idToken:i}));et(null==r?void 0:r.users.length,n,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const o=(null===(e=s.providerUserInfo)||void 0===e?void 0:e.length)?s.providerUserInfo.map((t=>{var{providerId:e}=t,n=K(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=(c=t.providerData,h=o,[...c.filter((t=>!h.some((e=>e.providerId===t.providerId)))),...h]);var c,h;const u=t.isAnonymous,l=!(t.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!u&&l,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new St(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,f)}class At{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){et(t.idToken,"internal-error"),et(void 0!==t.idToken,"internal-error"),et(void 0!==t.refreshToken,"internal-error");const e="expiresIn"in t&&void 0!==t.expiresIn?Number(t.expiresIn):function(t){const e=bt(t);return et(e,"internal-error"),et(void 0!==e.exp,"internal-error"),et(void 0!==e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}async getToken(t,e=!1){return et(!this.accessToken||this.refreshToken,t,"user-token-expired"),e||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:i,expiresIn:r}=await async function(t,e){const n=await mt(t,{},(async()=>{const n=f({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:r}=t.config,s=yt(t,i,"/v1/token",`key=${r}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",ut.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(t,e);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:i,expirationTime:r}=e,s=new At;return n&&(et("string"==typeof n,"internal-error",{appName:t}),s.refreshToken=n),i&&(et("string"==typeof i,"internal-error",{appName:t}),s.accessToken=i),r&&(et("number"==typeof r,"internal-error",{appName:t}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new At,this.toJSON())}_performRefresh(){return nt("not implemented")}}function Ct(t,e){et("string"==typeof t||void 0===t,"internal-error",{appName:e})}class Nt{constructor(t){var{uid:e,auth:n,stsTokenManager:i}=t,r=K(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new _t(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.metadata=new St(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(t){const e=await Et(this,this.stsTokenManager.getToken(this.auth,t));return et(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return async function(t,e=!1){const n=v(t),i=await n.getIdToken(e),r=bt(i);et(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const s="object"==typeof r.firebase?r.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:Tt(It(r.auth_time)),issuedAtTime:Tt(It(r.iat)),expirationTime:Tt(It(r.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,t)}reload(){return async function(t){const e=v(t);await kt(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}(this)}_assign(t){this!==t&&(et(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map((t=>Object.assign({},t))),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){return new Nt(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(t){et(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await kt(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const t=await this.getIdToken();return await Et(this,async function(t,e){return pt(t,"POST","/v1/accounts:delete",e)}(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((t=>Object.assign({},t))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,i,r,s,o,a,c,h;const u=null!==(n=e.displayName)&&void 0!==n?n:void 0,l=null!==(i=e.email)&&void 0!==i?i:void 0,d=null!==(r=e.phoneNumber)&&void 0!==r?r:void 0,f=null!==(s=e.photoURL)&&void 0!==s?s:void 0,p=null!==(o=e.tenantId)&&void 0!==o?o:void 0,m=null!==(a=e._redirectEventId)&&void 0!==a?a:void 0,g=null!==(c=e.createdAt)&&void 0!==c?c:void 0,y=null!==(h=e.lastLoginAt)&&void 0!==h?h:void 0,{uid:v,emailVerified:w,isAnonymous:T,providerData:I,stsTokenManager:b}=e;et(v&&b,t,"internal-error");const E=At.fromJSON(this.name,b);et("string"==typeof v,t,"internal-error"),Ct(u,t.name),Ct(l,t.name),et("boolean"==typeof w,t,"internal-error"),et("boolean"==typeof T,t,"internal-error"),Ct(d,t.name),Ct(f,t.name),Ct(p,t.name),Ct(m,t.name),Ct(g,t.name),Ct(y,t.name);const _=new Nt({uid:v,auth:t,email:l,emailVerified:w,displayName:u,isAnonymous:T,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:E,createdAt:g,lastLoginAt:y});return I&&Array.isArray(I)&&(_.providerData=I.map((t=>Object.assign({},t)))),m&&(_._redirectEventId=m),_}static async _fromIdTokenResponse(t,e,n=!1){const i=new At;i.updateFromServerResponse(e);const r=new Nt({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:n});return await kt(r),r}}class Dt{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return void 0===e?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}Dt.type="NONE";const Rt=Dt;function Ot(t,e,n){return`firebase:${t}:${e}:${n}`}class Pt{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=Ot(this.userKey,i.apiKey,r),this.fullPersistenceKey=Ot("persistence",i.apiKey,r),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?Nt._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=t,e?this.setCurrentUser(e):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,n="authUser"){if(!e.length)return new Pt(st(Rt),t,n);const i=(await Promise.all(e.map((async t=>{if(await t._isAvailable())return t})))).filter((t=>t));let r=i[0]||st(Rt);const s=Ot(n,t.config.apiKey,t.name);let o=null;for(const n of e)try{const e=await n._get(s);if(e){const i=Nt._fromJSON(t,e);n!==r&&(o=i),r=n;break}}catch(t){}const a=i.filter((t=>t._shouldAllowMigration));return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(e.map((async t=>{if(t!==r)try{await t._remove(s)}catch(t){}}))),new Pt(r,t,n)):new Pt(r,t,n)}}function Lt(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Ft(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Mt(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(qt(e))return"Blackberry";if(Bt(e))return"Webos";if(xt(e))return"Safari";if((e.includes("chrome/")||Ut(e))&&!e.includes("edge/"))return"Chrome";if(Vt(e))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(e);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function Mt(t=i()){return/firefox\//i.test(t)}function xt(t=i()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Ut(t=i()){return/crios\//i.test(t)}function Ft(t=i()){return/iemobile/i.test(t)}function Vt(t=i()){return/android/i.test(t)}function qt(t=i()){return/blackberry/i.test(t)}function Bt(t=i()){return/webos/i.test(t)}function jt(t=i()){return/iphone|ipad|ipod/i.test(t)}function Gt(t=i()){return jt(t)||Vt(t)||Bt(t)||qt(t)||/windows phone/i.test(t)||Ft(t)}function Ht(t,e=[]){let n;switch(t){case"Browser":n=Lt(i());break;case"Worker":n=`${Lt(i())}-${t}`;break;default:n=t}return`${n}/JsCore/9.6.4/${e.length?e.join(","):"FirebaseCore-web"}`}class zt{constructor(t,e){this.app=t,this.config=e,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new $t(this),this.idTokenSubscription=new $t(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=W,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=e.sdkClientVersion}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=st(e)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Pt.create(this,t),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(t){}await this.initializeCurrentUser(e),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();return this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(t):void 0}async initializeCurrentUser(t){var e;let n=await this.assertedPersistence.getCurrentUser();if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,r=null==n?void 0:n._redirectEventId,s=await this.tryRedirectSignIn(t);i&&i!==r||!(null==s?void 0:s.user)||(n=s.user)}return n?n._redirectEventId?(et(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)):this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch(t){await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await kt(t)}catch(t){if("auth/network-request-failed"!==t.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const e=t?v(t):null;return e&&et(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t){if(!this._deleted)return t&&et(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),this.queue((async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()}))}async signOut(){return(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null)}setPersistence(t){return this.queue((async()=>{await this.assertedPersistence.setPersistence(st(t))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new h("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return null===t?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&st(t)||this._popupRedirectResolver;et(e,this,"argument-error"),this.redirectPersistenceManager=await Pt.create(this,[st(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(t)))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,i){if(this._deleted)return()=>{};const r="function"==typeof e?e:e.next.bind(e),s=this._isInitialized?Promise.resolve():this._initializationPromise;return et(s,this,"internal-error"),s.then((()=>r(this.currentUser))),"function"==typeof e?t.addObserver(e,n,i):t.addObserver(e)}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&(this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh()),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return et(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){t&&!this.frameworks.includes(t)&&(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=Ht(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const t={"X-Client-Version":this.clientVersion};return this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId),t}}function Kt(t){return v(t)}class $t{constructor(t){this.auth=t,this.observer=null,this.addObserver=function(t,e){const n=new g(t,void 0);return n.subscribe.bind(n)}((t=>this.observer=t))}get next(){return et(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}class Wt{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return nt("not implemented")}_getIdTokenResponse(t){return nt("not implemented")}_linkToIdToken(t,e){return nt("not implemented")}_getReauthenticationResolver(t){return nt("not implemented")}}class Xt extends Wt{constructor(t,e,n,i=null){super("password",n),this._email=t,this._password=e,this._tenantId=i}static _fromEmailAndPassword(t,e){return new Xt(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new Xt(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if((null==e?void 0:e.email)&&(null==e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":return async function(t,e){return gt(t,"POST","/v1/accounts:signInWithPassword",ft(t,e))}(t,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(t,e){return gt(t,"POST","/v1/accounts:signInWithEmailLink",ft(t,e))}(t,{email:this._email,oobCode:this._password});default:Q(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":return async function(t,e){return pt(t,"POST","/v1/accounts:update",e)}(t,{idToken:e,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(t,e){return gt(t,"POST","/v1/accounts:signInWithEmailLink",ft(t,e))}(t,{idToken:e,email:this._email,oobCode:this._password});default:Q(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function Jt(t,e){return gt(t,"POST","/v1/accounts:signInWithIdp",ft(t,e))}class Qt extends Wt{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new Qt(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):Q("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:n,signInMethod:i}=e,r=K(e,["providerId","signInMethod"]);if(!n||!i)return null;const s=new Qt(n,i);return s.idToken=r.idToken||void 0,s.accessToken=r.accessToken||void 0,s.secret=r.secret,s.nonce=r.nonce,s.pendingToken=r.pendingToken||null,s}_getIdTokenResponse(t){return Jt(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,Jt(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,Jt(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=f(e)}return t}}const Yt={USER_NOT_FOUND:"user-not-found"};class Zt extends Wt{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,e){return new Zt({verificationId:t,verificationCode:e})}static _fromTokenResponse(t,e){return new Zt({phoneNumber:t,temporaryProof:e})}_getIdTokenResponse(t){return async function(t,e){return gt(t,"POST","/v1/accounts:signInWithPhoneNumber",ft(t,e))}(t,this._makeVerificationRequest())}_linkToIdToken(t,e){return async function(t,e){const n=await gt(t,"POST","/v1/accounts:signInWithPhoneNumber",ft(t,e));if(n.temporaryProof)throw wt(t,"account-exists-with-different-credential",n);return n}(t,Object.assign({idToken:e},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return async function(t,e){return gt(t,"POST","/v1/accounts:signInWithPhoneNumber",ft(t,Object.assign(Object.assign({},e),{operation:"REAUTH"})),Yt)}(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:e,verificationId:n,verificationCode:i}=this.params;return t&&e?{temporaryProof:t,phoneNumber:e}:{sessionInfo:n,code:i}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){"string"==typeof t&&(t=JSON.parse(t));const{verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}=t;return n||e||i||r?new Zt({verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}class te{constructor(t){var e,n,i,r,s,o;const a=p(m(t)),c=null!==(e=a.apiKey)&&void 0!==e?e:null,h=null!==(n=a.oobCode)&&void 0!==n?n:null,u=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);et(c&&h&&u,"argument-error"),this.apiKey=c,this.operation=u,this.code=h,this.continueUrl=null!==(r=a.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(t){const e=function(t){const e=p(m(t)).link,n=e?p(m(e)).deep_link_id:null,i=p(m(t)).deep_link_id;return(i?p(m(i)).link:null)||i||n||e||t}(t);try{return new te(e)}catch(t){return null}}}class ee{constructor(){this.providerId=ee.PROVIDER_ID}static credential(t,e){return Xt._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=te.parseLink(e);return et(n,"argument-error"),Xt._fromEmailAndCode(t,n.code,n.tenantId)}}ee.PROVIDER_ID="password",ee.EMAIL_PASSWORD_SIGN_IN_METHOD="password",ee.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class ne{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class ie extends ne{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class re extends ie{constructor(){super("facebook.com")}static credential(t){return Qt._fromParams({providerId:re.PROVIDER_ID,signInMethod:re.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return re.credentialFromTaggedObject(t)}static credentialFromError(t){return re.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return re.credential(t.oauthAccessToken)}catch(t){return null}}}re.FACEBOOK_SIGN_IN_METHOD="facebook.com",re.PROVIDER_ID="facebook.com";class se extends ie{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return Qt._fromParams({providerId:se.PROVIDER_ID,signInMethod:se.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return se.credentialFromTaggedObject(t)}static credentialFromError(t){return se.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n}=t;if(!e&&!n)return null;try{return se.credential(e,n)}catch(t){return null}}}se.GOOGLE_SIGN_IN_METHOD="google.com",se.PROVIDER_ID="google.com";class oe extends ie{constructor(){super("github.com")}static credential(t){return Qt._fromParams({providerId:oe.PROVIDER_ID,signInMethod:oe.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return oe.credentialFromTaggedObject(t)}static credentialFromError(t){return oe.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return oe.credential(t.oauthAccessToken)}catch(t){return null}}}oe.GITHUB_SIGN_IN_METHOD="github.com",oe.PROVIDER_ID="github.com";class ae extends ie{constructor(){super("twitter.com")}static credential(t,e){return Qt._fromParams({providerId:ae.PROVIDER_ID,signInMethod:ae.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return ae.credentialFromTaggedObject(t)}static credentialFromError(t){return ae.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:n}=t;if(!e||!n)return null;try{return ae.credential(e,n)}catch(t){return null}}}ae.TWITTER_SIGN_IN_METHOD="twitter.com",ae.PROVIDER_ID="twitter.com";class ce{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n,i=!1){const r=await Nt._fromIdTokenResponse(t,n,i),s=he(n);return new ce({user:r,providerId:s,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const i=he(n);return new ce({user:t,providerId:i,_tokenResponse:n,operationType:e})}}function he(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class ue extends c{constructor(t,e,n,i){var r;super(e.code,e.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,ue.prototype),this.customData={appName:t.name,tenantId:null!==(r=t.tenantId)&&void 0!==r?r:void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,i){return new ue(t,e,n,i)}}function le(t,e,n,i){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw ue._fromErrorAndOperation(t,n,e,i);throw n}))}new WeakMap;const de="__sak";class fe{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(de,"1"),this.storage.removeItem(de),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}class pe extends fe{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const t=i();return xt(t)||jt(t)}()&&function(){try{return!(!window||window===window.top)}catch(t){return!1}}(),this.fallbackToPolling=Gt(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),i=this.localCache[e];n!==i&&t(e,i,n)}}onStorageEvent(t,e=!1){if(!t.key)return void this.forAllChangedKeys(((t,e,n)=>{this.notifyListeners(t,n)}));const n=t.key;if(e?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(t.newValue!==i)null!==t.newValue?this.storage.setItem(n,t.newValue):this.storage.removeItem(n);else if(this.localCache[n]===t.newValue&&!e)return}const i=()=>{const t=this.storage.getItem(n);(e||this.localCache[n]!==t)&&this.notifyListeners(n,t)},r=this.storage.getItem(n);a()&&10===document.documentMode&&r!==t.newValue&&t.newValue!==t.oldValue?setTimeout(i,10):i()}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e?JSON.parse(e):e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}pe.type="LOCAL";const me=pe;class ge extends fe{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(t,e){}_removeListener(t,e){}}ge.type="SESSION";const ye=ge;class ve{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find((e=>e.isListeningto(t)));if(e)return e;const n=new ve(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:i,data:r}=e.data,s=this.handlersMap[i];if(!(null==s?void 0:s.size))return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map((async t=>t(e.origin,r))),a=await function(t){return Promise.all(t.map((async t=>{try{return{fulfilled:!0,value:await t}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);e.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function we(t="",e=10){let n="";for(let t=0;t<e;t++)n+=Math.floor(10*Math.random());return t+n}ve.receivers=[];class Te{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise(((o,a)=>{const c=we("",20);i.port1.start();const h=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:i,onMessage(t){const e=t;if(e.data.eventId===c)switch(e.data.status){case"ack":clearTimeout(h),r=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(r),o(e.data.response);break;default:clearTimeout(h),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:t,eventId:c,data:e},[i.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function Ie(){return window}function be(){return void 0!==Ie().WorkerGlobalScope&&"function"==typeof Ie().importScripts}const Ee="firebaseLocalStorageDb",_e="firebaseLocalStorage",Se="fbase_key";class ke{constructor(t){this.request=t}toPromise(){return new Promise(((t,e)=>{this.request.addEventListener("success",(()=>{t(this.request.result)})),this.request.addEventListener("error",(()=>{e(this.request.error)}))}))}}function Ae(t,e){return t.transaction([_e],e?"readwrite":"readonly").objectStore(_e)}function Ce(){const t=indexedDB.open(Ee,1);return new Promise(((e,n)=>{t.addEventListener("error",(()=>{n(t.error)})),t.addEventListener("upgradeneeded",(()=>{const e=t.result;try{e.createObjectStore(_e,{keyPath:Se})}catch(t){n(t)}})),t.addEventListener("success",(async()=>{const n=t.result;n.objectStoreNames.contains(_e)?e(n):(n.close(),await function(){const t=indexedDB.deleteDatabase(Ee);return new ke(t).toPromise()}(),e(await Ce()))}))}))}async function Ne(t,e,n){const i=Ae(t,!0).put({[Se]:e,value:n});return new ke(i).toPromise()}function De(t,e){const n=Ae(t,!0).delete(e);return new ke(n).toPromise()}class Re{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Ce()),this.db}async _withRetries(t){let e=0;for(;;)try{const e=await this._openDb();return await t(e)}catch(t){if(e++>3)throw t;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return be()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ve._getInstance(be()?self:null),this.receiver._subscribe("keyChanged",(async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)}))),this.receiver._subscribe("ping",(async(t,e)=>["keyChanged"]))}async initializeSender(){var t,e;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new Te(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(t=n[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=n[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(this.sender&&this.activeServiceWorker&&function(){var t;return(null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await Ce();return await Ne(t,de,"1"),await De(t,de),!0}catch(t){}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite((async()=>(await this._withRetries((n=>Ne(n,t,e))),this.localCache[t]=e,this.notifyServiceWorker(t))))}async _get(t){const e=await this._withRetries((e=>async function(t,e){const n=Ae(t,!1).get(e),i=await new ke(n).toPromise();return void 0===i?null:i.value}(e,t)));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite((async()=>(await this._withRetries((e=>De(e,t))),delete this.localCache[t],this.notifyServiceWorker(t))))}async _poll(){const t=await this._withRetries((t=>{const e=Ae(t,!1).getAll();return new ke(e).toPromise()}));if(!t)return[];if(0!==this.pendingWrites)return[];const e=[],n=new Set;for(const{fbase_key:i,value:r}of t)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),e.push(i));for(const t of Object.keys(this.localCache))this.localCache[t]&&!n.has(t)&&(this.notifyListeners(t,null),e.push(t));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Re.type="LOCAL";const Oe=Re;function Pe(t){return`__${t}${Math.floor(1e6*Math.random())}`}Pe("rcb"),new ct(3e4,6e4);class Le{constructor(t){this.providerId=Le.PROVIDER_ID,this.auth=Kt(t)}verifyPhoneNumber(t,e){return async function(t,e,n){var i;const r=await n.verify();try{let s;if(et("string"==typeof r,t,"argument-error"),et("recaptcha"===n.type,t,"argument-error"),s="string"==typeof e?{phoneNumber:e}:e,"session"in s){const e=s.session;if("phoneNumber"in s){et("enroll"===e.type,t,"internal-error");const n=await function(t,e){return pt(t,"POST","/v2/accounts/mfaEnrollment:start",ft(t,e))}(t,{idToken:e.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}});return n.phoneSessionInfo.sessionInfo}{et("signin"===e.type,t,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;et(n,t,"missing-multi-factor-info");const o=await function(t,e){return pt(t,"POST","/v2/accounts/mfaSignIn:start",ft(t,e))}(t,{mfaPendingCredential:e.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:e}=await async function(t,e){return pt(t,"POST","/v1/accounts:sendVerificationCode",ft(t,e))}(t,{phoneNumber:s.phoneNumber,recaptchaToken:r});return e}}finally{n._reset()}}(this.auth,t,v(e))}static credential(t,e){return Zt._fromVerification(t,e)}static credentialFromResult(t){const e=t;return Le.credentialFromTaggedObject(e)}static credentialFromError(t){return Le.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{phoneNumber:e,temporaryProof:n}=t;return e&&n?Zt._fromTokenResponse(e,n):null}}function Me(t,e){return e?st(e):(et(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}Le.PROVIDER_ID="phone",Le.PHONE_SIGN_IN_METHOD="phone";class xe extends Wt{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Jt(t,this._buildIdpRequest())}_linkToIdToken(t,e){return Jt(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return Jt(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function Ue(t){return async function(t,e,n=!1){const i="signIn",r=await le(t,i,e),s=await ce._fromIdTokenResponse(t,i,r);return n||await t._updateCurrentUser(s.user),s}(t.auth,new xe(t),t.bypassAuthState)}function Fe(t){const{auth:e,user:n}=t;return et(n,e,"internal-error"),async function(t,e,n=!1){const{auth:i}=t,r="reauthenticate";try{const s=await Et(t,le(i,r,e,t),n);et(s.idToken,i,"internal-error");const o=bt(s.idToken);et(o,i,"internal-error");const{sub:a}=o;return et(t.uid===a,i,"user-mismatch"),ce._forOperation(t,r,s)}catch(t){throw"auth/user-not-found"===(null==t?void 0:t.code)&&Q(i,"user-mismatch"),t}}(n,new xe(t),t.bypassAuthState)}async function Ve(t){const{auth:e,user:n}=t;return et(n,e,"internal-error"),async function(t,e,n=!1){const i=await Et(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ce._forOperation(t,"link",i)}(n,new xe(t),t.bypassAuthState)}class qe{constructor(t,e,n,i,r=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise((async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(t){this.reject(t)}}))}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=t;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:e,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(t){this.reject(t)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return Ue;case"linkViaPopup":case"linkViaRedirect":return Ve;case"reauthViaPopup":case"reauthViaRedirect":return Fe;default:Q(this.auth,"internal-error")}}resolve(t){it(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){it(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Be=new ct(2e3,1e4);class je extends qe{constructor(t,e,n,i,r){super(t,e,i,r),this.provider=n,this.authWindow=null,this.pollId=null,je.currentPopupAction&&je.currentPopupAction.cancel(),je.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return et(t,this.auth,"internal-error"),t}async onExecution(){it(1===this.filter.length,"Popup operations only handle one event");const t=we();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((t=>{this.reject(t)})),this.resolver._isIframeWebStorageSupported(this.auth,(t=>{t||this.reject(Y(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(Y(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,je.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,n;(null===(n=null===(e=this.authWindow)||void 0===e?void 0:e.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Y(this.auth,"popup-closed-by-user"))}),2e3):this.pollId=window.setTimeout(t,Be.get())};t()}}je.currentPopupAction=null;const Ge=new Map;class He extends qe{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}async execute(){let t=Ge.get(this.auth._key());if(!t){try{const e=await async function(t,e){const n=function(t){return Ot("pendingRedirect",t.config.apiKey,t.name)}(e),i=function(t){return st(t._redirectPersistence)}(t);if(!await i._isAvailable())return!1;const r="true"===await i._get(n);return await i._remove(n),r}(this.resolver,this.auth),n=e?await super.execute():null;t=()=>Promise.resolve(n)}catch(e){t=()=>Promise.reject(e)}Ge.set(this.auth._key(),t)}return this.bypassAuthState||Ge.set(this.auth._key(),(()=>Promise.resolve(null))),t()}async onAuthEvent(t){if("signInViaRedirect"===t.type)return super.onAuthEvent(t);if("unknown"!==t.type){if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function ze(t,e,n=!1){const i=Kt(t),r=Me(i,e),s=new He(i,r,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}class Ke{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))})),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return We(t);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var n;if(t.error&&!We(t)){const i=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(Y(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has($e(t))}saveEventToCache(t){this.cachedEventUids.add($e(t)),this.lastProcessedEventTime=Date.now()}}function $e(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter((t=>t)).join("-")}function We({type:t,error:e}){return"unknown"===t&&"auth/no-auth-event"===(null==e?void 0:e.code)}const Xe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Je=/^https?/;function Qe(t){const e=ot(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const r=new URL(t);return""===r.hostname&&""===i?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!Je.test(n))return!1;if(Xe.test(t))return i===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const Ye=new ct(3e4,6e4);function Ze(){const t=Ie().___jsl;if(null==t?void 0:t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let e=0;e<t.CP.length;e++)t.CP[e]=null}let tn=null;function en(t){return tn=tn||function(t){return new Promise(((e,n)=>{var i,r,s,o;function a(){Ze(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Ze(),n(Y(t,"network-request-failed"))},timeout:Ye.get()})}if(null===(r=null===(i=Ie().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)e(gapi.iframes.getContext());else{if(!(null===(s=Ie().gapi)||void 0===s?void 0:s.load)){const e=Pe("iframefcb");return Ie()[e]=()=>{gapi.load?a():n(Y(t,"network-request-failed"))},(o=`https://apis.google.com/js/api.js?onload=${e}`,new Promise(((t,e)=>{const n=document.createElement("script");n.setAttribute("src",o),n.onload=t,n.onerror=t=>{const n=Y("internal-error");n.customData=t,e(n)},n.type="text/javascript",n.charset="UTF-8",function(){var t,e;return null!==(e=null===(t=document.getElementsByTagName("head"))||void 0===t?void 0:t[0])&&void 0!==e?e:document}().appendChild(n)}))).catch((t=>n(t)))}a()}})).catch((t=>{throw tn=null,t}))}(t),tn}const nn=new ct(5e3,15e3),rn={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},sn=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function on(t){const e=t.config;et(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?ht(e,"emulator/auth/iframe"):`https://${t.config.authDomain}/__/auth/iframe`,i={apiKey:e.apiKey,appName:t.name,v:G},r=sn.get(t.config.apiHost);r&&(i.eid=r);const s=t._getFrameworks();return s.length&&(i.fw=s.join(",")),`${n}?${f(i).slice(1)}`}const an={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class cn{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(t){}}}function hn(t,e,n,i,r,s){et(t.config.authDomain,t,"auth-domain-config-required"),et(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:G,eventId:r};if(e instanceof ne){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(s||{}))o[t]=e}if(e instanceof ie){const t=e.getScopes().filter((t=>""!==t));t.length>0&&(o.scopes=t.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const t of Object.keys(a))void 0===a[t]&&delete a[t];return`${function({config:t}){return t.emulator?ht(t,"emulator/auth/handler"):`https://${t.authDomain}/__/auth/handler`}(t)}?${f(a).slice(1)}`}const un="webStorageSupport",ln=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ye,this._completeRedirectFn=ze}async _openPopup(t,e,n,r){var s;return it(null===(s=this.eventManagers[t._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()"),function(t,e,n,r=500,s=600){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const h=Object.assign(Object.assign({},an),{width:r.toString(),height:s.toString(),top:o,left:a}),u=i().toLowerCase();n&&(c=Ut(u)?"_blank":n),Mt(u)&&(e=e||"http://localhost",h.scrollbars="yes");const l=Object.entries(h).reduce(((t,[e,n])=>`${t}${e}=${n},`),"");if(function(t=i()){var e;return jt(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(u)&&"_self"!==c)return function(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(e||"",c),new cn(null);const d=window.open(e||"",c,l);et(d,t,"popup-blocked");try{d.focus()}catch(t){}return new cn(d)}(t,hn(t,e,n,ot(),r),we())}async _openRedirect(t,e,n,i){var r;return await this._originValidation(t),r=hn(t,e,n,ot(),i),Ie().location.href=r,new Promise((()=>{}))}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:n}=this.eventManagers[e];return t?Promise.resolve(t):(it(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch((()=>{delete this.eventManagers[e]})),n}async initAndGetManager(t){const e=await async function(t){const e=await en(t),n=Ie().gapi;return et(n,t,"internal-error"),e.open({where:document.body,url:on(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:rn,dontclear:!0},(e=>new Promise((async(n,i)=>{await e.restyle({setHideOnLeave:!1});const r=Y(t,"network-request-failed"),s=Ie().setTimeout((()=>{i(r)}),nn.get());function o(){Ie().clearTimeout(s),n(e)}e.ping(o).then(o,(()=>{i(r)}))}))))}(t),n=new Ke(t);return e.register("authEvent",(e=>(et(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:n.onEvent(e.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(un,{type:un},(n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i.webStorageSupport;void 0!==r&&e(!!r),Q(t,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=async function(t){if(t.config.emulator)return;const{authorizedDomains:e}=await async function(t,e={}){return pt(t,"GET","/v1/projects",e)}(t);for(const t of e)try{if(Qe(t))return}catch(t){}Q(t,"unauthorized-domain")}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return Gt()||xt()||jt()}};var dn,fn="@firebase/auth",pn="0.19.6";class mn{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged((e=>{var n;t((null===(n=e)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)}));this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){et(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}dn="Browser",V(new w("auth",((t,{options:e})=>{const n=t.getProvider("app").getImmediate(),{apiKey:i,authDomain:r}=n.options;return(t=>{et(i&&!i.includes(":"),"invalid-api-key",{appName:t.name}),et(!(null==r?void 0:r.includes(":")),"argument-error",{appName:t.name});const n={apiKey:i,authDomain:r,clientPlatform:dn,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ht(dn)},s=new zt(t,n);return function(t,e){const n=(null==e?void 0:e.persistence)||[],i=(Array.isArray(n)?n:[n]).map(st);(null==e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,null==e?void 0:e.popupRedirectResolver)}(s,e),s})(n)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((t,e,n)=>{t.getProvider("auth-internal").initialize()}))),V(new w("auth-internal",(t=>(t=>new mn(t))(Kt(t.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),z(fn,pn,void 0),z(fn,pn,"esm2017");var gn,yn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},vn={},wn=wn||{},Tn=yn||self;function In(){}function bn(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function En(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var _n="closure_uid_"+(1e9*Math.random()>>>0),Sn=0;function kn(t,e,n){return t.call.apply(t.bind,arguments)}function An(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Cn(t,e,n){return(Cn=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?kn:An).apply(null,arguments)}function Nn(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Dn(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return e.prototype[n].apply(t,r)}}function Rn(){this.s=this.s,this.o=this.o}var On={};Rn.prototype.s=!1,Rn.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,_n)&&t[_n]||(t[_n]=++Sn)}(this);delete On[t]}},Rn.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Pn=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Ln=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){const i=t.length,r="string"==typeof t?t.split(""):t;for(let s=0;s<i;s++)s in r&&e.call(n,r[s],s,t)};function Mn(t){return Array.prototype.concat.apply([],arguments)}function xn(t){const e=t.length;if(0<e){const n=Array(e);for(let i=0;i<e;i++)n[i]=t[i];return n}return[]}function Un(t){return/^[\s\xa0]*$/.test(t)}var Fn,Vn=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function qn(t,e){return-1!=t.indexOf(e)}function Bn(t,e){return t<e?-1:t>e?1:0}t:{var jn=Tn.navigator;if(jn){var Gn=jn.userAgent;if(Gn){Fn=Gn;break t}}Fn=""}function Hn(t,e,n){for(const i in t)e.call(n,t[i],i,t)}function zn(t){const e={};for(const n in t)e[n]=t[n];return e}var Kn="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $n(t,e){let n,i;for(let e=1;e<arguments.length;e++){for(n in i=arguments[e],i)t[n]=i[n];for(let e=0;e<Kn.length;e++)n=Kn[e],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function Wn(t){return Wn[" "](t),t}Wn[" "]=In;var Xn,Jn,Qn=qn(Fn,"Opera"),Yn=qn(Fn,"Trident")||qn(Fn,"MSIE"),Zn=qn(Fn,"Edge"),ti=Zn||Yn,ei=qn(Fn,"Gecko")&&!(qn(Fn.toLowerCase(),"webkit")&&!qn(Fn,"Edge"))&&!(qn(Fn,"Trident")||qn(Fn,"MSIE"))&&!qn(Fn,"Edge"),ni=qn(Fn.toLowerCase(),"webkit")&&!qn(Fn,"Edge");function ii(){var t=Tn.document;return t?t.documentMode:void 0}t:{var ri="",si=(Jn=Fn,ei?/rv:([^\);]+)(\)|;)/.exec(Jn):Zn?/Edge\/([\d\.]+)/.exec(Jn):Yn?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Jn):ni?/WebKit\/(\S+)/.exec(Jn):Qn?/(?:Version)[ \/]?(\S+)/.exec(Jn):void 0);if(si&&(ri=si?si[1]:""),Yn){var oi=ii();if(null!=oi&&oi>parseFloat(ri)){Xn=String(oi);break t}}Xn=ri}var ai,ci={};function hi(){return t=ci,Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=function(){let t=0;const e=Vn(String(Xn)).split("."),n=Vn("9").split("."),i=Math.max(e.length,n.length);for(let o=0;0==t&&o<i;o++){var r=e[o]||"",s=n[o]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==r[0].length&&0==s[0].length)break;t=Bn(0==r[1].length?0:parseInt(r[1],10),0==s[1].length?0:parseInt(s[1],10))||Bn(0==r[2].length,0==s[2].length)||Bn(r[2],s[2]),r=r[3],s=s[3]}while(0==t)}return 0<=t}();var t}Tn.document&&Yn?ai=ii()||parseInt(Xn,10)||void 0:ai=void 0;var ui=ai,li=function(){if(!Tn.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Tn.addEventListener("test",In,e),Tn.removeEventListener("test",In,e)}catch(t){}return t}();function di(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function fi(t,e){if(di.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(ei){t:{try{Wn(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:pi[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&fi.Z.h.call(this)}}di.prototype.h=function(){this.defaultPrevented=!0},Dn(fi,di);var pi={2:"touch",3:"pen",4:"mouse"};fi.prototype.h=function(){fi.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var mi="closure_listenable_"+(1e6*Math.random()|0),gi=0;function yi(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.ia=r,this.key=++gi,this.ca=this.fa=!1}function vi(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function wi(t){this.src=t,this.g={},this.h=0}function Ti(t,e){var n=e.type;if(n in t.g){var i,r=t.g[n],s=Pn(r,e);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(vi(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Ii(t,e,n,i){for(var r=0;r<t.length;++r){var s=t[r];if(!s.ca&&s.listener==e&&s.capture==!!n&&s.ia==i)return r}return-1}wi.prototype.add=function(t,e,n,i,r){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=Ii(t,e,i,r);return-1<o?(e=t[o],n||(e.fa=!1)):((e=new yi(e,this.src,s,!!i,r)).fa=n,t.push(e)),e};var bi="closure_lm_"+(1e6*Math.random()|0),Ei={};function _i(t,e,n,i,r){if(i&&i.once)return ki(t,e,n,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)_i(t,e[s],n,i,r);return null}return n=Pi(n),t&&t[mi]?t.N(e,n,En(i)?!!i.capture:!!i,r):Si(t,e,n,!1,i,r)}function Si(t,e,n,i,r,s){if(!e)throw Error("Invalid event type");var o=En(r)?!!r.capture:!!r,a=Ri(t);if(a||(t[bi]=a=new wi(t)),(n=a.add(e,n,i,o,s)).proxy)return n;if(i=function(){var t=Di;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)li||(r=o),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(Ni(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function ki(t,e,n,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)ki(t,e[s],n,i,r);return null}return n=Pi(n),t&&t[mi]?t.O(e,n,En(i)?!!i.capture:!!i,r):Si(t,e,n,!0,i,r)}function Ai(t,e,n,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)Ai(t,e[s],n,i,r);else i=En(i)?!!i.capture:!!i,n=Pi(n),t&&t[mi]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=Ii(s=t.g[e],n,i,r))&&(vi(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--))):t&&(t=Ri(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Ii(e,n,i,r)),(n=-1<t?e[t]:null)&&Ci(n))}function Ci(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[mi])Ti(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(Ni(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Ri(e))?(Ti(n,t),0==n.h&&(n.src=null,e[bi]=null)):vi(t)}}}function Ni(t){return t in Ei?Ei[t]:Ei[t]="on"+t}function Di(t,e){if(t.ca)t=!0;else{e=new fi(e,this);var n=t.listener,i=t.ia||t.src;t.fa&&Ci(t),t=n.call(i,e)}return t}function Ri(t){return(t=t[bi])instanceof wi?t:null}var Oi="__closure_events_fn_"+(1e9*Math.random()>>>0);function Pi(t){return"function"==typeof t?t:(t[Oi]||(t[Oi]=function(e){return t.handleEvent(e)}),t[Oi])}function Li(){Rn.call(this),this.i=new wi(this),this.P=this,this.I=null}function Mi(t,e){var n,i=t.I;if(i)for(n=[];i;i=i.I)n.push(i);if(t=t.P,i=e.type||e,"string"==typeof e)e=new di(e,t);else if(e instanceof di)e.target=e.target||t;else{var r=e;$n(e=new di(i,t),r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];r=xi(o,i,!0,e)&&r}if(r=xi(o=e.g=t,i,!0,e)&&r,r=xi(o,i,!1,e)&&r,n)for(s=0;s<n.length;s++)r=xi(o=e.g=n[s],i,!1,e)&&r}function xi(t,e,n,i){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.ca&&o.capture==n){var a=o.listener,c=o.ia||o.src;o.fa&&Ti(t.i,o),r=!1!==a.call(c,i)&&r}}return r&&!i.defaultPrevented}Dn(Li,Rn),Li.prototype[mi]=!0,Li.prototype.removeEventListener=function(t,e,n,i){Ai(this,t,e,n,i)},Li.prototype.M=function(){if(Li.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)vi(n[i]);delete e.g[t],e.h--}}this.I=null},Li.prototype.N=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)},Li.prototype.O=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};var Ui=Tn.JSON.stringify;function Fi(){var t=zi;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Vi,qi=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new Bi),(t=>t.reset()));class Bi{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function ji(t){Tn.setTimeout((()=>{throw t}),0)}function Gi(t,e){Vi||function(){var t=Tn.Promise.resolve(void 0);Vi=function(){t.then(Ki)}}(),Hi||(Vi(),Hi=!0),zi.add(t,e)}var Hi=!1,zi=new class{constructor(){this.h=this.g=null}add(t,e){const n=qi.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}};function Ki(){for(var t;t=Fi();){try{t.h.call(t.g)}catch(t){ji(t)}var e=qi;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Hi=!1}function $i(t,e){Li.call(this),this.h=t||1,this.g=e||Tn,this.j=Cn(this.kb,this),this.l=Date.now()}function Wi(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function Xi(t,e,n){if("function"==typeof t)n&&(t=Cn(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Cn(t.handleEvent,t)}return 2147483647<Number(e)?-1:Tn.setTimeout(t,e||0)}function Ji(t){t.g=Xi((()=>{t.g=null,t.i&&(t.i=!1,Ji(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}Dn($i,Li),(gn=$i.prototype).da=!1,gn.S=null,gn.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Mi(this,"tick"),this.da&&(Wi(this),this.start()))}},gn.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},gn.M=function(){$i.Z.M.call(this),Wi(this),delete this.g};class Qi extends Rn{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:Ji(this)}M(){super.M(),this.g&&(Tn.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Yi(t){Rn.call(this),this.h=t,this.g={}}Dn(Yi,Rn);var Zi=[];function tr(t,e,n,i){Array.isArray(n)||(n&&(Zi[0]=n.toString()),n=Zi);for(var r=0;r<n.length;r++){var s=_i(e,n[r],i||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function er(t){Hn(t.g,(function(t,e){this.g.hasOwnProperty(e)&&Ci(t)}),t),t.g={}}function nr(){this.g=!0}function ir(t,e,n,i){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return Ui(n)}catch(t){return e}}(t,n)+(i?" "+i:"")}))}Yi.prototype.M=function(){Yi.Z.M.call(this),er(this)},Yi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},nr.prototype.Aa=function(){this.g=!1},nr.prototype.info=function(){};var rr={},sr=null;function or(){return sr=sr||new Li}function ar(t){di.call(this,rr.Ma,t)}function cr(t){const e=or();Mi(e,new ar(e,t))}function hr(t,e){di.call(this,rr.STAT_EVENT,t),this.stat=e}function ur(t){const e=or();Mi(e,new hr(e,t))}function lr(t,e){di.call(this,rr.Na,t),this.size=e}function dr(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Tn.setTimeout((function(){t()}),e)}rr.Ma="serverreachability",Dn(ar,di),rr.STAT_EVENT="statevent",Dn(hr,di),rr.Na="timingevent",Dn(lr,di);var fr={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},pr={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function mr(){}function gr(t){return t.h||(t.h=t.i())}function yr(){}mr.prototype.h=null;var vr,wr={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function Tr(){di.call(this,"d")}function Ir(){di.call(this,"c")}function br(){}function Er(t,e,n,i){this.l=t,this.j=e,this.m=n,this.X=i||1,this.V=new Yi(this),this.P=Sr,t=ti?125:void 0,this.W=new $i(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new _r}function _r(){this.i=null,this.g="",this.h=!1}Dn(Tr,di),Dn(Ir,di),Dn(br,mr),br.prototype.g=function(){return new XMLHttpRequest},br.prototype.i=function(){return{}},vr=new br;var Sr=45e3,kr={},Ar={};function Cr(t,e,n){t.K=1,t.v=Qr(zr(e)),t.s=n,t.U=!0,Nr(t,null)}function Nr(t,e){t.F=Date.now(),Pr(t),t.A=zr(t.v);var n=t.A,i=t.X;Array.isArray(i)||(i=[String(i)]),us(n.h,"t",i),t.C=0,n=t.l.H,t.h=new _r,t.g=uo(t.l,n?e:null,!t.s),0<t.O&&(t.L=new Qi(Cn(t.Ia,t,t.g),t.O)),tr(t.V,t.g,"readystatechange",t.gb),e=t.H?zn(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),cr(1),function(t,e,n,i,r,s){t.info((function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var h=a[c].split("=");if(1<h.length){var u=h[0];h=h[1];var l=u.split("_");o=2<=l.length&&"type"==l[1]?o+(u+"=")+h+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function Dr(t){return!!t.g&&"GET"==t.u&&2!=t.K&&t.l.Ba}function Rr(t,e,n){let i,r=!0;for(;!t.I&&t.C<n.length;){if(i=Or(t,n),i==Ar){4==e&&(t.o=4,ur(14),r=!1),ir(t.j,t.m,null,"[Incomplete Response]");break}if(i==kr){t.o=4,ur(15),ir(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}ir(t.j,t.m,i,null),Fr(t,i)}Dr(t)&&i!=Ar&&i!=kr&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,ur(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),no(e),e.L=!0,ur(11))):(ir(t.j,t.m,n,"[Invalid Chunked Response]"),Ur(t),xr(t))}function Or(t,e){var n=t.C,i=e.indexOf("\n",n);return-1==i?Ar:(n=Number(e.substring(n,i)),isNaN(n)?kr:(i+=1)+n>e.length?Ar:(e=e.substr(i,n),t.C=i+n,e))}function Pr(t){t.Y=Date.now()+t.P,Lr(t,t.P)}function Lr(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=dr(Cn(t.eb,t),e)}function Mr(t){t.B&&(Tn.clearTimeout(t.B),t.B=null)}function xr(t){0==t.l.G||t.I||so(t.l,t)}function Ur(t){Mr(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,Wi(t.W),er(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Fr(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||gs(n.i,t)))if(n.I=t.N,!t.J&&gs(n.i,t)&&3==n.G){try{var i=n.Ca.g.parse(e)}catch(t){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;ro(n),$s(n)}eo(n),ur(18)}}else n.ta=r[1],0<n.ta-n.U&&37500>r[2]&&n.N&&0==n.A&&!n.v&&(n.v=dr(Cn(n.ab,n),6e3));if(1>=ms(n.i)&&n.ka){try{n.ka()}catch(t){}n.ka=void 0}}else ao(n,11)}else if((t.J||n.g==t)&&ro(n),!Un(e))for(r=n.Ca.g.parse(e),e=0;e<r.length;e++){let h=r[e];if(n.U=h[0],h=h[1],2==n.G)if("c"==h[0]){n.J=h[1],n.la=h[2];const e=h[3];null!=e&&(n.ma=e,n.h.info("VER="+n.ma));const r=h[4];null!=r&&(n.za=r,n.h.info("SVER="+n.za));const u=h[5];null!=u&&"number"==typeof u&&0<u&&(i=1.5*u,n.K=i,n.h.info("backChannelRequestTimeoutMs_="+i)),i=n;const l=t.g;if(l){const t=l.g?l.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var s=i.i;!s.g&&(qn(t,"spdy")||qn(t,"quic")||qn(t,"h2"))&&(s.j=s.l,s.g=new Set,s.h&&(ys(s,s.h),s.h=null))}if(i.D){const t=l.g?l.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(i.sa=t,Jr(i.F,i.D,t))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var o=t;if((i=n).oa=ho(i,i.H?i.la:null,i.W),o.J){vs(i.i,o);var a=o,c=i.K;c&&a.setTimeout(c),a.B&&(Mr(a),Pr(a)),i.g=o}else to(i);0<n.l.length&&Js(n)}else"stop"!=h[0]&&"close"!=h[0]||ao(n,7);else 3==n.G&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?ao(n,7):Ks(n):"noop"!=h[0]&&n.j&&n.j.wa(h),n.A=0)}cr(4)}catch(t){}}function Vr(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(bn(t)||"string"==typeof t)Ln(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(bn(t)||"string"==typeof t){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;i=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(bn(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t),r=i.length;for(var s=0;s<r;s++)e.call(void 0,i[s],n&&n[s],t)}}function qr(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof qr)for(n=t.T(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function Br(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var i=t.g[e];jr(t.h,i)&&(t.g[n++]=i),e++}t.g.length=n}if(t.i!=t.g.length){var r={};for(n=e=0;e<t.g.length;)jr(r,i=t.g[e])||(t.g[n++]=i,r[i]=1),e++;t.g.length=n}}function jr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(gn=Er.prototype).setTimeout=function(t){this.P=t},gn.gb=function(t){t=t.target;const e=this.L;e&&3==Bs(t)?e.l():this.Ia(t)},gn.Ia=function(t){try{if(t==this.g)t:{const u=Bs(this.g);var e=this.g.Da();const l=this.g.ba();if(!(3>u)&&(3!=u||ti||this.g&&(this.h.h||this.g.ga()||js(this.g)))){this.I||4!=u||7==e||cr(8==e||0>=l?3:2),Mr(this);var n=this.g.ba();this.N=n;e:if(Dr(this)){var i=js(this.g);t="";var r=i.length,s=4==Bs(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Ur(this),xr(this);var o="";break e}this.h.i=new Tn.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(i[e],{stream:s&&e==r-1});i.splice(0,r),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=200==n,function(t,e,n,i,r,s,o){t.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+"\n"+n+"\n"+s+" "+o}))}(this.j,this.u,this.A,this.m,this.X,u,n),this.i){if(this.$&&!this.J){e:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Un(a)){var h=a;break e}}h=null}if(!(n=h)){this.i=!1,this.o=3,ur(12),Ur(this),xr(this);break t}ir(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Fr(this,n)}this.U?(Rr(this,u,o),ti&&this.i&&3==u&&(tr(this.V,this.W,"tick",this.fb),this.W.start())):(ir(this.j,this.m,o,null),Fr(this,o)),4==u&&Ur(this),this.i&&!this.I&&(4==u?so(this.l,this):(this.i=!1,Pr(this)))}else 400==n&&0<o.indexOf("Unknown SID")?(this.o=3,ur(12)):(this.o=0,ur(13)),Ur(this),xr(this)}}}catch(t){}},gn.fb=function(){if(this.g){var t=Bs(this.g),e=this.g.ga();this.C<e.length&&(Mr(this),Rr(this,t,e),this.i&&4!=t&&Pr(this))}},gn.cancel=function(){this.I=!0,Ur(this)},gn.eb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(cr(3),ur(17)),Ur(this),this.o=2,xr(this)):Lr(this,this.Y-t)},(gn=qr.prototype).R=function(){Br(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},gn.T=function(){return Br(this),this.g.concat()},gn.get=function(t,e){return jr(this.h,t)?this.h[t]:e},gn.set=function(t,e){jr(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},gn.forEach=function(t,e){for(var n=this.T(),i=0;i<n.length;i++){var r=n[i],s=this.get(r);t.call(e,s,r,this)}};var Gr=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Hr(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof Hr){this.g=void 0!==e?e:t.g,Kr(this,t.j),this.s=t.s,$r(this,t.i),Wr(this,t.m),this.l=t.l,e=t.h;var n=new os;n.i=e.i,e.g&&(n.g=new qr(e.g),n.h=e.h),Xr(this,n),this.o=t.o}else t&&(n=String(t).match(Gr))?(this.g=!!e,Kr(this,n[1]||"",!0),this.s=Yr(n[2]||""),$r(this,n[3]||"",!0),Wr(this,n[4]),this.l=Yr(n[5]||"",!0),Xr(this,n[6]||"",!0),this.o=Yr(n[7]||"")):(this.g=!!e,this.h=new os(null,this.g))}function zr(t){return new Hr(t)}function Kr(t,e,n){t.j=n?Yr(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function $r(t,e,n){t.i=n?Yr(e,!0):e}function Wr(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Xr(t,e,n){e instanceof os?(t.h=e,function(t,e){e&&!t.j&&(as(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(cs(this,e),us(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=Zr(e,rs)),t.h=new os(e,t.g))}function Jr(t,e,n){t.h.set(e,n)}function Qr(t){return Jr(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Yr(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Zr(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,ts),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function ts(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Hr.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Zr(e,es,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(Zr(e,es,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(Zr(n,"/"==n.charAt(0)?is:ns,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Zr(n,ss)),t.join("")};var es=/[#\/\?@]/g,ns=/[#\?:]/g,is=/[#\?]/g,rs=/[#\?@]/g,ss=/#/g;function os(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function as(t){t.g||(t.g=new qr,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var s=t[n].substring(0,i);r=t[n].substring(i+1)}else s=t[n];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function cs(t,e){as(t),e=ls(t,e),jr(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,jr((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&Br(t)))}function hs(t,e){return as(t),e=ls(t,e),jr(t.g.h,e)}function us(t,e,n){cs(t,e),0<n.length&&(t.i=null,t.g.set(ls(t,e),xn(n)),t.h+=n.length)}function ls(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function ds(t){this.l=t||fs,t=Tn.PerformanceNavigationTiming?0<(t=Tn.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(Tn.g&&Tn.g.Ea&&Tn.g.Ea()&&Tn.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(gn=os.prototype).add=function(t,e){as(this),this.i=null,t=ls(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},gn.forEach=function(t,e){as(this),this.g.forEach((function(n,i){Ln(n,(function(n){t.call(e,n,i,this)}),this)}),this)},gn.T=function(){as(this);for(var t=this.g.R(),e=this.g.T(),n=[],i=0;i<e.length;i++)for(var r=t[i],s=0;s<r.length;s++)n.push(e[i]);return n},gn.R=function(t){as(this);var e=[];if("string"==typeof t)hs(this,t)&&(e=Mn(e,this.g.get(ls(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=Mn(e,t[n])}return e},gn.set=function(t,e){return as(this),this.i=null,hs(this,t=ls(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},gn.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},gn.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var i=e[n],r=encodeURIComponent(String(i));i=this.R(i);for(var s=0;s<i.length;s++){var o=r;""!==i[s]&&(o+="="+encodeURIComponent(String(i[s]))),t.push(o)}}return this.i=t.join("&")};var fs=10;function ps(t){return!!t.h||!!t.g&&t.g.size>=t.j}function ms(t){return t.h?1:t.g?t.g.size:0}function gs(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function ys(t,e){t.g?t.g.add(e):t.h=e}function vs(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function ws(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return xn(t.i)}function Ts(){}function Is(){this.g=new Ts}function bs(t,e,n){const i=n||"";try{Vr(t,(function(t,n){let r=t;En(t)&&(r=Ui(t)),e.push(i+n+"="+encodeURIComponent(r))}))}catch(t){throw e.push(i+"type="+encodeURIComponent("_badmap")),t}}function Es(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}function _s(t){this.l=t.$b||null,this.j=t.ib||!1}function Ss(t,e){Li.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=ks,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ds.prototype.cancel=function(){if(this.i=ws(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}},Ts.prototype.stringify=function(t){return Tn.JSON.stringify(t,void 0)},Ts.prototype.parse=function(t){return Tn.JSON.parse(t,void 0)},Dn(_s,mr),_s.prototype.g=function(){return new Ss(this.l,this.j)},_s.prototype.i=function(t){return function(){return t}}({}),Dn(Ss,Li);var ks=0;function As(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function Cs(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Ns(t)}function Ns(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(gn=Ss.prototype).open=function(t,e){if(this.readyState!=ks)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Ns(this)},gn.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||Tn).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},gn.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Cs(this)),this.readyState=ks},gn.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Ns(this)),this.g&&(this.readyState=3,Ns(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==Tn.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;As(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},gn.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Cs(this):Ns(this),3==this.readyState&&As(this)}},gn.Ua=function(t){this.g&&(this.response=this.responseText=t,Cs(this))},gn.Ta=function(t){this.g&&(this.response=t,Cs(this))},gn.ha=function(){this.g&&Cs(this)},gn.setRequestHeader=function(t,e){this.v.append(t,e)},gn.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},gn.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Ss.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Ds=Tn.JSON.parse;function Rs(t){Li.call(this),this.headers=new qr,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Os,this.K=this.L=!1}Dn(Rs,Li);var Os="",Ps=/^https?$/i,Ls=["POST","PUT"];function Ms(t){return"content-type"==t.toLowerCase()}function xs(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Us(t),Vs(t)}function Us(t){t.D||(t.D=!0,Mi(t,"complete"),Mi(t,"error"))}function Fs(t){if(t.h&&void 0!==wn&&(!t.C[1]||4!=Bs(t)||2!=t.ba()))if(t.v&&4==Bs(t))Xi(t.Fa,0,t);else if(Mi(t,"readystatechange"),4==Bs(t)){t.h=!1;try{const a=t.ba();t:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var i;if(i=0===a){var r=String(t.H).match(Gr)[1]||null;if(!r&&Tn.self&&Tn.self.location){var s=Tn.self.location.protocol;r=s.substr(0,s.length-1)}i=!Ps.test(r?r.toLowerCase():"")}n=i}if(n)Mi(t,"complete"),Mi(t,"success");else{t.m=6;try{var o=2<Bs(t)?t.g.statusText:""}catch(t){o=""}t.j=o+" ["+t.ba()+"]",Us(t)}}finally{Vs(t)}}}function Vs(t,e){if(t.g){qs(t);const n=t.g,i=t.C[0]?In:null;t.g=null,t.C=null,e||Mi(t,"ready");try{n.onreadystatechange=i}catch(t){}}}function qs(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(Tn.clearTimeout(t.A),t.A=null)}function Bs(t){return t.g?t.g.readyState:0}function js(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case Os:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Gs(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=function(t){let e="";return Hn(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Jr(t,e,n))}function Hs(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function zs(t){this.za=0,this.l=[],this.h=new nr,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Hs("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Hs("baseRetryDelayMs",5e3,t),this.$a=Hs("retryDelaySeedMs",1e4,t),this.Ya=Hs("forwardChannelMaxRetries",2,t),this.ra=Hs("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new ds(t&&t.concurrentRequestLimit),this.Ca=new Is,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function Ks(t){if(Ws(t),3==t.G){var e=t.V++,n=zr(t.F);Jr(n,"SID",t.J),Jr(n,"RID",e),Jr(n,"TYPE","terminate"),Ys(t,n),(e=new Er(t,t.h,e,void 0)).K=2,e.v=Qr(zr(n)),n=!1,Tn.navigator&&Tn.navigator.sendBeacon&&(n=Tn.navigator.sendBeacon(e.v.toString(),"")),!n&&Tn.Image&&((new Image).src=e.v,n=!0),n||(e.g=uo(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Pr(e)}co(t)}function $s(t){t.g&&(no(t),t.g.cancel(),t.g=null)}function Ws(t){$s(t),t.u&&(Tn.clearTimeout(t.u),t.u=null),ro(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Tn.clearTimeout(t.m),t.m=null)}function Xs(t,e){t.l.push(new class{constructor(t,e){this.h=t,this.g=e}}(t.Za++,e)),3==t.G&&Js(t)}function Js(t){ps(t.i)||t.m||(t.m=!0,Gi(t.Ha,t),t.C=0)}function Qs(t,e){var n;n=e?e.m:t.V++;const i=zr(t.F);Jr(i,"SID",t.J),Jr(i,"RID",n),Jr(i,"AID",t.U),Ys(t,i),t.o&&t.s&&Gs(i,t.o,t.s),n=new Er(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=Zs(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),ys(t.i,n),Cr(n,i,e)}function Ys(t,e){t.j&&Vr({},(function(t,n){Jr(e,n,t)}))}function Zs(t,e,n){n=Math.min(t.l.length,n);var i=t.j?Cn(t.j.Oa,t.j,t):null;t:{var r=t.l;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=r[0].h,t.push("ofs="+e)):e=0:t.push("ofs="+e);let s=!0;for(let o=0;o<n;o++){let n=r[o].h;const a=r[o].g;if(n-=e,0>n)e=Math.max(0,r[o].h-100),s=!1;else try{bs(a,t,"req"+n+"_")}catch(t){i&&i(a)}}if(s){i=t.join("&");break t}}}return t=t.l.splice(0,n),e.D=t,i}function to(t){t.g||t.u||(t.Y=1,Gi(t.Ga,t),t.A=0)}function eo(t){return!(t.g||t.u||3<=t.A||(t.Y++,t.u=dr(Cn(t.Ga,t),oo(t,t.A)),t.A++,0))}function no(t){null!=t.B&&(Tn.clearTimeout(t.B),t.B=null)}function io(t){t.g=new Er(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=zr(t.oa);Jr(e,"RID","rpc"),Jr(e,"SID",t.J),Jr(e,"CI",t.N?"0":"1"),Jr(e,"AID",t.U),Ys(t,e),Jr(e,"TYPE","xmlhttp"),t.o&&t.s&&Gs(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=Qr(zr(e)),n.s=null,n.U=!0,Nr(n,t)}function ro(t){null!=t.v&&(Tn.clearTimeout(t.v),t.v=null)}function so(t,e){var n=null;if(t.g==e){ro(t),no(t),t.g=null;var i=2}else{if(!gs(t.i,e))return;n=e.D,vs(t.i,e),i=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==i){n=e.s?e.s.length:0,e=Date.now()-e.F;var r=t.C;Mi(i=or(),new lr(i,n,e,r)),Js(t)}else to(t);else if(3==(r=e.o)||0==r&&0<t.I||!(1==i&&function(t,e){return!(ms(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=dr(Cn(t.Ha,t,e),oo(t,t.C)),t.C++,0)))}(t,e)||2==i&&eo(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),r){case 1:ao(t,5);break;case 4:ao(t,10);break;case 3:ao(t,6);break;default:ao(t,2)}}function oo(t,e){let n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function ao(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var i=Cn(t.jb,t);n||(n=new Hr("//www.google.com/images/cleardot.gif"),Tn.location&&"http"==Tn.location.protocol||Kr(n,"https"),Qr(n)),function(t,e){const n=new nr;if(Tn.Image){const i=new Image;i.onload=Nn(Es,n,i,"TestLoadImage: loaded",!0,e),i.onerror=Nn(Es,n,i,"TestLoadImage: error",!1,e),i.onabort=Nn(Es,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=Nn(Es,n,i,"TestLoadImage: timeout",!1,e),Tn.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=t}else e(!1)}(n.toString(),i)}else ur(2);t.G=0,t.j&&t.j.va(e),co(t),Ws(t)}function co(t){t.G=0,t.I=-1,t.j&&(0==ws(t.i).length&&0==t.l.length||(t.i.i.length=0,xn(t.l),t.l.length=0),t.j.ua())}function ho(t,e,n){let i=function(t){return t instanceof Hr?zr(t):new Hr(t,void 0)}(n);if(""!=i.i)e&&$r(i,e+"."+i.i),Wr(i,i.m);else{const t=Tn.location;i=function(t,e,n,i){var r=new Hr(null,void 0);return t&&Kr(r,t),e&&$r(r,e),n&&Wr(r,n),i&&(r.l=i),r}(t.protocol,e?e+"."+t.hostname:t.hostname,+t.port,n)}return t.aa&&Hn(t.aa,(function(t,e){Jr(i,e,t)})),e=t.D,n=t.sa,e&&n&&Jr(i,e,n),Jr(i,"VER",t.ma),Ys(t,i),i}function uo(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new Rs(new _s({ib:!0})):new Rs(t.qa)).L=t.H,e}function lo(){}function fo(){if(Yn&&!(10<=Number(ui)))throw Error("Environmental error: no available transport.")}function po(t,e){Li.call(this),this.g=new zs(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!Un(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Un(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new yo(this)}function mo(t){Tr.call(this);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function go(){Ir.call(this),this.status=1}function yo(t){this.g=t}(gn=Rs.prototype).ea=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():vr.g(),this.C=this.u?gr(this.u):gr(vr),this.g.onreadystatechange=Cn(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void xs(this,t)}t=n||"";const r=new qr(this.headers);i&&Vr(i,(function(t,e){r.set(e,t)})),i=function(t){t:{var e=Ms;const n=t.length,i="string"==typeof t?t.split(""):t;for(let r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(r.T()),n=Tn.FormData&&t instanceof Tn.FormData,!(0<=Pn(Ls,e))||i||n||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{qs(this),0<this.B&&((this.K=function(t){return Yn&&hi()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Cn(this.pa,this)):this.A=Xi(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){xs(this,t)}},gn.pa=function(){void 0!==wn&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Mi(this,"timeout"),this.abort(8))},gn.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Mi(this,"complete"),Mi(this,"abort"),Vs(this))},gn.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Vs(this,!0)),Rs.Z.M.call(this)},gn.Fa=function(){this.s||(this.F||this.v||this.l?Fs(this):this.cb())},gn.cb=function(){Fs(this)},gn.ba=function(){try{return 2<Bs(this)?this.g.status:-1}catch(t){return-1}},gn.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},gn.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Ds(e)}},gn.Da=function(){return this.m},gn.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(gn=zs.prototype).ma=8,gn.G=1,gn.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(t){}},gn.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;const r=new Er(this,this.h,t,void 0);let s=this.s;if(this.P&&(s?(s=zn(s),$n(s,this.P)):s=this.P),null===this.o&&(r.H=s),this.ja)t:{for(var e=0,n=0;n<this.l.length;n++){var i=this.l[n];if(void 0===(i="__data__"in i.g&&"string"==typeof(i=i.g.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=n;break t}if(4096===e||n===this.l.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=Zs(this,r,e),Jr(n=zr(this.F),"RID",t),Jr(n,"CVER",22),this.D&&Jr(n,"X-HTTP-Session-Id",this.D),Ys(this,n),this.o&&s&&Gs(n,this.o,s),ys(this.i,r),this.Ra&&Jr(n,"TYPE","init"),this.ja?(Jr(n,"$req",e),Jr(n,"SID","null"),r.$=!0,Cr(r,n,null)):Cr(r,n,e),this.G=2}}else 3==this.G&&(t?Qs(this,t):0==this.l.length||ps(this.i)||Qs(this))},gn.Ga=function(){if(this.u=null,io(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=dr(Cn(this.bb,this),t)}},gn.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,ur(10),$s(this),io(this))},gn.ab=function(){null!=this.v&&(this.v=null,$s(this),eo(this),ur(19))},gn.jb=function(t){t?(this.h.info("Successfully pinged google.com"),ur(2)):(this.h.info("Failed to ping google.com"),ur(1))},(gn=lo.prototype).xa=function(){},gn.wa=function(){},gn.va=function(){},gn.ua=function(){},gn.Oa=function(){},fo.prototype.g=function(t,e){return new po(t,e)},Dn(po,Li),po.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),Gi(Cn(t.hb,t,e))),ur(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=ho(t,null,t.W),Js(t)},po.prototype.close=function(){Ks(this.g)},po.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,Xs(this.g,e)}else this.v?((e={}).__data__=Ui(t),Xs(this.g,e)):Xs(this.g,t)},po.prototype.M=function(){this.g.j=null,delete this.j,Ks(this.g),delete this.g,po.Z.M.call(this)},Dn(mo,Tr),Dn(go,Ir),Dn(yo,lo),yo.prototype.xa=function(){Mi(this.g,"a")},yo.prototype.wa=function(t){Mi(this.g,new mo(t))},yo.prototype.va=function(t){Mi(this.g,new go(t))},yo.prototype.ua=function(){Mi(this.g,"b")},fo.prototype.createWebChannel=fo.prototype.g,po.prototype.send=po.prototype.u,po.prototype.open=po.prototype.m,po.prototype.close=po.prototype.close,fr.NO_ERROR=0,fr.TIMEOUT=8,fr.HTTP_ERROR=6,pr.COMPLETE="complete",yr.EventType=wr,wr.OPEN="a",wr.CLOSE="b",wr.ERROR="c",wr.MESSAGE="d",Li.prototype.listen=Li.prototype.N,Rs.prototype.listenOnce=Rs.prototype.O,Rs.prototype.getLastError=Rs.prototype.La,Rs.prototype.getLastErrorCode=Rs.prototype.Da,Rs.prototype.getStatus=Rs.prototype.ba,Rs.prototype.getResponseJson=Rs.prototype.Qa,Rs.prototype.getResponseText=Rs.prototype.ga,Rs.prototype.send=Rs.prototype.ea;var vo=vn.createWebChannelTransport=function(){return new fo},wo=vn.getStatEventTarget=function(){return or()},To=vn.ErrorCode=fr,Io=vn.EventType=pr,bo=vn.Event=rr,Eo=vn.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},_o=vn.FetchXmlHttpFactory=_s,So=vn.WebChannel=yr,ko=vn.XhrIo=Rs;const Ao="@firebase/firestore";class Co{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Co.UNAUTHENTICATED=new Co(null),Co.GOOGLE_CREDENTIALS=new Co("google-credentials-uid"),Co.FIRST_PARTY=new Co("first-party-uid"),Co.MOCK_USER=new Co("mock-user");let No="9.6.3";const Do=new D("@firebase/firestore");function Ro(){return Do.logLevel}function Oo(t,...e){if(Do.logLevel<=_.DEBUG){const n=e.map(Mo);Do.debug(`Firestore (${No}): ${t}`,...n)}}function Po(t,...e){if(Do.logLevel<=_.ERROR){const n=e.map(Mo);Do.error(`Firestore (${No}): ${t}`,...n)}}function Lo(t,...e){if(Do.logLevel<=_.WARN){const n=e.map(Mo);Do.warn(`Firestore (${No}): ${t}`,...n)}}function Mo(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function xo(t="Unexpected state"){const e=`FIRESTORE (${No}) INTERNAL ASSERTION FAILED: `+t;throw Po(e),new Error(e)}function Uo(t,e){t||xo()}function Fo(t,e){return t}const Vo={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class qo extends c{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Bo{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class jo{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class Go{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(Co.UNAUTHENTICATED)))}shutdown(){}}class Ho{constructor(t){this.t=t,this.currentUser=Co.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const i=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let r=new Bo;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new Bo,t.enqueueRetryable((()=>i(this.currentUser)))};const s=()=>{const e=r;t.enqueueRetryable((async()=>{await e.promise,await i(this.currentUser)}))},o=t=>{Oo("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(Oo("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new Bo)}}),0),s()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(Oo("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(Uo("string"==typeof e.accessToken),new jo(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return Uo(null===t||"string"==typeof t),new Co(t)}}class zo{constructor(t,e,n){this.type="FirstParty",this.user=Co.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",e);const i=t.auth.getAuthHeaderValueForFirstParty([]);i&&this.headers.set("Authorization",i),n&&this.headers.set("X-Goog-Iam-Authorization-Token",n)}}class Ko{constructor(t,e,n){this.h=t,this.l=e,this.m=n}getToken(){return Promise.resolve(new zo(this.h,this.l,this.m))}start(t,e){t.enqueueRetryable((()=>e(Co.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class $o{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Wo{constructor(t){this.g=t,this.forceRefresh=!1,this.appCheck=null}start(t,e){this.o=n=>{t.enqueueRetryable((()=>(t=>(null!=t.error&&Oo("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`),e(t.token)))(n)))};const n=t=>{Oo("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.g.onInit((t=>n(t))),setTimeout((()=>{if(!this.appCheck){const t=this.g.getImmediate({optional:!0});t?n(t):Oo("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(Uo("string"==typeof t.token),new $o(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}class Xo{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.p(t),this.T=t=>e.writeSequenceNumber(t))}p(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.T&&this.T(t),t}}function Jo(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}Xo.I=-1;class Qo{static A(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const i=Jo(40);for(let r=0;r<i.length;++r)n.length<20&&i[r]<e&&(n+=t.charAt(i[r]%t.length))}return n}}function Yo(t,e){return t<e?-1:t>e?1:0}function Zo(t,e,n){return t.length===e.length&&t.every(((t,i)=>n(t,e[i])))}class ta{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new qo(Vo.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new qo(Vo.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new qo(Vo.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new qo(Vo.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return ta.fromMillis(Date.now())}static fromDate(t){return ta.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new ta(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?Yo(this.nanoseconds,t.nanoseconds):Yo(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class ea{constructor(t){this.timestamp=t}static fromTimestamp(t){return new ea(t)}static min(){return new ea(new ta(0,0))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function na(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ia(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ra(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class sa{constructor(t,e,n){void 0===e?e=0:e>t.length&&xo(),void 0===n?n=t.length-e:n>t.length-e&&xo(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===sa.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof sa?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=t.get(i),r=e.get(i);if(n<r)return-1;if(n>r)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class oa extends sa{construct(t,e,n){return new oa(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new qo(Vo.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new oa(e)}static emptyPath(){return new oa([])}}const aa=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ca extends sa{construct(t,e,n){return new ca(t,e,n)}static isValidIdentifier(t){return aa.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ca.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new ca(["__name__"])}static fromServerFormat(t){const e=[];let n="",i=0;const r=()=>{if(0===n.length)throw new qo(Vo.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new qo(Vo.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new qo(Vo.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(s=!s,i++):"."!==e||s?(n+=e,i++):(r(),i++)}if(r(),s)throw new qo(Vo.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ca(e)}static emptyPath(){return new ca([])}}class ha{constructor(t){this.fields=t,t.sort(ca.comparator)}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Zo(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class ua{constructor(t){this.binaryString=t}static fromBase64String(t){const e=atob(t);return new ua(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new ua(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Yo(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}ua.EMPTY_BYTE_STRING=new ua("");const la=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function da(t){if(Uo(!!t),"string"==typeof t){let e=0;const n=la.exec(t);if(Uo(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:fa(t.seconds),nanos:fa(t.nanos)}}function fa(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function pa(t){return"string"==typeof t?ua.fromBase64String(t):ua.fromUint8Array(t)}function ma(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ga(t){const e=t.mapValue.fields.__previous_value__;return ma(e)?ga(e):e}function ya(t){const e=da(t.mapValue.fields.__local_write_time__.timestampValue);return new ta(e.seconds,e.nanos)}function va(t){return null==t}function wa(t){return 0===t&&1/t==-1/0}class Ta{constructor(t){this.path=t}static fromPath(t){return new Ta(oa.fromString(t))}static fromName(t){return new Ta(oa.fromString(t).popFirst(5))}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}isEqual(t){return null!==t&&0===oa.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return oa.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Ta(new oa(t.slice()))}}function Ia(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ma(t)?4:10:xo()}function ba(t,e){if(t===e)return!0;const n=Ia(t);if(n!==Ia(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ya(t).isEqual(ya(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=da(t.timestampValue),i=da(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return pa(t.bytesValue).isEqual(pa(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return fa(t.geoPointValue.latitude)===fa(e.geoPointValue.latitude)&&fa(t.geoPointValue.longitude)===fa(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return fa(t.integerValue)===fa(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=fa(t.doubleValue),i=fa(e.doubleValue);return n===i?wa(n)===wa(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return Zo(t.arrayValue.values||[],e.arrayValue.values||[],ba);case 10:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(na(n)!==na(i))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===i[t]||!ba(n[t],i[t])))return!1;return!0}(t,e);default:return xo()}}function Ea(t,e){return void 0!==(t.values||[]).find((t=>ba(t,e)))}function _a(t,e){if(t===e)return 0;const n=Ia(t),i=Ia(e);if(n!==i)return Yo(n,i);switch(n){case 0:return 0;case 1:return Yo(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=fa(t.integerValue||t.doubleValue),i=fa(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return Sa(t.timestampValue,e.timestampValue);case 4:return Sa(ya(t),ya(e));case 5:return Yo(t.stringValue,e.stringValue);case 6:return function(t,e){const n=pa(t),i=pa(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let t=0;t<n.length&&t<i.length;t++){const e=Yo(n[t],i[t]);if(0!==e)return e}return Yo(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=Yo(fa(t.latitude),fa(e.latitude));return 0!==n?n:Yo(fa(t.longitude),fa(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],i=e.values||[];for(let t=0;t<n.length&&t<i.length;++t){const e=_a(n[t],i[t]);if(e)return e}return Yo(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){const n=t.fields||{},i=Object.keys(n),r=e.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let t=0;t<i.length&&t<s.length;++t){const e=Yo(i[t],s[t]);if(0!==e)return e;const o=_a(n[i[t]],r[s[t]]);if(0!==o)return o}return Yo(i.length,s.length)}(t.mapValue,e.mapValue);default:throw xo()}}function Sa(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Yo(t,e);const n=da(t),i=da(e),r=Yo(n.seconds,i.seconds);return 0!==r?r:Yo(n.nanos,i.nanos)}function ka(t){return Aa(t)}function Aa(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=da(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?pa(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Ta.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(t){let e="[",n=!0;for(const i of t.values||[])n?n=!1:e+=",",e+=Aa(i);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",i=!0;for(const r of e)i?i=!1:n+=",",n+=`${r}:${Aa(t.fields[r])}`;return n+"}"}(t.mapValue):xo();var e,n}function Ca(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Na(t){return!!t&&"integerValue"in t}function Da(t){return!!t&&"arrayValue"in t}function Ra(t){return!!t&&"nullValue"in t}function Oa(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Pa(t){return!!t&&"mapValue"in t}function La(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ia(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=La(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=La(t.arrayValue.values[n]);return e}return Object.assign({},t)}class Ma{constructor(t){this.value=t}static empty(){return new Ma({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Pa(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=La(e)}setAll(t){let e=ca.emptyPath(),n={},i=[];t.forEach(((t,r)=>{if(!e.isImmediateParentOf(r)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=r.popLast()}t?n[r.lastSegment()]=La(t):i.push(r.lastSegment())}));const r=this.getFieldsMap(e);this.applyChanges(r,n,i)}delete(t){const e=this.field(t.popLast());Pa(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return ba(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];Pa(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){ia(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new Ma(La(this.value))}}function xa(t){const e=[];return ia(t.fields,((t,n)=>{const i=new ca([t]);if(Pa(n)){const t=xa(n.mapValue).fields;if(0===t.length)e.push(i);else for(const n of t)e.push(i.child(n))}else e.push(i)})),new ha(e)}class Ua{constructor(t,e,n,i,r){this.key=t,this.documentType=e,this.version=n,this.data=i,this.documentState=r}static newInvalidDocument(t){return new Ua(t,0,ea.min(),Ma.empty(),0)}static newFoundDocument(t,e,n){return new Ua(t,1,e,n,0)}static newNoDocument(t,e){return new Ua(t,2,e,Ma.empty(),0)}static newUnknownDocument(t,e){return new Ua(t,3,e,Ma.empty(),2)}convertToFoundDocument(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Ma.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Ma.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof Ua&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Ua(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Fa{constructor(t,e=null,n=[],i=[],r=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=s,this.endAt=o,this.R=null}}function Va(t,e=null,n=[],i=[],r=null,s=null,o=null){return new Fa(t,e,n,i,r,s,o)}function qa(t){const e=Fo(t);if(null===e.R){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>function(t){return t.field.canonicalString()+t.op.toString()+ka(t.value)}(t))).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),va(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Za(e.startAt)),e.endAt&&(t+="|ub:",t+=Za(e.endAt)),e.R=t}return e.R}function Ba(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!ec(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(n=t.filters[r],i=e.filters[r],n.op!==i.op||!n.field.isEqual(i.field)||!ba(n.value,i.value))return!1;var n,i;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ic(t.startAt,e.startAt)&&ic(t.endAt,e.endAt)}function ja(t){return Ta.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}class Ga extends class{}{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.P(t,e,n):new Ha(t,e,n):"array-contains"===e?new Wa(t,n):"in"===e?new Xa(t,n):"not-in"===e?new Ja(t,n):"array-contains-any"===e?new Qa(t,n):new Ga(t,e,n)}static P(t,e,n){return"in"===e?new za(t,n):new Ka(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.v(_a(e,this.value)):null!==e&&Ia(this.value)===Ia(e)&&this.v(_a(e,this.value))}v(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return xo()}}V(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class Ha extends Ga{constructor(t,e,n){super(t,e,n),this.key=Ta.fromName(n.referenceValue)}matches(t){const e=Ta.comparator(t.key,this.key);return this.v(e)}}class za extends Ga{constructor(t,e){super(t,"in",e),this.keys=$a(0,e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class Ka extends Ga{constructor(t,e){super(t,"not-in",e),this.keys=$a(0,e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function $a(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>Ta.fromName(t.referenceValue)))}class Wa extends Ga{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Da(e)&&Ea(e.arrayValue,this.value)}}class Xa extends Ga{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Ea(this.value.arrayValue,e)}}class Ja extends Ga{constructor(t,e){super(t,"not-in",e)}matches(t){if(Ea(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!Ea(this.value.arrayValue,e)}}class Qa extends Ga{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Da(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>Ea(this.value.arrayValue,t)))}}class Ya{constructor(t,e){this.position=t,this.before=e}}function Za(t){return`${t.before?"b":"a"}:${t.position.map((t=>ka(t))).join(",")}`}class tc{constructor(t,e="asc"){this.field=t,this.dir=e}}function ec(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function nc(t,e,n){let i=0;for(let r=0;r<t.position.length;r++){const s=e[r],o=t.position[r];if(i=s.field.isKeyField()?Ta.comparator(Ta.fromName(o.referenceValue),n.key):_a(o,n.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return t.before?i<=0:i<0}function ic(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ba(t.position[n],e.position[n]))return!1;return!0}class rc{constructor(t,e=null,n=[],i=[],r=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=s,this.startAt=o,this.endAt=a,this.S=null,this.D=null,this.startAt,this.endAt}}function sc(t){return new rc(t)}function oc(t){return!va(t.limit)&&"F"===t.limitType}function ac(t){return!va(t.limit)&&"L"===t.limitType}function cc(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function hc(t){for(const e of t.filters)if(e.V())return e.field;return null}function uc(t){return null!==t.collectionGroup}function lc(t){const e=Fo(t);if(null===e.S){e.S=[];const t=hc(e),n=cc(e);if(null!==t&&null===n)t.isKeyField()||e.S.push(new tc(t)),e.S.push(new tc(ca.keyField(),"asc"));else{let t=!1;for(const n of e.explicitOrderBy)e.S.push(n),n.field.isKeyField()&&(t=!0);if(!t){const t=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.S.push(new tc(ca.keyField(),t))}}}return e.S}function dc(t){const e=Fo(t);if(!e.D)if("F"===e.limitType)e.D=Va(e.path,e.collectionGroup,lc(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const n of lc(e)){const e="desc"===n.dir?"asc":"desc";t.push(new tc(n.field,e))}const n=e.endAt?new Ya(e.endAt.position,!e.endAt.before):null,i=e.startAt?new Ya(e.startAt.position,!e.startAt.before):null;e.D=Va(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}return e.D}function fc(t,e){return Ba(dc(t),dc(e))&&t.limitType===e.limitType}function pc(t){return`${qa(dc(t))}|lt:${t.limitType}`}function mc(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>{return`${(e=t).field.canonicalString()} ${e.op} ${ka(e.value)}`;var e})).join(", ")}]`),va(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: "+Za(t.startAt)),t.endAt&&(e+=", endAt: "+Za(t.endAt)),`Target(${e})`}(dc(t))}; limitType=${t.limitType})`}function gc(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Ta.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of t.explicitOrderBy)if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!nc(t.startAt,lc(t),e)||t.endAt&&nc(t.endAt,lc(t),e))}(t,e)}function yc(t){return(e,n)=>{let i=!1;for(const r of lc(t)){const t=vc(r,e,n);if(0!==t)return t;i=i||r.field.isKeyField()}return 0}}function vc(t,e,n){const i=t.field.isKeyField()?Ta.comparator(e.key,n.key):function(t,e,n){const i=e.data.field(t),r=n.data.field(t);return null!==i&&null!==r?_a(i,r):xo()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return xo()}}function wc(t,e){if(t.C){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:wa(e)?"-0":e}}function Tc(t){return{integerValue:""+t}}function Ic(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!wa(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?Tc(e):wc(t,e)}class bc{constructor(){this._=void 0}}function Ec(t,e,n){return t instanceof kc?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Ac?Cc(t,e):t instanceof Nc?Dc(t,e):function(t,e){const n=Sc(t,e),i=Oc(n)+Oc(t.N);return Na(n)&&Na(t.N)?Tc(i):wc(t.k,i)}(t,e)}function _c(t,e,n){return t instanceof Ac?Cc(t,e):t instanceof Nc?Dc(t,e):n}function Sc(t,e){return t instanceof Rc?Na(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}class kc extends bc{}class Ac extends bc{constructor(t){super(),this.elements=t}}function Cc(t,e){const n=Pc(e);for(const e of t.elements)n.some((t=>ba(t,e)))||n.push(e);return{arrayValue:{values:n}}}class Nc extends bc{constructor(t){super(),this.elements=t}}function Dc(t,e){let n=Pc(e);for(const e of t.elements)n=n.filter((t=>!ba(t,e)));return{arrayValue:{values:n}}}class Rc extends bc{constructor(t,e){super(),this.k=t,this.N=e}}function Oc(t){return fa(t.integerValue||t.doubleValue)}function Pc(t){return Da(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Lc{constructor(t,e){this.field=t,this.transform=e}}class Mc{constructor(t,e){this.version=t,this.transformResults=e}}class xc{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new xc}static exists(t){return new xc(void 0,t)}static updateTime(t){return new xc(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Uc(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Fc{}function Vc(t,e,n){t instanceof Hc?function(t,e,n){const i=t.value.clone(),r=$c(t.fieldTransforms,e,n.transformResults);i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):t instanceof zc?function(t,e,n){if(!Uc(t.precondition,e))return void e.convertToUnknownDocument(n.version);const i=$c(t.fieldTransforms,e,n.transformResults),r=e.data;r.setAll(Kc(t)),r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function qc(t,e,n){t instanceof Hc?function(t,e,n){if(!Uc(t.precondition,e))return;const i=t.value.clone(),r=Wc(t.fieldTransforms,n,e);i.setAll(r),e.convertToFoundDocument(Gc(e),i).setHasLocalMutations()}(t,e,n):t instanceof zc?function(t,e,n){if(!Uc(t.precondition,e))return;const i=Wc(t.fieldTransforms,n,e),r=e.data;r.setAll(Kc(t)),r.setAll(i),e.convertToFoundDocument(Gc(e),r).setHasLocalMutations()}(t,e,n):function(t,e){Uc(t.precondition,e)&&e.convertToNoDocument(ea.min())}(t,e)}function Bc(t,e){let n=null;for(const i of t.fieldTransforms){const t=e.data.field(i.field),r=Sc(i.transform,t||null);null!=r&&(null==n&&(n=Ma.empty()),n.set(i.field,r))}return n||null}function jc(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Zo(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Ac&&e instanceof Ac||t instanceof Nc&&e instanceof Nc?Zo(t.elements,e.elements,ba):t instanceof Rc&&e instanceof Rc?ba(t.N,e.N):t instanceof kc&&e instanceof kc}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Gc(t){return t.isFoundDocument()?t.version:ea.min()}class Hc extends Fc{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}}class zc extends Fc{constructor(t,e,n,i,r=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}}function Kc(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function $c(t,e,n){const i=new Map;Uo(t.length===n.length);for(let r=0;r<n.length;r++){const s=t[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,_c(o,a,n[r]))}return i}function Wc(t,e,n){const i=new Map;for(const r of t){const t=r.transform,s=n.data.field(r.field);i.set(r.field,Ec(t,s,e))}return i}class Xc extends Fc{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}}class Jc extends Fc{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}}class Qc{constructor(t){this.count=t}}var Yc,Zc;function th(t){if(void 0===t)return Po("GRPC error has no .code"),Vo.UNKNOWN;switch(t){case Yc.OK:return Vo.OK;case Yc.CANCELLED:return Vo.CANCELLED;case Yc.UNKNOWN:return Vo.UNKNOWN;case Yc.DEADLINE_EXCEEDED:return Vo.DEADLINE_EXCEEDED;case Yc.RESOURCE_EXHAUSTED:return Vo.RESOURCE_EXHAUSTED;case Yc.INTERNAL:return Vo.INTERNAL;case Yc.UNAVAILABLE:return Vo.UNAVAILABLE;case Yc.UNAUTHENTICATED:return Vo.UNAUTHENTICATED;case Yc.INVALID_ARGUMENT:return Vo.INVALID_ARGUMENT;case Yc.NOT_FOUND:return Vo.NOT_FOUND;case Yc.ALREADY_EXISTS:return Vo.ALREADY_EXISTS;case Yc.PERMISSION_DENIED:return Vo.PERMISSION_DENIED;case Yc.FAILED_PRECONDITION:return Vo.FAILED_PRECONDITION;case Yc.ABORTED:return Vo.ABORTED;case Yc.OUT_OF_RANGE:return Vo.OUT_OF_RANGE;case Yc.UNIMPLEMENTED:return Vo.UNIMPLEMENTED;case Yc.DATA_LOSS:return Vo.DATA_LOSS;default:return xo()}}(Zc=Yc||(Yc={}))[Zc.OK=0]="OK",Zc[Zc.CANCELLED=1]="CANCELLED",Zc[Zc.UNKNOWN=2]="UNKNOWN",Zc[Zc.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Zc[Zc.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Zc[Zc.NOT_FOUND=5]="NOT_FOUND",Zc[Zc.ALREADY_EXISTS=6]="ALREADY_EXISTS",Zc[Zc.PERMISSION_DENIED=7]="PERMISSION_DENIED",Zc[Zc.UNAUTHENTICATED=16]="UNAUTHENTICATED",Zc[Zc.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Zc[Zc.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Zc[Zc.ABORTED=10]="ABORTED",Zc[Zc.OUT_OF_RANGE=11]="OUT_OF_RANGE",Zc[Zc.UNIMPLEMENTED=12]="UNIMPLEMENTED",Zc[Zc.INTERNAL=13]="INTERNAL",Zc[Zc.UNAVAILABLE=14]="UNAVAILABLE",Zc[Zc.DATA_LOSS=15]="DATA_LOSS";class eh{constructor(t,e){this.comparator=t,this.root=e||ih.EMPTY}insert(t,e){return new eh(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,ih.BLACK,null,null))}remove(t){return new eh(this.comparator,this.root.remove(t,this.comparator).copy(null,null,ih.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new nh(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new nh(this.root,t,this.comparator,!1)}getReverseIterator(){return new nh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new nh(this.root,t,this.comparator,!0)}}class nh{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(0===r){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class ih{constructor(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:ih.RED,this.left=null!=i?i:ih.EMPTY,this.right=null!=r?r:ih.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,r){return new ih(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const r=n(t,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ih.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return ih.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,ih.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,ih.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw xo();if(this.right.isRed())throw xo();const t=this.left.check();if(t!==this.right.check())throw xo();return t+(this.isRed()?0:1)}}ih.EMPTY=null,ih.RED=!0,ih.BLACK=!1,ih.EMPTY=new class{constructor(){this.size=0}get key(){throw xo()}get value(){throw xo()}get color(){throw xo()}get left(){throw xo()}get right(){throw xo()}copy(t,e,n,i,r){return this}insert(t,e,n){return new ih(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class rh{constructor(t){this.comparator=t,this.data=new eh(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new sh(this.data.getIterator())}getIteratorFrom(t){return new sh(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof rh))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new rh(this.comparator);return e.data=t,e}}class sh{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}const oh=new eh(Ta.comparator);function ah(){return oh}const ch=new eh(Ta.comparator);function hh(){return ch}const uh=new eh(Ta.comparator);const lh=new rh(Ta.comparator);function dh(...t){let e=lh;for(const n of t)e=e.add(n);return e}const fh=new rh(Yo);function ph(){return fh}class mh{constructor(t,e,n,i,r){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(t,e){const n=new Map;return n.set(t,gh.createSynthesizedTargetChangeForCurrentChange(t,e)),new mh(ea.min(),n,ph(),ah(),dh())}}class gh{constructor(t,e,n,i,r){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(t,e){return new gh(ua.EMPTY_BYTE_STRING,e,dh(),dh(),dh())}}class yh{constructor(t,e,n,i){this.$=t,this.removedTargetIds=e,this.key=n,this.O=i}}class vh{constructor(t,e){this.targetId=t,this.M=e}}class wh{constructor(t,e,n=ua.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}}class Th{constructor(){this.F=0,this.L=Eh(),this.B=ua.EMPTY_BYTE_STRING,this.U=!1,this.q=!0}get current(){return this.U}get resumeToken(){return this.B}get K(){return 0!==this.F}get j(){return this.q}W(t){t.approximateByteSize()>0&&(this.q=!0,this.B=t)}G(){let t=dh(),e=dh(),n=dh();return this.L.forEach(((i,r)=>{switch(r){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:n=n.add(i);break;default:xo()}})),new gh(this.B,this.U,t,e,n)}H(){this.q=!1,this.L=Eh()}J(t,e){this.q=!0,this.L=this.L.insert(t,e)}Y(t){this.q=!0,this.L=this.L.remove(t)}X(){this.F+=1}Z(){this.F-=1}tt(){this.q=!0,this.U=!0}}class Ih{constructor(t){this.et=t,this.nt=new Map,this.st=ah(),this.it=bh(),this.rt=new rh(Yo)}ot(t){for(const e of t.$)t.O&&t.O.isFoundDocument()?this.ct(e,t.O):this.at(e,t.key,t.O);for(const e of t.removedTargetIds)this.at(e,t.key,t.O)}ut(t){this.forEachTarget(t,(e=>{const n=this.ht(e);switch(t.state){case 0:this.lt(e)&&n.W(t.resumeToken);break;case 1:n.Z(),n.K||n.H(),n.W(t.resumeToken);break;case 2:n.Z(),n.K||this.removeTarget(e);break;case 3:this.lt(e)&&(n.tt(),n.W(t.resumeToken));break;case 4:this.lt(e)&&(this.ft(e),n.W(t.resumeToken));break;default:xo()}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.nt.forEach(((t,n)=>{this.lt(n)&&e(n)}))}dt(t){const e=t.targetId,n=t.M.count,i=this.wt(e);if(i){const t=i.target;if(ja(t))if(0===n){const n=new Ta(t.path);this.at(e,n,Ua.newNoDocument(n,ea.min()))}else Uo(1===n);else this._t(e)!==n&&(this.ft(e),this.rt=this.rt.add(e))}}gt(t){const e=new Map;this.nt.forEach(((n,i)=>{const r=this.wt(i);if(r){if(n.current&&ja(r.target)){const e=new Ta(r.target.path);null!==this.st.get(e)||this.yt(i,e)||this.at(i,e,Ua.newNoDocument(e,t))}n.j&&(e.set(i,n.G()),n.H())}}));let n=dh();this.it.forEach(((t,e)=>{let i=!0;e.forEachWhile((t=>{const e=this.wt(t);return!e||2===e.purpose||(i=!1,!1)})),i&&(n=n.add(t))}));const i=new mh(t,e,this.rt,this.st,n);return this.st=ah(),this.it=bh(),this.rt=new rh(Yo),i}ct(t,e){if(!this.lt(t))return;const n=this.yt(t,e.key)?2:0;this.ht(t).J(e.key,n),this.st=this.st.insert(e.key,e),this.it=this.it.insert(e.key,this.Tt(e.key).add(t))}at(t,e,n){if(!this.lt(t))return;const i=this.ht(t);this.yt(t,e)?i.J(e,1):i.Y(e),this.it=this.it.insert(e,this.Tt(e).delete(t)),n&&(this.st=this.st.insert(e,n))}removeTarget(t){this.nt.delete(t)}_t(t){const e=this.ht(t).G();return this.et.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}X(t){this.ht(t).X()}ht(t){let e=this.nt.get(t);return e||(e=new Th,this.nt.set(t,e)),e}Tt(t){let e=this.it.get(t);return e||(e=new rh(Yo),this.it=this.it.insert(t,e)),e}lt(t){const e=null!==this.wt(t);return e||Oo("WatchChangeAggregator","Detected inactive target",t),e}wt(t){const e=this.nt.get(t);return e&&e.K?null:this.et.Et(t)}ft(t){this.nt.set(t,new Th),this.et.getRemoteKeysForTarget(t).forEach((e=>{this.at(t,e,null)}))}yt(t,e){return this.et.getRemoteKeysForTarget(t).has(e)}}function bh(){return new eh(Ta.comparator)}function Eh(){return new eh(Ta.comparator)}const _h={asc:"ASCENDING",desc:"DESCENDING"},Sh={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class kh{constructor(t,e){this.databaseId=t,this.C=e}}function Ah(t,e){return t.C?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ch(t,e){return t.C?e.toBase64():e.toUint8Array()}function Nh(t,e){return Ah(t,e.toTimestamp())}function Dh(t){return Uo(!!t),ea.fromTimestamp(function(t){const e=da(t);return new ta(e.seconds,e.nanos)}(t))}function Rh(t,e){return function(t){return new oa(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Oh(t){const e=oa.fromString(t);return Uo(Yh(e)),e}function Ph(t,e){return Rh(t.databaseId,e.path)}function Lh(t,e){const n=Oh(e);if(n.get(1)!==t.databaseId.projectId)throw new qo(Vo.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new qo(Vo.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ta(Uh(n))}function Mh(t,e){return Rh(t.databaseId,e)}function xh(t){return new oa(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Uh(t){return Uo(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Fh(t,e,n){return{name:Ph(t,e),fields:n.value.mapValue.fields}}function Vh(t,e){return{documents:[Mh(t,e.path)]}}function qh(t,e){const n={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(n.parent=Mh(t,i),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Mh(t,i.popLast()),n.structuredQuery.from=[{collectionId:i.lastSegment()}]);const r=function(t){if(0===t.length)return;const e=t.map((t=>function(t){if("=="===t.op){if(Oa(t.value))return{unaryFilter:{field:$h(t.field),op:"IS_NAN"}};if(Ra(t.value))return{unaryFilter:{field:$h(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Oa(t.value))return{unaryFilter:{field:$h(t.field),op:"IS_NOT_NAN"}};if(Ra(t.value))return{unaryFilter:{field:$h(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:$h(t.field),op:Kh(t.op),value:t.value}}}(t)));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}(e.filters);r&&(n.structuredQuery.where=r);const s=function(t){if(0!==t.length)return t.map((t=>function(t){return{field:$h(t.field),direction:zh(t.dir)}}(t)))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=function(t,e){return t.C||va(e)?e:{value:e}}(t,e.limit);return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=Gh(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Gh(e.endAt)),n}function Bh(t){let e=function(t){const e=Oh(t);return 4===e.length?oa.emptyPath():Uh(e)}(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){Uo(1===i);const t=n.from[0];t.allDescendants?r=t.collectionId:e=e.child(t.collectionId)}let s=[];n.where&&(s=jh(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((t=>function(t){return new tc(Wh(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t))));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,va(e)?null:e}(n.limit));let c=null;n.startAt&&(c=Hh(n.startAt));let h=null;return n.endAt&&(h=Hh(n.endAt)),function(t,e,n,i,r,s,o,a){return new rc(t,e,n,i,r,s,o,a)}(e,r,o,s,a,"F",c,h)}function jh(t){return t?void 0!==t.unaryFilter?[Jh(t)]:void 0!==t.fieldFilter?[Xh(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((t=>jh(t))).reduce(((t,e)=>t.concat(e))):xo():[]}function Gh(t){return{before:t.before,values:t.position}}function Hh(t){const e=!!t.before,n=t.values||[];return new Ya(n,e)}function zh(t){return _h[t]}function Kh(t){return Sh[t]}function $h(t){return{fieldPath:t.canonicalString()}}function Wh(t){return ca.fromServerFormat(t.fieldPath)}function Xh(t){return Ga.create(Wh(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return xo()}}(t.fieldFilter.op),t.fieldFilter.value)}function Jh(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Wh(t.unaryFilter.field);return Ga.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Wh(t.unaryFilter.field);return Ga.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Wh(t.unaryFilter.field);return Ga.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=Wh(t.unaryFilter.field);return Ga.create(r,"!=",{nullValue:"NULL_VALUE"});default:return xo()}}function Qh(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Yh(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function Zh(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=eu(e)),e=tu(t.get(n),e);return eu(e)}function tu(t,e){let n=e;const i=t.length;for(let e=0;e<i;e++){const i=t.charAt(e);switch(i){case"\0":n+="";break;case"":n+="";break;default:n+=i}}return n}function eu(t){return t+""}class nu{constructor(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}}nu.store="owner",nu.key="owner";class iu{constructor(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}}iu.store="mutationQueues",iu.keyPath="userId";class ru{constructor(t,e,n,i,r){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=i,this.mutations=r}}ru.store="mutations",ru.keyPath="batchId",ru.userMutationsIndex="userMutationsIndex",ru.userMutationsKeyPath=["userId","batchId"];class su{constructor(){}static prefixForUser(t){return[t]}static prefixForPath(t,e){return[t,Zh(e)]}static key(t,e,n){return[t,Zh(e),n]}}su.store="documentMutations",su.PLACEHOLDER=new su;class ou{constructor(t,e,n,i,r,s){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=i,this.readTime=r,this.parentPath=s}}ou.store="remoteDocuments",ou.readTimeIndex="readTimeIndex",ou.readTimeIndexPath="readTime",ou.collectionReadTimeIndex="collectionReadTimeIndex",ou.collectionReadTimeIndexPath=["parentPath","readTime"];class au{constructor(t){this.byteSize=t}}au.store="remoteDocumentGlobal",au.key="remoteDocumentGlobalKey";class cu{constructor(t,e,n,i,r,s,o){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=i,this.lastListenSequenceNumber=r,this.lastLimboFreeSnapshotVersion=s,this.query=o}}cu.store="targets",cu.keyPath="targetId",cu.queryTargetsIndexName="queryTargetsIndex",cu.queryTargetsKeyPath=["canonicalId","targetId"];class hu{constructor(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n}}hu.store="targetDocuments",hu.keyPath=["targetId","path"],hu.documentTargetsIndex="documentTargetsIndex",hu.documentTargetsKeyPath=["path","targetId"];class uu{constructor(t,e,n,i){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=i}}uu.key="targetGlobalKey",uu.store="targetGlobal";class lu{constructor(t,e){this.collectionId=t,this.parent=e}}lu.store="collectionParents",lu.keyPath=["collectionId","parent"];class du{constructor(t,e,n,i){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=i}}du.store="clientMetadata",du.keyPath="clientId";class fu{constructor(t,e,n){this.bundleId=t,this.createTime=e,this.version=n}}fu.store="bundles",fu.keyPath="bundleId";class pu{constructor(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n}}pu.store="namedQueries",pu.keyPath="name",iu.store,ru.store,su.store,ou.store,cu.store,nu.store,uu.store,hu.store,du.store,au.store,lu.store,fu.store,pu.store;class mu{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&xo(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new mu(((n,i)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,i)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof mu?e:mu.resolve(e)}catch(t){return mu.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):mu.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):mu.reject(e)}static resolve(t){return new mu(((e,n)=>{e(t)}))}static reject(t){return new mu(((e,n)=>{n(t)}))}static waitFor(t){return new mu(((e,n)=>{let i=0,r=0,s=!1;t.forEach((t=>{++i,t.next((()=>{++r,s&&r===i&&e()}),(t=>n(t)))})),s=!0,r===i&&e()}))}static or(t){let e=mu.resolve(!1);for(const n of t)e=e.next((t=>t?mu.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,i)=>{n.push(e.call(this,t,i))})),this.waitFor(n)}}function gu(t){return"IndexedDbTransactionError"===t.name}class yu{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const i=this.mutations[e];i.key.isEqual(t.key)&&Vc(i,t,n[e])}}applyToLocalView(t){for(const e of this.baseMutations)e.key.isEqual(t.key)&&qc(e,t,this.localWriteTime);for(const e of this.mutations)e.key.isEqual(t.key)&&qc(e,t,this.localWriteTime)}applyToLocalDocumentSet(t){this.mutations.forEach((e=>{const n=t.get(e.key),i=n;this.applyToLocalView(i),n.isValidDocument()||i.convertToNoDocument(ea.min())}))}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),dh())}isEqual(t){return this.batchId===t.batchId&&Zo(this.mutations,t.mutations,((t,e)=>jc(t,e)))&&Zo(this.baseMutations,t.baseMutations,((t,e)=>jc(t,e)))}}class vu{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){Uo(t.mutations.length===n.length);let i=uh;const r=t.mutations;for(let t=0;t<r.length;t++)i=i.insert(r[t].key,n[t].version);return new vu(t,e,n,i)}}class wu{constructor(t,e,n,i,r=ea.min(),s=ea.min(),o=ua.EMPTY_BYTE_STRING){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o}withSequenceNumber(t){return new wu(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(t,e){return new wu(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)}withLastLimboFreeSnapshotVersion(t){return new wu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}class Tu{constructor(t){this.Gt=t}}function Iu(t){const e=Bh({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?function(t,e,n){return new rc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}(e,e.limit,"L"):e}class bu{constructor(){this.zt=new Eu}addToCollectionParentIndex(t,e){return this.zt.add(e),mu.resolve()}getCollectionParents(t,e){return mu.resolve(this.zt.getEntries(e))}}class Eu{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new rh(oa.comparator),r=!i.has(n);return this.index[e]=i.add(n),r}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new rh(oa.comparator)).toArray()}}class _u{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new _u(t,_u.DEFAULT_COLLECTION_PERCENTILE,_u.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}_u.DEFAULT_COLLECTION_PERCENTILE=10,_u.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,_u.DEFAULT=new _u(41943040,_u.DEFAULT_COLLECTION_PERCENTILE,_u.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),_u.DISABLED=new _u(-1,0,0);class Su{constructor(t){this.se=t}next(){return this.se+=2,this.se}static ie(){return new Su(0)}static re(){return new Su(-1)}}async function ku(t){if(t.code!==Vo.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==t.message)throw t;Oo("LocalStore","Unexpectedly lost primary lease")}class Au{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,i]of n)if(this.equalsFn(e,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0!==i){for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],t))return void(i[n]=[t,e]);i.push([t,e])}else this.inner[n]=[[t,e]]}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),!0;return!1}forEach(t){ia(this.inner,((e,n)=>{for(const[e,i]of n)t(e,i)}))}isEmpty(){return ra(this.inner)}}class Cu{constructor(t,e,n){this.Je=t,this.An=e,this.Jt=n}Rn(t,e){return this.An.getAllMutationBatchesAffectingDocumentKey(t,e).next((n=>this.bn(t,e,n)))}bn(t,e,n){return this.Je.getEntry(t,e).next((t=>{for(const e of n)e.applyToLocalView(t);return t}))}Pn(t,e){t.forEach(((t,n)=>{for(const t of e)t.applyToLocalView(n)}))}vn(t,e){return this.Je.getEntries(t,e).next((e=>this.Vn(t,e).next((()=>e))))}Vn(t,e){return this.An.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>this.Pn(e,t)))}getDocumentsMatchingQuery(t,e,n){return function(t){return Ta.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Sn(t,e.path):uc(e)?this.Dn(t,e,n):this.Cn(t,e,n)}Sn(t,e){return this.Rn(t,new Ta(e)).next((t=>{let e=hh();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}Dn(t,e,n){const i=e.collectionGroup;let r=hh();return this.Jt.getCollectionParents(t,i).next((s=>mu.forEach(s,(s=>{const o=function(t,e){return new rc(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return this.Cn(t,o,n).next((t=>{t.forEach(((t,e)=>{r=r.insert(t,e)}))}))})).next((()=>r))))}Cn(t,e,n){let i,r;return this.Je.getDocumentsMatchingQuery(t,e,n).next((n=>(i=n,this.An.getAllMutationBatchesAffectingQuery(t,e)))).next((e=>(r=e,this.Nn(t,r,i).next((t=>{i=t;for(const t of r)for(const e of t.mutations){const n=e.key;let r=i.get(n);null==r&&(r=Ua.newInvalidDocument(n),i=i.insert(n,r)),qc(e,r,t.localWriteTime),r.isFoundDocument()||(i=i.remove(n))}}))))).next((()=>(i.forEach(((t,n)=>{gc(e,n)||(i=i.remove(t))})),i)))}Nn(t,e,n){let i=dh();for(const t of e)for(const e of t.mutations)e instanceof zc&&null===n.get(e.key)&&(i=i.add(e.key));let r=n;return this.Je.getEntries(t,i).next((t=>(t.forEach(((t,e)=>{e.isFoundDocument()&&(r=r.insert(t,e))})),r)))}}class Nu{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.kn=n,this.xn=i}static $n(t,e){let n=dh(),i=dh();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:i=i.add(t.doc.key)}return new Nu(t,e.fromCache,n,i)}}class Du{On(t){this.Mn=t}getDocumentsMatchingQuery(t,e,n,i){return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(ea.min())?this.Fn(t,e):this.Mn.vn(t,i).next((r=>{const s=this.Ln(e,r);return(oc(e)||ac(e))&&this.Bn(e.limitType,s,i,n)?this.Fn(t,e):(Ro()<=_.DEBUG&&Oo("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),mc(e)),this.Mn.getDocumentsMatchingQuery(t,e,n).next((t=>(s.forEach((e=>{t=t.insert(e.key,e)})),t))))}))}Ln(t,e){let n=new rh(yc(t));return e.forEach(((e,i)=>{gc(t,i)&&(n=n.add(i))})),n}Bn(t,e,n,i){if(n.size!==e.size)return!0;const r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Fn(t,e){return Ro()<=_.DEBUG&&Oo("QueryEngine","Using full collection scan to execute query:",mc(e)),this.Mn.getDocumentsMatchingQuery(t,e,ea.min())}}class Ru{constructor(t,e,n,i){this.persistence=t,this.Un=e,this.k=i,this.qn=new eh(Yo),this.Kn=new Au((t=>qa(t)),Ba),this.jn=ea.min(),this.An=t.getMutationQueue(n),this.Qn=t.getRemoteDocumentCache(),this.He=t.getTargetCache(),this.Wn=new Cu(this.Qn,this.An,this.persistence.getIndexManager()),this.Ye=t.getBundleCache(),this.Un.On(this.Wn)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.qn)))}}async function Ou(t,e){const n=Fo(t);let i=n.An,r=n.Wn;const s=await n.persistence.runTransaction("Handle user change","readonly",(t=>{let s;return n.An.getAllMutationBatches(t).next((o=>(s=o,i=n.persistence.getMutationQueue(e),r=new Cu(n.Qn,i,n.persistence.getIndexManager()),i.getAllMutationBatches(t)))).next((e=>{const n=[],i=[];let o=dh();for(const t of s){n.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){i.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return r.vn(t,o).next((t=>({Gn:t,removedBatchIds:n,addedBatchIds:i})))}))}));return n.An=i,n.Wn=r,n.Un.On(n.Wn),s}function Pu(t){const e=Fo(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.He.getLastRemoteSnapshotVersion(t)))}function Lu(t,e){const n=Fo(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.An.getNextMutationBatchAfterBatchId(t,e))))}async function Mu(t,e,n){const i=Fo(t),r=i.qn.get(e),s=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",s,(t=>i.persistence.referenceDelegate.removeTarget(t,r)))}catch(t){if(!gu(t))throw t;Oo("LocalStore",`Failed to update sequence numbers for target ${e}: ${t}`)}i.qn=i.qn.remove(e),i.Kn.delete(r.target)}function xu(t,e,n){const i=Fo(t);let r=ea.min(),s=dh();return i.persistence.runTransaction("Execute query","readonly",(t=>function(t,e,n){const i=Fo(t),r=i.Kn.get(n);return void 0!==r?mu.resolve(i.qn.get(r)):i.He.getTargetData(e,n)}(i,t,dc(e)).next((e=>{if(e)return r=e.lastLimboFreeSnapshotVersion,i.He.getMatchingKeysForTargetId(t,e.targetId).next((t=>{s=t}))})).next((()=>i.Un.getDocumentsMatchingQuery(t,e,n?r:ea.min(),n?s:dh()))).next((t=>({documents:t,zn:s})))))}class Uu{constructor(t){this.k=t,this.Xn=new Map,this.Zn=new Map}getBundleMetadata(t,e){return mu.resolve(this.Xn.get(e))}saveBundleMetadata(t,e){var n;return this.Xn.set(e.id,{id:(n=e).id,version:n.version,createTime:Dh(n.createTime)}),mu.resolve()}getNamedQuery(t,e){return mu.resolve(this.Zn.get(e))}saveNamedQuery(t,e){return this.Zn.set(e.name,function(t){return{name:t.name,query:Iu(t.bundledQuery),readTime:Dh(t.readTime)}}(e)),mu.resolve()}}class Fu{constructor(){this.ts=new rh(Vu.es),this.ns=new rh(Vu.ss)}isEmpty(){return this.ts.isEmpty()}addReference(t,e){const n=new Vu(t,e);this.ts=this.ts.add(n),this.ns=this.ns.add(n)}rs(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.os(new Vu(t,e))}cs(t,e){t.forEach((t=>this.removeReference(t,e)))}us(t){const e=new Ta(new oa([])),n=new Vu(e,t),i=new Vu(e,t+1),r=[];return this.ns.forEachInRange([n,i],(t=>{this.os(t),r.push(t.key)})),r}hs(){this.ts.forEach((t=>this.os(t)))}os(t){this.ts=this.ts.delete(t),this.ns=this.ns.delete(t)}ls(t){const e=new Ta(new oa([])),n=new Vu(e,t),i=new Vu(e,t+1);let r=dh();return this.ns.forEachInRange([n,i],(t=>{r=r.add(t.key)})),r}containsKey(t){const e=new Vu(t,0),n=this.ts.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class Vu{constructor(t,e){this.key=t,this.fs=e}static es(t,e){return Ta.comparator(t.key,e.key)||Yo(t.fs,e.fs)}static ss(t,e){return Yo(t.fs,e.fs)||Ta.comparator(t.key,e.key)}}class qu{constructor(t,e){this.Jt=t,this.referenceDelegate=e,this.An=[],this.ds=1,this.ws=new rh(Vu.es)}checkEmpty(t){return mu.resolve(0===this.An.length)}addMutationBatch(t,e,n,i){const r=this.ds;this.ds++,this.An.length>0&&this.An[this.An.length-1];const s=new yu(r,e,n,i);this.An.push(s);for(const e of i)this.ws=this.ws.add(new Vu(e.key,r)),this.Jt.addToCollectionParentIndex(t,e.key.path.popLast());return mu.resolve(s)}lookupMutationBatch(t,e){return mu.resolve(this._s(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.gs(n),r=i<0?0:i;return mu.resolve(this.An.length>r?this.An[r]:null)}getHighestUnacknowledgedBatchId(){return mu.resolve(0===this.An.length?-1:this.ds-1)}getAllMutationBatches(t){return mu.resolve(this.An.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new Vu(e,0),i=new Vu(e,Number.POSITIVE_INFINITY),r=[];return this.ws.forEachInRange([n,i],(t=>{const e=this._s(t.fs);r.push(e)})),mu.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new rh(Yo);return e.forEach((t=>{const e=new Vu(t,0),i=new Vu(t,Number.POSITIVE_INFINITY);this.ws.forEachInRange([e,i],(t=>{n=n.add(t.fs)}))})),mu.resolve(this.ys(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let r=n;Ta.isDocumentKey(r)||(r=r.child(""));const s=new Vu(new Ta(r),0);let o=new rh(Yo);return this.ws.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(o=o.add(t.fs)),!0)}),s),mu.resolve(this.ys(o))}ys(t){const e=[];return t.forEach((t=>{const n=this._s(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){Uo(0===this.ps(e.batchId,"removed")),this.An.shift();let n=this.ws;return mu.forEach(e.mutations,(i=>{const r=new Vu(i.key,e.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.ws=n}))}ee(t){}containsKey(t,e){const n=new Vu(e,0),i=this.ws.firstAfterOrEqual(n);return mu.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.An.length,mu.resolve()}ps(t,e){return this.gs(t)}gs(t){return 0===this.An.length?0:t-this.An[0].batchId}_s(t){const e=this.gs(t);return e<0||e>=this.An.length?null:this.An[e]}}class Bu{constructor(t,e){this.Jt=t,this.Ts=e,this.docs=new eh(Ta.comparator),this.size=0}addEntry(t,e,n){const i=e.key,r=this.docs.get(i),s=r?r.size:0,o=this.Ts(e);return this.docs=this.docs.insert(i,{document:e.mutableCopy(),size:o,readTime:n}),this.size+=o-s,this.Jt.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return mu.resolve(n?n.document.mutableCopy():Ua.newInvalidDocument(e))}getEntries(t,e){let n=ah();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():Ua.newInvalidDocument(t))})),mu.resolve(n)}getDocumentsMatchingQuery(t,e,n){let i=ah();const r=new Ta(e.path.child("")),s=this.docs.getIteratorFrom(r);for(;s.hasNext();){const{key:t,value:{document:r,readTime:o}}=s.getNext();if(!e.path.isPrefixOf(t.path))break;o.compareTo(n)<=0||gc(e,r)&&(i=i.insert(r.key,r.mutableCopy()))}return mu.resolve(i)}Es(t,e){return mu.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new ju(this)}getSize(t){return mu.resolve(this.size)}}class ju extends class{constructor(){this.changes=new Au((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}getReadTime(t){const e=this.changes.get(t);return e?e.readTime:ea.min()}addEntry(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})}removeEntry(t,e=null){this.assertNotApplied(),this.changes.set(t,{document:Ua.newInvalidDocument(t),readTime:e})}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?mu.resolve(n.document):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}{constructor(t){super(),this.De=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.document.isValidDocument()?e.push(this.De.addEntry(t,i.document,this.getReadTime(n))):this.De.removeEntry(n)})),mu.waitFor(e)}getFromCache(t,e){return this.De.getEntry(t,e)}getAllFromCache(t,e){return this.De.getEntries(t,e)}}class Gu{constructor(t){this.persistence=t,this.Is=new Au((t=>qa(t)),Ba),this.lastRemoteSnapshotVersion=ea.min(),this.highestTargetId=0,this.As=0,this.Rs=new Fu,this.targetCount=0,this.bs=Su.ie()}forEachTarget(t,e){return this.Is.forEach(((t,n)=>e(n))),mu.resolve()}getLastRemoteSnapshotVersion(t){return mu.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return mu.resolve(this.As)}allocateTargetId(t){return this.highestTargetId=this.bs.next(),mu.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.As&&(this.As=e),mu.resolve()}ae(t){this.Is.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.bs=new Su(e),this.highestTargetId=e),t.sequenceNumber>this.As&&(this.As=t.sequenceNumber)}addTargetData(t,e){return this.ae(e),this.targetCount+=1,mu.resolve()}updateTargetData(t,e){return this.ae(e),mu.resolve()}removeTargetData(t,e){return this.Is.delete(e.target),this.Rs.us(e.targetId),this.targetCount-=1,mu.resolve()}removeTargets(t,e,n){let i=0;const r=[];return this.Is.forEach(((s,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.Is.delete(s),r.push(this.removeMatchingKeysForTargetId(t,o.targetId)),i++)})),mu.waitFor(r).next((()=>i))}getTargetCount(t){return mu.resolve(this.targetCount)}getTargetData(t,e){const n=this.Is.get(e)||null;return mu.resolve(n)}addMatchingKeys(t,e,n){return this.Rs.rs(e,n),mu.resolve()}removeMatchingKeys(t,e,n){this.Rs.cs(e,n);const i=this.persistence.referenceDelegate,r=[];return i&&e.forEach((e=>{r.push(i.markPotentiallyOrphaned(t,e))})),mu.waitFor(r)}removeMatchingKeysForTargetId(t,e){return this.Rs.us(e),mu.resolve()}getMatchingKeysForTargetId(t,e){const n=this.Rs.ls(e);return mu.resolve(n)}containsKey(t,e){return mu.resolve(this.Rs.containsKey(e))}}class Hu{constructor(t,e){this.Ps={},this.Be=new Xo(0),this.Ue=!1,this.Ue=!0,this.referenceDelegate=t(this),this.He=new Gu(this),this.Jt=new bu,this.Je=function(t,e){return new Bu(t,e)}(this.Jt,(t=>this.referenceDelegate.vs(t))),this.k=new Tu(e),this.Ye=new Uu(this.k)}start(){return Promise.resolve()}shutdown(){return this.Ue=!1,Promise.resolve()}get started(){return this.Ue}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(){return this.Jt}getMutationQueue(t){let e=this.Ps[t.toKey()];return e||(e=new qu(this.Jt,this.referenceDelegate),this.Ps[t.toKey()]=e),e}getTargetCache(){return this.He}getRemoteDocumentCache(){return this.Je}getBundleCache(){return this.Ye}runTransaction(t,e,n){Oo("MemoryPersistence","Starting transaction:",t);const i=new zu(this.Be.next());return this.referenceDelegate.Vs(),n(i).next((t=>this.referenceDelegate.Ss(i).next((()=>t)))).toPromise().then((t=>(i.raiseOnCommittedEvent(),t)))}Ds(t,e){return mu.or(Object.values(this.Ps).map((n=>()=>n.containsKey(t,e))))}}class zu extends class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}{constructor(t){super(),this.currentSequenceNumber=t}}class Ku{constructor(t){this.persistence=t,this.Cs=new Fu,this.Ns=null}static ks(t){return new Ku(t)}get xs(){if(this.Ns)return this.Ns;throw xo()}addReference(t,e,n){return this.Cs.addReference(n,e),this.xs.delete(n.toString()),mu.resolve()}removeReference(t,e,n){return this.Cs.removeReference(n,e),this.xs.add(n.toString()),mu.resolve()}markPotentiallyOrphaned(t,e){return this.xs.add(e.toString()),mu.resolve()}removeTarget(t,e){this.Cs.us(e.targetId).forEach((t=>this.xs.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.xs.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}Vs(){this.Ns=new Set}Ss(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return mu.forEach(this.xs,(n=>{const i=Ta.fromPath(n);return this.$s(t,i).next((t=>{t||e.removeEntry(i)}))})).next((()=>(this.Ns=null,e.apply(t))))}updateLimboDocument(t,e){return this.$s(t,e).next((t=>{t?this.xs.delete(e.toString()):this.xs.add(e.toString())}))}vs(t){return 0}$s(t,e){return mu.or([()=>mu.resolve(this.Cs.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ds(t,e)])}}class $u{constructor(){this.activeTargetIds=ph()}Fs(t){this.activeTargetIds=this.activeTargetIds.add(t)}Ls(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Ms(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Wu{constructor(){this.pi=new $u,this.Ti={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.pi.Fs(t),this.Ti[t]||"not-current"}updateQueryState(t,e,n){this.Ti[t]=e}removeLocalQueryTarget(t){this.pi.Ls(t)}isLocalQueryTarget(t){return this.pi.activeTargetIds.has(t)}clearQueryState(t){delete this.Ti[t]}getAllActiveQueryTargets(){return this.pi.activeTargetIds}isActiveQueryTarget(t){return this.pi.activeTargetIds.has(t)}start(){return this.pi=new $u,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(){}}class Xu{Ei(t){}shutdown(){}}class Ju{constructor(){this.Ii=()=>this.Ai(),this.Ri=()=>this.bi(),this.Pi=[],this.vi()}Ei(t){this.Pi.push(t)}shutdown(){window.removeEventListener("online",this.Ii),window.removeEventListener("offline",this.Ri)}vi(){window.addEventListener("online",this.Ii),window.addEventListener("offline",this.Ri)}Ai(){Oo("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.Pi)t(0)}bi(){Oo("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.Pi)t(1)}static Pt(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const Qu={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class Yu{constructor(t){this.Vi=t.Vi,this.Si=t.Si}Di(t){this.Ci=t}Ni(t){this.ki=t}onMessage(t){this.xi=t}close(){this.Si()}send(t){this.Vi(t)}$i(){this.Ci()}Oi(t){this.ki(t)}Mi(t){this.xi(t)}}class Zu extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http";this.Fi=e+"://"+t.host,this.Li="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}Bi(t,e,n,i,r){const s=this.Ui(t,e);Oo("RestConnection","Sending: ",s,n);const o={};return this.qi(o,i,r),this.Ki(t,s,o,n).then((t=>(Oo("RestConnection","Received: ",t),t)),(e=>{throw Lo("RestConnection",`${t} failed with error: `,e,"url: ",s,"request:",n),e}))}ji(t,e,n,i,r){return this.Bi(t,e,n,i,r)}qi(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+No,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}Ui(t,e){const n=Qu[t];return`${this.Fi}/v1/${e}:${n}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}Ki(t,e,n,i){return new Promise(((r,s)=>{const o=new ko;o.listenOnce(Io.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case To.NO_ERROR:const e=o.getResponseJson();Oo("Connection","XHR received:",JSON.stringify(e)),r(e);break;case To.TIMEOUT:Oo("Connection",'RPC "'+t+'" timed out'),s(new qo(Vo.DEADLINE_EXCEEDED,"Request time out"));break;case To.HTTP_ERROR:const n=o.getStatus();if(Oo("Connection",'RPC "'+t+'" failed with status:',n,"response text:",o.getResponseText()),n>0){const t=o.getResponseJson().error;if(t&&t.status&&t.message){const e=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(Vo).indexOf(e)>=0?e:Vo.UNKNOWN}(t.status);s(new qo(e,t.message))}else s(new qo(Vo.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new qo(Vo.UNAVAILABLE,"Connection failed."));break;default:xo()}}finally{Oo("Connection",'RPC "'+t+'" completed.')}}));const a=JSON.stringify(i);o.send(e,"POST",a,n,15)}))}Qi(t,e,n){const c=[this.Fi,"/","google.firestore.v1.Firestore","/",t,"/channel"],h=vo(),u=wo(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(l.xmlHttpFactory=new _o({})),this.qi(l.initMessageHeaders,e,n),r()||o()||i().indexOf("Electron/")>=0||a()||i().indexOf("MSAppHost/")>=0||s()||(l.httpHeadersOverwriteParam="$httpHeaders");const d=c.join("");Oo("Connection","Creating WebChannel: "+d,l);const f=h.createWebChannel(d,l);let p=!1,m=!1;const g=new Yu({Vi:t=>{m?Oo("Connection","Not sending because WebChannel is closed:",t):(p||(Oo("Connection","Opening WebChannel transport."),f.open(),p=!0),Oo("Connection","WebChannel sending:",t),f.send(t))},Si:()=>f.close()}),y=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return y(f,So.EventType.OPEN,(()=>{m||Oo("Connection","WebChannel transport opened.")})),y(f,So.EventType.CLOSE,(()=>{m||(m=!0,Oo("Connection","WebChannel transport closed"),g.Oi())})),y(f,So.EventType.ERROR,(t=>{m||(m=!0,Lo("Connection","WebChannel transport errored:",t),g.Oi(new qo(Vo.UNAVAILABLE,"The operation could not be completed")))})),y(f,So.EventType.MESSAGE,(t=>{var e;if(!m){const n=t.data[0];Uo(!!n);const i=n,r=i.error||(null===(e=i[0])||void 0===e?void 0:e.error);if(r){Oo("Connection","WebChannel received error:",r);const t=r.status;let e=function(t){const e=Yc[t];if(void 0!==e)return th(e)}(t),n=r.message;void 0===e&&(e=Vo.INTERNAL,n="Unknown error status: "+t+" with message "+r.message),m=!0,g.Oi(new qo(e,n)),f.close()}else Oo("Connection","WebChannel received:",n),g.Mi(n)}})),y(u,bo.STAT_EVENT,(t=>{t.stat===Eo.PROXY?Oo("Connection","Detected buffering proxy"):t.stat===Eo.NOPROXY&&Oo("Connection","Detected no buffering proxy")})),setTimeout((()=>{g.$i()}),0),g}}function tl(){return"undefined"!=typeof document?document:null}function el(t){return new kh(t,!0)}class nl{constructor(t,e,n=1e3,i=1.5,r=6e4){this.Me=t,this.timerId=e,this.Wi=n,this.Gi=i,this.zi=r,this.Hi=0,this.Ji=null,this.Yi=Date.now(),this.reset()}reset(){this.Hi=0}Xi(){this.Hi=this.zi}Zi(t){this.cancel();const e=Math.floor(this.Hi+this.tr()),n=Math.max(0,Date.now()-this.Yi),i=Math.max(0,e-n);i>0&&Oo("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Hi} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Ji=this.Me.enqueueAfterDelay(this.timerId,i,(()=>(this.Yi=Date.now(),t()))),this.Hi*=this.Gi,this.Hi<this.Wi&&(this.Hi=this.Wi),this.Hi>this.zi&&(this.Hi=this.zi)}er(){null!==this.Ji&&(this.Ji.skipDelay(),this.Ji=null)}cancel(){null!==this.Ji&&(this.Ji.cancel(),this.Ji=null)}tr(){return(Math.random()-.5)*this.Hi}}class il{constructor(t,e,n,i,r,s,o,a){this.Me=t,this.nr=n,this.sr=i,this.ir=r,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.rr=0,this.cr=null,this.ar=null,this.stream=null,this.ur=new nl(t,e)}hr(){return 1===this.state||5===this.state||this.lr()}lr(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.dr()}async stop(){this.hr()&&await this.close(0)}wr(){this.state=0,this.ur.reset()}_r(){this.lr()&&null===this.cr&&(this.cr=this.Me.enqueueAfterDelay(this.nr,6e4,(()=>this.mr())))}gr(t){this.yr(),this.stream.send(t)}async mr(){if(this.lr())return this.close(0)}yr(){this.cr&&(this.cr.cancel(),this.cr=null)}pr(){this.ar&&(this.ar.cancel(),this.ar=null)}async close(t,e){this.yr(),this.pr(),this.ur.cancel(),this.rr++,4!==t?this.ur.reset():e&&e.code===Vo.RESOURCE_EXHAUSTED?(Po(e.toString()),Po("Using maximum backoff delay to prevent overloading the backend."),this.ur.Xi()):e&&e.code===Vo.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Tr(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Ni(e)}Tr(){}auth(){this.state=1;const t=this.Er(this.rr),e=this.rr;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.rr===e&&this.Ir(t,n)}),(e=>{t((()=>{const t=new qo(Vo.UNKNOWN,"Fetching auth token failed: "+e.message);return this.Ar(t)}))}))}Ir(t,e){const n=this.Er(this.rr);this.stream=this.Rr(t,e),this.stream.Di((()=>{n((()=>(this.state=2,this.ar=this.Me.enqueueAfterDelay(this.sr,1e4,(()=>(this.lr()&&(this.state=3),Promise.resolve()))),this.listener.Di())))})),this.stream.Ni((t=>{n((()=>this.Ar(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}dr(){this.state=5,this.ur.Zi((async()=>{this.state=0,this.start()}))}Ar(t){return Oo("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Er(t){return e=>{this.Me.enqueueAndForget((()=>this.rr===t?e():(Oo("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class rl extends il{constructor(t,e,n,i,r,s){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,i,s),this.k=r}Rr(t,e){return this.ir.Qi("Listen",t,e)}onMessage(t){this.ur.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const i=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:xo()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(t,e){return t.C?(Uo(void 0===e||"string"==typeof e),ua.fromBase64String(e||"")):(Uo(void 0===e||e instanceof Uint8Array),ua.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(t){const e=void 0===t.code?Vo.UNKNOWN:th(t.code);return new qo(e,t.message||"")}(o);n=new wh(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=Lh(t,i.document.name),s=Dh(i.document.updateTime),o=new Ma({mapValue:{fields:i.document.fields}}),a=Ua.newFoundDocument(r,s,o),c=i.targetIds||[],h=i.removedTargetIds||[];n=new yh(c,h,a.key,a)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=Lh(t,i.document),s=i.readTime?Dh(i.readTime):ea.min(),o=Ua.newNoDocument(r,s),a=i.removedTargetIds||[];n=new yh([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=Lh(t,i.document),s=i.removedTargetIds||[];n=new yh([],s,r,null)}else{if(!("filter"in e))return xo();{e.filter;const t=e.filter;t.targetId;const i=t.count||0,r=new Qc(i),s=t.targetId;n=new vh(s,r)}}return n}(this.k,t),n=function(t){if(!("targetChange"in t))return ea.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?ea.min():e.readTime?Dh(e.readTime):ea.min()}(t);return this.listener.br(e,n)}Pr(t){const e={};e.database=xh(this.k),e.addTarget=function(t,e){let n;const i=e.target;return n=ja(i)?{documents:Vh(t,i)}:{query:qh(t,i)},n.targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Ch(t,e.resumeToken):e.snapshotVersion.compareTo(ea.min())>0&&(n.readTime=Ah(t,e.snapshotVersion.toTimestamp())),n}(this.k,t);const n=function(t,e){const n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return xo()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.k,t);n&&(e.labels=n),this.gr(e)}vr(t){const e={};e.database=xh(this.k),e.removeTarget=t,this.gr(e)}}class sl extends il{constructor(t,e,n,i,r,s){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,i,s),this.k=r,this.Vr=!1}get Sr(){return this.Vr}start(){this.Vr=!1,this.lastStreamToken=void 0,super.start()}Tr(){this.Vr&&this.Dr([])}Rr(t,e){return this.ir.Qi("Write",t,e)}onMessage(t){if(Uo(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Vr){this.ur.reset();const e=function(t,e){return t&&t.length>0?(Uo(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?Dh(t.updateTime):Dh(e);return n.isEqual(ea.min())&&(n=Dh(e)),new Mc(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=Dh(t.commitTime);return this.listener.Cr(n,e)}return Uo(!t.writeResults||0===t.writeResults.length),this.Vr=!0,this.listener.Nr()}kr(){const t={};t.database=xh(this.k),this.gr(t)}Dr(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof Hc)n={update:Fh(t,e.key,e.value)};else if(e instanceof Xc)n={delete:Ph(t,e.key)};else if(e instanceof zc)n={update:Fh(t,e.key,e.data),updateMask:Qh(e.fieldMask)};else{if(!(e instanceof Jc))return xo();n={verify:Ph(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof kc)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ac)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Nc)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Rc)return{fieldPath:e.field.canonicalString(),increment:n.N};throw xo()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Nh(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:xo()}(t,e.precondition)),n}(this.k,t)))};this.gr(e)}}class ol extends class{}{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.ir=n,this.k=i,this.$r=!1}Or(){if(this.$r)throw new qo(Vo.FAILED_PRECONDITION,"The client has already been terminated.")}Bi(t,e,n){return this.Or(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,r])=>this.ir.Bi(t,e,n,i,r))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Vo.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new qo(Vo.UNKNOWN,t.toString())}))}ji(t,e,n){return this.Or(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,r])=>this.ir.ji(t,e,n,i,r))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Vo.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new qo(Vo.UNKNOWN,t.toString())}))}terminate(){this.$r=!0}}class al{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.Mr=0,this.Fr=null,this.Lr=!0}Br(){0===this.Mr&&(this.Ur("Unknown"),this.Fr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.Fr=null,this.qr("Backend didn't respond within 10 seconds."),this.Ur("Offline"),Promise.resolve()))))}Kr(t){"Online"===this.state?this.Ur("Unknown"):(this.Mr++,this.Mr>=1&&(this.jr(),this.qr(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.Ur("Offline")))}set(t){this.jr(),this.Mr=0,"Online"===t&&(this.Lr=!1),this.Ur(t)}Ur(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}qr(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.Lr?(Po(e),this.Lr=!1):Oo("OnlineStateTracker",e)}jr(){null!==this.Fr&&(this.Fr.cancel(),this.Fr=null)}}class cl{constructor(t,e,n,i,r){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Qr=[],this.Wr=new Map,this.Gr=new Set,this.zr=[],this.Hr=r,this.Hr.Ei((t=>{n.enqueueAndForget((async()=>{yl(this)&&(Oo("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=Fo(t);e.Gr.add(4),await ul(e),e.Jr.set("Unknown"),e.Gr.delete(4),await hl(e)}(this))}))})),this.Jr=new al(n,i)}}async function hl(t){if(yl(t))for(const e of t.zr)await e(!0)}async function ul(t){for(const e of t.zr)await e(!1)}function ll(t,e){const n=Fo(t);n.Wr.has(e.targetId)||(n.Wr.set(e.targetId,e),gl(n)?ml(n):Pl(n).lr()&&fl(n,e))}function dl(t,e){const n=Fo(t),i=Pl(n);n.Wr.delete(e),i.lr()&&pl(n,e),0===n.Wr.size&&(i.lr()?i._r():yl(n)&&n.Jr.set("Unknown"))}function fl(t,e){t.Yr.X(e.targetId),Pl(t).Pr(e)}function pl(t,e){t.Yr.X(e),Pl(t).vr(e)}function ml(t){t.Yr=new Ih({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.Wr.get(e)||null}),Pl(t).start(),t.Jr.Br()}function gl(t){return yl(t)&&!Pl(t).hr()&&t.Wr.size>0}function yl(t){return 0===Fo(t).Gr.size}function vl(t){t.Yr=void 0}async function wl(t){t.Wr.forEach(((e,n)=>{fl(t,e)}))}async function Tl(t,e){vl(t),gl(t)?(t.Jr.Kr(e),ml(t)):t.Jr.set("Unknown")}async function Il(t,e,n){if(t.Jr.set("Online"),e instanceof wh&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const i of e.targetIds)t.Wr.has(i)&&(await t.remoteSyncer.rejectListen(i,n),t.Wr.delete(i),t.Yr.removeTarget(i))}(t,e)}catch(n){Oo("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await bl(t,n)}else if(e instanceof yh?t.Yr.ot(e):e instanceof vh?t.Yr.dt(e):t.Yr.ut(e),!n.isEqual(ea.min()))try{const e=await Pu(t.localStore);n.compareTo(e)>=0&&await function(t,e){const n=t.Yr.gt(e);return n.targetChanges.forEach(((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const r=t.Wr.get(i);r&&t.Wr.set(i,r.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((e=>{const n=t.Wr.get(e);if(!n)return;t.Wr.set(e,n.withResumeToken(ua.EMPTY_BYTE_STRING,n.snapshotVersion)),pl(t,e);const i=new wu(n.target,e,1,n.sequenceNumber);fl(t,i)})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)}catch(e){Oo("RemoteStore","Failed to raise snapshot:",e),await bl(t,e)}}async function bl(t,e,n){if(!gu(e))throw e;t.Gr.add(1),await ul(t),t.Jr.set("Offline"),n||(n=()=>Pu(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Oo("RemoteStore","Retrying IndexedDB access"),await n(),t.Gr.delete(1),await hl(t)}))}function El(t,e){return e().catch((n=>bl(t,n,e)))}async function _l(t){const e=Fo(t),n=Ll(e);let i=e.Qr.length>0?e.Qr[e.Qr.length-1].batchId:-1;for(;Sl(e);)try{const t=await Lu(e.localStore,i);if(null===t){0===e.Qr.length&&n._r();break}i=t.batchId,kl(e,t)}catch(t){await bl(e,t)}Al(e)&&Cl(e)}function Sl(t){return yl(t)&&t.Qr.length<10}function kl(t,e){t.Qr.push(e);const n=Ll(t);n.lr()&&n.Sr&&n.Dr(e.mutations)}function Al(t){return yl(t)&&!Ll(t).hr()&&t.Qr.length>0}function Cl(t){Ll(t).start()}async function Nl(t){Ll(t).kr()}async function Dl(t){const e=Ll(t);for(const n of t.Qr)e.Dr(n.mutations)}async function Rl(t,e,n){const i=t.Qr.shift(),r=vu.from(i,e,n);await El(t,(()=>t.remoteSyncer.applySuccessfulWrite(r))),await _l(t)}async function Ol(t,e){e&&Ll(t).Sr&&await async function(t,e){if(function(t){switch(t){default:return xo();case Vo.CANCELLED:case Vo.UNKNOWN:case Vo.DEADLINE_EXCEEDED:case Vo.RESOURCE_EXHAUSTED:case Vo.INTERNAL:case Vo.UNAVAILABLE:case Vo.UNAUTHENTICATED:return!1;case Vo.INVALID_ARGUMENT:case Vo.NOT_FOUND:case Vo.ALREADY_EXISTS:case Vo.PERMISSION_DENIED:case Vo.FAILED_PRECONDITION:case Vo.ABORTED:case Vo.OUT_OF_RANGE:case Vo.UNIMPLEMENTED:case Vo.DATA_LOSS:return!0}}(n=e.code)&&n!==Vo.ABORTED){const n=t.Qr.shift();Ll(t).wr(),await El(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await _l(t)}var n}(t,e),Al(t)&&Cl(t)}function Pl(t){return t.Xr||(t.Xr=function(t,e,n){const i=Fo(t);return i.Or(),new rl(e,i.ir,i.authCredentials,i.appCheckCredentials,i.k,n)}(t.datastore,t.asyncQueue,{Di:wl.bind(null,t),Ni:Tl.bind(null,t),br:Il.bind(null,t)}),t.zr.push((async e=>{e?(t.Xr.wr(),gl(t)?ml(t):t.Jr.set("Unknown")):(await t.Xr.stop(),vl(t))}))),t.Xr}function Ll(t){return t.Zr||(t.Zr=function(t,e,n){const i=Fo(t);return i.Or(),new sl(e,i.ir,i.authCredentials,i.appCheckCredentials,i.k,n)}(t.datastore,t.asyncQueue,{Di:Nl.bind(null,t),Ni:Ol.bind(null,t),Nr:Dl.bind(null,t),Cr:Rl.bind(null,t)}),t.zr.push((async e=>{e?(t.Zr.wr(),await _l(t)):(await t.Zr.stop(),t.Qr.length>0&&(Oo("RemoteStore",`Stopping write stream with ${t.Qr.length} pending writes`),t.Qr=[]))}))),t.Zr}class Ml{constructor(t,e,n,i,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new Bo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}static createAndSchedule(t,e,n,i,r){const s=Date.now()+n,o=new Ml(t,e,s,i,r);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new qo(Vo.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function xl(t,e){if(Po("AsyncQueue",`${e}: ${t}`),gu(t))return new qo(Vo.UNAVAILABLE,`${e}: ${t}`);throw t}class Ul{constructor(t){this.comparator=t?(e,n)=>t(e,n)||Ta.comparator(e.key,n.key):(t,e)=>Ta.comparator(t.key,e.key),this.keyedMap=hh(),this.sortedSet=new eh(this.comparator)}static emptySet(t){return new Ul(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof Ul))return!1;if(this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(!t.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new Ul;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class Fl{constructor(){this.eo=new eh(Ta.comparator)}track(t){const e=t.doc.key,n=this.eo.get(e);n?0!==t.type&&3===n.type?this.eo=this.eo.insert(e,t):3===t.type&&1!==n.type?this.eo=this.eo.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.eo=this.eo.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.eo=this.eo.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.eo=this.eo.remove(e):1===t.type&&2===n.type?this.eo=this.eo.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.eo=this.eo.insert(e,{type:2,doc:t.doc}):xo():this.eo=this.eo.insert(e,t)}no(){const t=[];return this.eo.inorderTraversal(((e,n)=>{t.push(n)})),t}}class Vl{constructor(t,e,n,i,r,s,o,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=r,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a}static fromInitialDocuments(t,e,n,i){const r=[];return e.forEach((t=>{r.push({type:0,doc:t})})),new Vl(t,e,Ul.emptySet(e),r,n,i,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&fc(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let t=0;t<e.length;t++)if(e[t].type!==n[t].type||!e[t].doc.isEqual(n[t].doc))return!1;return!0}}class ql{constructor(){this.so=void 0,this.listeners=[]}}class Bl{constructor(){this.queries=new Au((t=>pc(t)),fc),this.onlineState="Unknown",this.io=new Set}}function jl(t,e){const n=Fo(t);let i=!1;for(const t of e){const e=t.query,r=n.queries.get(e);if(r){for(const e of r.listeners)e.oo(t)&&(i=!0);r.so=t}}i&&Hl(n)}function Gl(t,e,n){const i=Fo(t),r=i.queries.get(e);if(r)for(const t of r.listeners)t.onError(n);i.queries.delete(e)}function Hl(t){t.io.forEach((t=>{t.next()}))}class zl{constructor(t,e,n){this.query=t,this.co=e,this.ao=!1,this.uo=null,this.onlineState="Unknown",this.options=n||{}}oo(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new Vl(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}let e=!1;return this.ao?this.ho(t)&&(this.co.next(t),e=!0):this.lo(t,this.onlineState)&&(this.fo(t),e=!0),this.uo=t,e}onError(t){this.co.error(t)}ro(t){this.onlineState=t;let e=!1;return this.uo&&!this.ao&&this.lo(this.uo,t)&&(this.fo(this.uo),e=!0),e}lo(t,e){if(!t.fromCache)return!0;const n="Offline"!==e;return!(this.options.wo&&n||t.docs.isEmpty()&&"Offline"!==e)}ho(t){if(t.docChanges.length>0)return!0;const e=this.uo&&this.uo.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}fo(t){t=Vl.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.ao=!0,this.co.next(t)}}class Kl{constructor(t){this.key=t}}class $l{constructor(t){this.key=t}}class Wl{constructor(t,e){this.query=t,this.To=e,this.Eo=null,this.current=!1,this.Io=dh(),this.mutatedKeys=dh(),this.Ao=yc(t),this.Ro=new Ul(this.Ao)}get bo(){return this.To}Po(t,e){const n=e?e.vo:new Fl,i=e?e.Ro:this.Ro;let r=e?e.mutatedKeys:this.mutatedKeys,s=i,o=!1;const a=oc(this.query)&&i.size===this.query.limit?i.last():null,c=ac(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(((t,e)=>{const h=i.get(t),u=gc(this.query,e)?e:null,l=!!h&&this.mutatedKeys.has(h.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;h&&u?h.data.isEqual(u.data)?l!==d&&(n.track({type:3,doc:u}),f=!0):this.Vo(h,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.Ao(u,a)>0||c&&this.Ao(u,c)<0)&&(o=!0)):!h&&u?(n.track({type:0,doc:u}),f=!0):h&&!u&&(n.track({type:1,doc:h}),f=!0,(a||c)&&(o=!0)),f&&(u?(s=s.add(u),r=d?r.add(t):r.delete(t)):(s=s.delete(t),r=r.delete(t)))})),oc(this.query)||ac(this.query))for(;s.size>this.query.limit;){const t=oc(this.query)?s.last():s.first();s=s.delete(t.key),r=r.delete(t.key),n.track({type:1,doc:t})}return{Ro:s,vo:n,Bn:o,mutatedKeys:r}}Vo(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n){const i=this.Ro;this.Ro=t.Ro,this.mutatedKeys=t.mutatedKeys;const r=t.vo.no();r.sort(((t,e)=>function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xo()}};return n(t)-n(e)}(t.type,e.type)||this.Ao(t.doc,e.doc))),this.So(n);const s=e?this.Do():[],o=0===this.Io.size&&this.current?1:0,a=o!==this.Eo;return this.Eo=o,0!==r.length||a?{snapshot:new Vl(this.query,t.Ro,i,r,t.mutatedKeys,0===o,a,!1),Co:s}:{Co:s}}ro(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({Ro:this.Ro,vo:new Fl,mutatedKeys:this.mutatedKeys,Bn:!1},!1)):{Co:[]}}No(t){return!this.To.has(t)&&!!this.Ro.has(t)&&!this.Ro.get(t).hasLocalMutations}So(t){t&&(t.addedDocuments.forEach((t=>this.To=this.To.add(t))),t.modifiedDocuments.forEach((t=>{})),t.removedDocuments.forEach((t=>this.To=this.To.delete(t))),this.current=t.current)}Do(){if(!this.current)return[];const t=this.Io;this.Io=dh(),this.Ro.forEach((t=>{this.No(t.key)&&(this.Io=this.Io.add(t.key))}));const e=[];return t.forEach((t=>{this.Io.has(t)||e.push(new $l(t))})),this.Io.forEach((n=>{t.has(n)||e.push(new Kl(n))})),e}ko(t){this.To=t.zn,this.Io=dh();const e=this.Po(t.documents);return this.applyChanges(e,!0)}xo(){return Vl.fromInitialDocuments(this.query,this.Ro,this.mutatedKeys,0===this.Eo)}}class Xl{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class Jl{constructor(t){this.key=t,this.$o=!1}}class Ql{constructor(t,e,n,i,r,s){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=s,this.Oo={},this.Mo=new Au((t=>pc(t)),fc),this.Fo=new Map,this.Lo=new Set,this.Bo=new eh(Ta.comparator),this.Uo=new Map,this.qo=new Fu,this.Ko={},this.jo=new Map,this.Qo=Su.re(),this.onlineState="Unknown",this.Wo=void 0}get isPrimaryClient(){return!0===this.Wo}}async function Yl(t,e){const n=function(t){const e=Fo(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=td.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=pd.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=nd.bind(null,e),e.Oo.br=jl.bind(null,e.eventManager),e.Oo.zo=Gl.bind(null,e.eventManager),e}(t);let i,r;const s=n.Mo.get(e);if(s)i=s.targetId,n.sharedClientState.addLocalQueryTarget(i),r=s.view.xo();else{const t=await function(t,e){const n=Fo(t);return n.persistence.runTransaction("Allocate target","readwrite",(t=>{let i;return n.He.getTargetData(t,e).next((r=>r?(i=r,mu.resolve(i)):n.He.allocateTargetId(t).next((r=>(i=new wu(e,r,0,t.currentSequenceNumber),n.He.addTargetData(t,i).next((()=>i)))))))})).then((t=>{const i=n.qn.get(t.targetId);return(null===i||t.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.qn=n.qn.insert(t.targetId,t),n.Kn.set(e,t.targetId)),t}))}(n.localStore,dc(e)),s=n.sharedClientState.addLocalQueryTarget(t.targetId);i=t.targetId,r=await async function(t,e,n,i){t.Go=(e,n,i)=>async function(t,e,n,i){let r=e.view.Po(n);r.Bn&&(r=await xu(t.localStore,e.query,!1).then((({documents:t})=>e.view.Po(t,r))));const s=i&&i.targetChanges.get(e.targetId),o=e.view.applyChanges(r,t.isPrimaryClient,s);return hd(t,e.targetId,o.Co),o.snapshot}(t,e,n,i);const r=await xu(t.localStore,e,!0),s=new Wl(e,r.zn),o=s.Po(r.documents),a=gh.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==t.onlineState),c=s.applyChanges(o,t.isPrimaryClient,a);hd(t,n,c.Co);const h=new Xl(e,n,s);return t.Mo.set(e,h),t.Fo.has(n)?t.Fo.get(n).push(e):t.Fo.set(n,[e]),c.snapshot}(n,e,i,"current"===s),n.isPrimaryClient&&ll(n.remoteStore,t)}return r}async function Zl(t,e){const n=Fo(t),i=n.Mo.get(e),r=n.Fo.get(i.targetId);if(r.length>1)return n.Fo.set(i.targetId,r.filter((t=>!fc(t,e)))),void n.Mo.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Mu(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),dl(n.remoteStore,i.targetId),ad(n,i.targetId)})).catch(ku)):(ad(n,i.targetId),await Mu(n.localStore,i.targetId,!0))}async function td(t,e){const n=Fo(t);try{const t=await function(t,e){const n=Fo(t),i=e.snapshotVersion;let r=n.qn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(t=>{const s=n.Qn.newChangeBuffer({trackRemovals:!0});r=n.qn;const o=[];e.targetChanges.forEach(((s,a)=>{const c=r.get(a);if(!c)return;o.push(n.He.removeMatchingKeys(t,s.removedDocuments,a).next((()=>n.He.addMatchingKeys(t,s.addedDocuments,a))));let h=c.withSequenceNumber(t.currentSequenceNumber);e.targetMismatches.has(a)?h=h.withResumeToken(ua.EMPTY_BYTE_STRING,ea.min()).withLastLimboFreeSnapshotVersion(ea.min()):s.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(s.resumeToken,i)),r=r.insert(a,h),function(t,e,n){return 0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,h,s)&&o.push(n.He.updateTargetData(t,h))}));let a=ah();if(e.documentUpdates.forEach(((i,r)=>{e.resolvedLimboDocuments.has(i)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(t,i))})),o.push(function(t,e,n,i,r){let s=dh();return n.forEach((t=>s=s.add(t))),e.getEntries(t,s).next((t=>{let s=ah();return n.forEach(((n,o)=>{const a=t.get(n),c=(null==r?void 0:r.get(n))||i;o.isNoDocument()&&o.version.isEqual(ea.min())?(e.removeEntry(n,c),s=s.insert(n,o)):!a.isValidDocument()||o.version.compareTo(a.version)>0||0===o.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(o,c),s=s.insert(n,o)):Oo("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",o.version)})),s}))}(t,s,e.documentUpdates,i,void 0).next((t=>{a=t}))),!i.isEqual(ea.min())){const e=n.He.getLastRemoteSnapshotVersion(t).next((e=>n.He.setTargetsMetadata(t,t.currentSequenceNumber,i)));o.push(e)}return mu.waitFor(o).next((()=>s.apply(t))).next((()=>n.Wn.Vn(t,a))).next((()=>a))})).then((t=>(n.qn=r,t)))}(n.localStore,e);e.targetChanges.forEach(((t,e)=>{const i=n.Uo.get(e);i&&(Uo(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?i.$o=!0:t.modifiedDocuments.size>0?Uo(i.$o):t.removedDocuments.size>0&&(Uo(i.$o),i.$o=!1))})),await dd(n,t,e)}catch(t){await ku(t)}}function ed(t,e,n){const i=Fo(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const t=[];i.Mo.forEach(((n,i)=>{const r=i.view.ro(e);r.snapshot&&t.push(r.snapshot)})),function(t,e){const n=Fo(t);n.onlineState=e;let i=!1;n.queries.forEach(((t,n)=>{for(const t of n.listeners)t.ro(e)&&(i=!0)})),i&&Hl(n)}(i.eventManager,e),t.length&&i.Oo.br(t),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function nd(t,e,n){const i=Fo(t);i.sharedClientState.updateQueryState(e,"rejected",n);const r=i.Uo.get(e),s=r&&r.key;if(s){let t=new eh(Ta.comparator);t=t.insert(s,Ua.newNoDocument(s,ea.min()));const n=dh().add(s),r=new mh(ea.min(),new Map,new rh(Yo),t,n);await td(i,r),i.Bo=i.Bo.remove(s),i.Uo.delete(e),ld(i)}else await Mu(i.localStore,e,!1).then((()=>ad(i,e,n))).catch(ku)}async function id(t,e){const n=Fo(t),i=e.batch.batchId;try{const t=await function(t,e){const n=Fo(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const i=e.batch.keys(),r=n.Qn.newChangeBuffer({trackRemovals:!0});return function(t,e,n,i){const r=n.batch,s=r.keys();let o=mu.resolve();return s.forEach((t=>{o=o.next((()=>i.getEntry(e,t))).next((e=>{const s=n.docVersions.get(t);Uo(null!==s),e.version.compareTo(s)<0&&(r.applyToRemoteDocument(e,n),e.isValidDocument()&&i.addEntry(e,n.commitVersion))}))})),o.next((()=>t.An.removeMutationBatch(e,r)))}(n,t,e,r).next((()=>r.apply(t))).next((()=>n.An.performConsistencyCheck(t))).next((()=>n.Wn.vn(t,i)))}))}(n.localStore,e);od(n,i,null),sd(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await dd(n,t)}catch(t){await ku(t)}}async function rd(t,e,n){const i=Fo(t);try{const t=await function(t,e){const n=Fo(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let i;return n.An.lookupMutationBatch(t,e).next((e=>(Uo(null!==e),i=e.keys(),n.An.removeMutationBatch(t,e)))).next((()=>n.An.performConsistencyCheck(t))).next((()=>n.Wn.vn(t,i)))}))}(i.localStore,e);od(i,e,n),sd(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await dd(i,t)}catch(n){await ku(n)}}function sd(t,e){(t.jo.get(e)||[]).forEach((t=>{t.resolve()})),t.jo.delete(e)}function od(t,e,n){const i=Fo(t);let r=i.Ko[i.currentUser.toKey()];if(r){const t=r.get(e);t&&(n?t.reject(n):t.resolve(),r=r.remove(e)),i.Ko[i.currentUser.toKey()]=r}}function ad(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.Fo.get(e))t.Mo.delete(i),n&&t.Oo.zo(i,n);t.Fo.delete(e),t.isPrimaryClient&&t.qo.us(e).forEach((e=>{t.qo.containsKey(e)||cd(t,e)}))}function cd(t,e){t.Lo.delete(e.path.canonicalString());const n=t.Bo.get(e);null!==n&&(dl(t.remoteStore,n),t.Bo=t.Bo.remove(e),t.Uo.delete(n),ld(t))}function hd(t,e,n){for(const i of n)i instanceof Kl?(t.qo.addReference(i.key,e),ud(t,i)):i instanceof $l?(Oo("SyncEngine","Document no longer in limbo: "+i.key),t.qo.removeReference(i.key,e),t.qo.containsKey(i.key)||cd(t,i.key)):xo()}function ud(t,e){const n=e.key,i=n.path.canonicalString();t.Bo.get(n)||t.Lo.has(i)||(Oo("SyncEngine","New document in limbo: "+n),t.Lo.add(i),ld(t))}function ld(t){for(;t.Lo.size>0&&t.Bo.size<t.maxConcurrentLimboResolutions;){const e=t.Lo.values().next().value;t.Lo.delete(e);const n=new Ta(oa.fromString(e)),i=t.Qo.next();t.Uo.set(i,new Jl(n)),t.Bo=t.Bo.insert(n,i),ll(t.remoteStore,new wu(dc(sc(n.path)),i,2,Xo.I))}}async function dd(t,e,n){const i=Fo(t),r=[],s=[],o=[];i.Mo.isEmpty()||(i.Mo.forEach(((t,a)=>{o.push(i.Go(a,e,n).then((t=>{if(t){i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),r.push(t);const e=Nu.$n(a.targetId,t);s.push(e)}})))})),await Promise.all(o),i.Oo.br(r),await async function(t,e){const n=Fo(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>mu.forEach(e,(e=>mu.forEach(e.kn,(i=>n.persistence.referenceDelegate.addReference(t,e.targetId,i))).next((()=>mu.forEach(e.xn,(i=>n.persistence.referenceDelegate.removeReference(t,e.targetId,i)))))))))}catch(t){if(!gu(t))throw t;Oo("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.qn.get(e),i=t.snapshotVersion,r=t.withLastLimboFreeSnapshotVersion(i);n.qn=n.qn.insert(e,r)}}}(i.localStore,s))}async function fd(t,e){const n=Fo(t);if(!n.currentUser.isEqual(e)){Oo("SyncEngine","User change. New user:",e.toKey());const t=await Ou(n.localStore,e);n.currentUser=e,function(t,e){t.jo.forEach((t=>{t.forEach((t=>{t.reject(new qo(Vo.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.jo.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await dd(n,t.Gn)}}function pd(t,e){const n=Fo(t),i=n.Uo.get(e);if(i&&i.$o)return dh().add(i.key);{let t=dh();const i=n.Fo.get(e);if(!i)return t;for(const e of i){const i=n.Mo.get(e);t=t.unionWith(i.view.bo)}return t}}function md(t){const e=Fo(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=id.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=rd.bind(null,e),e}class gd{constructor(){this.synchronizeTabs=!1}async initialize(t){this.k=el(t.databaseInfo.databaseId),this.sharedClientState=this.Jo(t),this.persistence=this.Yo(t),await this.persistence.start(),this.gcScheduler=this.Xo(t),this.localStore=this.Zo(t)}Xo(t){return null}Zo(t){return function(t,e,n,i){return new Ru(t,e,n,i)}(this.persistence,new Du,t.initialUser,this.k)}Yo(t){return new Hu(Ku.ks,this.k)}Jo(t){return new Wu}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class yd{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>ed(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=fd.bind(null,this.syncEngine),await async function(t,e){const n=Fo(t);e?(n.Gr.delete(2),await hl(n)):e||(n.Gr.add(2),await ul(n),n.Jr.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new Bl}createDatastore(t){const e=el(t.databaseInfo.databaseId),n=(i=t.databaseInfo,new Zu(i));var i;return function(t,e,n,i){return new ol(t,e,n,i)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return e=this.localStore,n=this.datastore,i=t.asyncQueue,r=t=>ed(this.syncEngine,t,0),s=Ju.Pt()?new Ju:new Xu,new cl(e,n,i,r,s);var e,n,i,r,s}createSyncEngine(t,e){return function(t,e,n,i,r,s,o){const a=new Ql(t,e,n,i,r,s);return o&&(a.Wo=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return async function(t){const e=Fo(t);Oo("RemoteStore","RemoteStore shutting down."),e.Gr.add(5),await ul(e),e.Hr.shutdown(),e.Jr.set("Unknown")}(this.remoteStore)}}class vd{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.ec(this.observer.next,t)}error(t){this.observer.error?this.ec(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)}nc(){this.muted=!0}ec(t,e){this.muted||setTimeout((()=>{this.muted||t(e)}),0)}}class wd{constructor(t,e,n,i){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=Co.UNAUTHENTICATED,this.clientId=Qo.A(),this.authCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{Oo("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(()=>Promise.resolve()))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new qo(Vo.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Bo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=xl(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function Td(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){return t.offlineComponents||(Oo("FirestoreClient","Using default OfflineComponentProvider"),await async function(t,e){t.asyncQueue.verifyOperationInProgress(),Oo("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async t=>{i.isEqual(t)||(await Ou(e.localStore,t),i=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t.offlineComponents=e}(t,new gd)),t.offlineComponents}(t);Oo("FirestoreClient","Initializing OnlineComponentProvider");const i=await t.getConfiguration();await e.initialize(n,i),t.setCredentialChangeListener((t=>async function(t,e){const n=Fo(t);n.asyncQueue.verifyOperationInProgress(),Oo("RemoteStore","RemoteStore received new credentials");const i=yl(n);n.Gr.add(3),await ul(n),i&&n.Jr.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Gr.delete(3),await hl(n)}(e.remoteStore,t))),t.onlineComponents=e}async function Id(t){return t.onlineComponents||(Oo("FirestoreClient","Using default OnlineComponentProvider"),await Td(t,new yd)),t.onlineComponents}async function bd(t){const e=await Id(t),n=e.eventManager;return n.onListen=Yl.bind(null,e.syncEngine),n.onUnlisten=Zl.bind(null,e.syncEngine),n}class Ed{constructor(t,e,n,i,r,s,o,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class _d{constructor(t,e){this.projectId=t,this.database=e||"(default)"}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof _d&&t.projectId===this.projectId&&t.database===this.database}}const Sd=new Map;function kd(t,e,n){if(!n)throw new qo(Vo.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Ad(t){if(!Ta.isDocumentKey(t))throw new qo(Vo.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Cd(t){if(Ta.isDocumentKey(t))throw new qo(Vo.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Nd(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":xo()}function Dd(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new qo(Vo.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Nd(t);throw new qo(Vo.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}class Rd{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new qo(Vo.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new qo(Vo.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(t,e,n,i){if(!0===e&&!0===i)throw new qo(Vo.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Od{constructor(t,e,n){this._authCredentials=e,this._appCheckCredentials=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Rd({}),this._settingsFrozen=!1,t instanceof _d?this._databaseId=t:(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new qo(Vo.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new _d(t.options.projectId)}(t))}get app(){if(!this._app)throw new qo(Vo.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new qo(Vo.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Rd(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new Go;switch(t.type){case"gapi":const e=t.client;return Uo(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Ko(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new qo(Vo.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=Sd.get(t);e&&(Oo("ComponentProvider","Removing Datastore"),Sd.delete(t),e.terminate())}(this),Promise.resolve()}}class Pd{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Md(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Pd(this.firestore,t,this._key)}}class Ld{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Ld(this.firestore,t,this._query)}}class Md extends Ld{constructor(t,e,n){super(t,e,sc(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Pd(this.firestore,null,new Ta(t))}withConverter(t){return new Md(this.firestore,t,this._path)}}function xd(t,e,...n){if(t=v(t),kd("collection","path",e),t instanceof Od){const i=oa.fromString(e,...n);return Cd(i),new Md(t,null,i)}{if(!(t instanceof Pd||t instanceof Md))throw new qo(Vo.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(oa.fromString(e,...n));return Cd(i),new Md(t.firestore,null,i)}}class Ud{constructor(){this.mc=Promise.resolve(),this.gc=[],this.yc=!1,this.Tc=[],this.Ec=null,this.Ic=!1,this.Ac=!1,this.Rc=[],this.ur=new nl(this,"async_queue_retry"),this.bc=()=>{const t=tl();t&&Oo("AsyncQueue","Visibility state changed to "+t.visibilityState),this.ur.er()};const t=tl();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.bc)}get isShuttingDown(){return this.yc}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.Pc(),this.vc(t)}enterRestrictedMode(t){if(!this.yc){this.yc=!0,this.Ac=t||!1;const e=tl();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.bc)}}enqueue(t){if(this.Pc(),this.yc)return new Promise((()=>{}));const e=new Bo;return this.vc((()=>this.yc&&this.Ac?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.gc.push(t),this.Vc())))}async Vc(){if(0!==this.gc.length){try{await this.gc[0](),this.gc.shift(),this.ur.reset()}catch(t){if(!gu(t))throw t;Oo("AsyncQueue","Operation failed with retryable error: "+t)}this.gc.length>0&&this.ur.Zi((()=>this.Vc()))}}vc(t){const e=this.mc.then((()=>(this.Ic=!0,t().catch((t=>{this.Ec=t,this.Ic=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw Po("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.Ic=!1,t))))));return this.mc=e,e}enqueueAfterDelay(t,e,n){this.Pc(),this.Rc.indexOf(t)>-1&&(e=0);const i=Ml.createAndSchedule(this,t,e,n,(t=>this.Sc(t)));return this.Tc.push(i),i}Pc(){this.Ec&&xo()}verifyOperationInProgress(){}async Dc(){let t;do{t=this.mc,await t}while(t!==this.mc)}Cc(t){for(const e of this.Tc)if(e.timerId===t)return!0;return!1}Nc(t){return this.Dc().then((()=>{this.Tc.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.Tc)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Dc()}))}kc(t){this.Rc.push(t)}Sc(t){const e=this.Tc.indexOf(t);this.Tc.splice(e,1)}}function Fd(t){return function(t,e){if("object"!=typeof t||null===t)return!1;const n=t;for(const t of["next","error","complete"])if(t in n&&"function"==typeof n[t])return!0;return!1}(t)}class Vd extends Od{constructor(t,e,n){super(t,e,n),this.type="firestore",this._queue=new Ud,this._persistenceKey="name"in t?t.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||Bd(this),this._firestoreClient.terminate()}}function qd(t){return t._firestoreClient||Bd(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Bd(t){var e;const n=t._freezeSettings(),i=function(t,e,n,i){return new Ed(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,i.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new wd(t._authCredentials,t._appCheckCredentials,t._queue,i)}class jd{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new qo(Vo.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ca(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Gd{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Gd(ua.fromBase64String(t))}catch(t){throw new qo(Vo.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new Gd(ua.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Hd{constructor(t){this._methodName=t}}class zd{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new qo(Vo.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new qo(Vo.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return Yo(this._lat,t._lat)||Yo(this._long,t._long)}}const Kd=/^__.*__$/;class $d{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new zc(t,this.data,this.fieldMask,e,this.fieldTransforms):new Hc(t,this.data,e,this.fieldTransforms)}}function Wd(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw xo()}}class Xd{constructor(t,e,n,i,r,s){this.settings=t,this.databaseId=e,this.k=n,this.ignoreUndefinedProperties=i,void 0===r&&this.xc(),this.fieldTransforms=r||[],this.fieldMask=s||[]}get path(){return this.settings.path}get $c(){return this.settings.$c}Oc(t){return new Xd(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.k,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mc(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Oc({path:n,Fc:!1});return i.Lc(t),i}Bc(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Oc({path:n,Fc:!1});return i.xc(),i}Uc(t){return this.Oc({path:void 0,Fc:!0})}qc(t){return cf(t,this.settings.methodName,this.settings.Kc||!1,this.path,this.settings.jc)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}xc(){if(this.path)for(let t=0;t<this.path.length;t++)this.Lc(this.path.get(t))}Lc(t){if(0===t.length)throw this.qc("Document fields must not be empty");if(Wd(this.$c)&&Kd.test(t))throw this.qc('Document fields cannot begin and end with "__"')}}class Jd{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.k=n||el(t)}Qc(t,e,n,i=!1){return new Xd({$c:t,methodName:e,jc:n,path:ca.emptyPath(),Fc:!1,Kc:i},this.databaseId,this.k,this.ignoreUndefinedProperties)}}function Qd(t){const e=t._freezeSettings(),n=el(t._databaseId);return new Jd(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Yd(t,e,n,i,r,s={}){const o=t.Qc(s.merge||s.mergeFields?2:0,e,n,r);rf("Data must be an object, but it was:",o,i);const a=ef(i,o);let c,h;if(s.merge)c=new ha(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){const t=[];for(const i of s.mergeFields){const r=sf(e,i,n);if(!o.contains(r))throw new qo(Vo.INVALID_ARGUMENT,`Field '${r}' is specified in your field mask but missing from your input data.`);hf(t,r)||t.push(r)}c=new ha(t),h=o.fieldTransforms.filter((t=>c.covers(t.field)))}else c=null,h=o.fieldTransforms;return new $d(new Ma(a),c,h)}class Zd extends Hd{_toFieldTransform(t){return new Lc(t.path,new kc)}isEqual(t){return t instanceof Zd}}function tf(t,e){if(nf(t=v(t)))return rf("Unsupported field value:",e,t),ef(t,e);if(t instanceof Hd)return function(t,e){if(!Wd(e.$c))throw e.qc(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.qc(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Fc&&4!==e.$c)throw e.qc("Nested arrays are not supported");return function(t,e){const n=[];let i=0;for(const r of t){let t=tf(r,e.Uc(i));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),i++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=v(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Ic(e.k,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=ta.fromDate(t);return{timestampValue:Ah(e.k,n)}}if(t instanceof ta){const n=new ta(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Ah(e.k,n)}}if(t instanceof zd)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Gd)return{bytesValue:Ch(e.k,t._byteString)};if(t instanceof Pd){const n=e.databaseId,i=t.firestore._databaseId;if(!i.isEqual(n))throw e.qc(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Rh(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.qc(`Unsupported field value: ${Nd(t)}`)}(t,e)}function ef(t,e){const n={};return ra(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ia(t,((t,i)=>{const r=tf(i,e.Mc(t));null!=r&&(n[t]=r)})),{mapValue:{fields:n}}}function nf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ta||t instanceof zd||t instanceof Gd||t instanceof Pd||t instanceof Hd)}function rf(t,e,n){if(!nf(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const i=Nd(n);throw"an object"===i?e.qc(t+" a custom object"):e.qc(t+" "+i)}}function sf(t,e,n){if((e=v(e))instanceof jd)return e._internalPath;if("string"==typeof e)return af(t,e);throw cf("Field path arguments must be of type string or ",t,!1,void 0,n)}const of=new RegExp("[~\\*/\\[\\]]");function af(t,e,n){if(e.search(of)>=0)throw cf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new jd(...e.split("."))._internalPath}catch(i){throw cf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function cf(t,e,n,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new qo(Vo.INVALID_ARGUMENT,a+t+c)}function hf(t,e){return t.some((t=>t.isEqual(e)))}class uf{constructor(t,e,n,i,r){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new Pd(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new lf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(df("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class lf extends uf{data(){return super.data()}}function df(t,e){return"string"==typeof e?af(t,e):e instanceof jd?e._internalPath:e._delegate._internalPath}class ff{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class pf extends uf{constructor(t,e,n,i,r,s){super(t,e,n,i,s),this._firestore=t,this._firestoreImpl=t,this.metadata=r}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new mf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(df("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}}class mf extends pf{data(t={}){return super.data(t)}}class gf{constructor(t,e,n,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new ff(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new mf(this._firestore,this._userDataWriter,n.key,n,new ff(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new qo(Vo.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map((n=>({type:"added",doc:new mf(t._firestore,t._userDataWriter,n.doc.key,n.doc,new ff(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:e++})))}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((t=>e||3!==t.type)).map((e=>{const i=new mf(t._firestore,t._userDataWriter,e.doc.key,e.doc,new ff(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let r=-1,s=-1;return 0!==e.type&&(r=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),s=n.indexOf(e.doc.key)),{type:yf(e.type),doc:i,oldIndex:r,newIndex:s}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function yf(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xo()}}class vf{}class wf extends vf{constructor(t,e,n){super(),this.zc=t,this.Hc=e,this.Jc=n,this.type="where"}_apply(t){const e=Qd(t.firestore),n=function(t,e,n,i,r,s,o){let a;if(r.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new qo(Vo.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){bf(o,s);const e=[];for(const n of o)e.push(If(i,t,n));a={arrayValue:{values:e}}}else a=If(i,t,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||bf(o,s),a=function(t,e,n,i=!1){return tf(n,t.Qc(i?4:3,e))}(n,"where",o,"in"===s||"not-in"===s);const c=Ga.create(r,s,a);return function(t,e){if(e.V()){const n=hc(t);if(null!==n&&!n.isEqual(e.field))throw new qo(Vo.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${e.field.toString()}'`);const i=cc(t);null!==i&&Ef(0,e.field,i)}const n=function(t,e){for(const n of t.filters)if(e.indexOf(n.op)>=0)return n.op;return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==n)throw n===e.op?new qo(Vo.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new qo(Vo.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}(t,c),c}(t._query,0,e,t.firestore._databaseId,this.zc,this.Hc,this.Jc);return new Ld(t.firestore,t.converter,function(t,e){const n=t.filters.concat([e]);return new rc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))}}class Tf extends vf{constructor(t,e){super(),this.zc=t,this.Yc=e,this.type="orderBy"}_apply(t){const e=function(t,e,n){if(null!==t.startAt)throw new qo(Vo.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new qo(Vo.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const i=new tc(e,n);return function(t,e){if(null===cc(t)){const n=hc(t);null!==n&&Ef(0,n,e.field)}}(t,i),i}(t._query,this.zc,this.Yc);return new Ld(t.firestore,t.converter,function(t,e){const n=t.explicitOrderBy.concat([e]);return new rc(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))}}function If(t,e,n){if("string"==typeof(n=v(n))){if(""===n)throw new qo(Vo.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!uc(e)&&-1!==n.indexOf("/"))throw new qo(Vo.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(oa.fromString(n));if(!Ta.isDocumentKey(i))throw new qo(Vo.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Ca(t,new Ta(i))}if(n instanceof Pd)return Ca(t,n._key);throw new qo(Vo.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Nd(n)}.`)}function bf(t,e){if(!Array.isArray(t)||0===t.length)throw new qo(Vo.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(t.length>10)throw new qo(Vo.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function Ef(t,e,n){if(!n.isEqual(e))throw new qo(Vo.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class _f extends class{convertValue(t,e="none"){switch(Ia(t)){case 0:return null;case 1:return t.booleanValue;case 2:return fa(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(pa(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw xo()}}convertObject(t,e){const n={};return ia(t.fields,((t,i)=>{n[t]=this.convertValue(i,e)})),n}convertGeoPoint(t){return new zd(fa(t.latitude),fa(t.longitude))}convertArray(t,e){return(t.values||[]).map((t=>this.convertValue(t,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=ga(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(ya(t));default:return null}}convertTimestamp(t){const e=da(t);return new ta(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=oa.fromString(t);Uo(Yh(n));const i=new _d(n.get(1),n.get(3)),r=new Ta(n.popFirst(5));return i.isEqual(e)||Po(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),r}}{constructor(t){super(),this.firestore=t}convertBytes(t){return new Gd(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Pd(this.firestore,null,e)}}function Sf(t,e){const n=Dd(t.firestore,Vd),i=function(t,e,...n){if(t=v(t),1===arguments.length&&(e=Qo.A()),kd("doc","path",e),t instanceof Od){const i=oa.fromString(e,...n);return Ad(i),new Pd(t,null,new Ta(i))}{if(!(t instanceof Pd||t instanceof Md))throw new qo(Vo.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(oa.fromString(e,...n));return Ad(i),new Pd(t.firestore,t instanceof Md?t.converter:null,new Ta(i))}}(t),r=function(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}(t.converter,e);return function(t,e){return function(t,e){const n=new Bo;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const i=md(t);try{const t=await function(t,e){const n=Fo(t),i=ta.now(),r=e.reduce(((t,e)=>t.add(e.key)),dh());let s;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>n.Wn.vn(t,r).next((r=>{s=r;const o=[];for(const t of e){const e=Bc(t,s.get(t.key));null!=e&&o.push(new zc(t.key,e,xa(e.value.mapValue),xc.exists(!0)))}return n.An.addMutationBatch(t,i,o,e)})))).then((t=>(t.applyToLocalDocumentSet(s),{batchId:t.batchId,changes:s})))}(i.localStore,e);i.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let i=t.Ko[t.currentUser.toKey()];i||(i=new eh(Yo)),i=i.insert(e,n),t.Ko[t.currentUser.toKey()]=i}(i,t.batchId,n),await dd(i,t.changes),await _l(i.remoteStore)}catch(t){const e=xl(t,"Failed to persist write");n.reject(e)}}(await function(t){return Id(t).then((t=>t.syncEngine))}(t),e,n))),n.promise}(qd(t),e)}(n,[Yd(Qd(t.firestore),"addDoc",i._key,r,null!==t.converter,{}).toMutation(i._key,xc.exists(!1))]).then((()=>i))}!function(t,e=!0){No="9.6.4",V(new w("firestore",((t,{options:n})=>{const i=t.getProvider("app").getImmediate(),r=new Vd(i,new Ho(t.getProvider("auth-internal")),new Wo(t.getProvider("app-check-internal")));return n=Object.assign({useFetchStreams:e},n),r._setSettings(n),r}),"PUBLIC")),z(Ao,"3.4.3",t),z(Ao,"3.4.3","esm2017")}();var kf=n(377);let Af=n.n(kf)()();function Cf(t){return t[Math.floor(Af()*t.length)]}function Nf(t,e){const n=Array.isArray(t)?()=>Cf(t):t;return null!=e&&e.length?Array.from({length:e.length},((t,e)=>n(e))):n(0)}"abcdefghijklmnopqrstuvwxyz".split("").map((t=>t.toUpperCase())).join("");var Df,Rf=["Try to program the GB interface, maybe it will copy the wireless hard drive!","Try to bypass the GB panel, maybe it will synthesize the back-end transmitter!","If we program the protocol, we can get to the SDD application through the virtual RAM pixel!","Use the open-source THX application, then you can quantify the solid state transmitter!","You cant transmit the firewall without copying the 1080p SDD interface!","Ill compress the open-source SAS bandwidth, that should array the FTP port!","programming the alarm wont do anything, we need to hack the solid state ADP transmitter!","calculating the interface wont do anything, we need to bypass the mobile IB panel!","Try to calculate the GB transmitter, maybe it will quantify the online pixel!","If we calculate the circuit, we can get to the HDD driver through the optical XML panel!","navigating the program wont do anything, we need to calculate the cross-platform SMS capacitor!","Try to calculate the JBOD firewall, maybe it will override the redundant port!","If we quantify the alarm, we can get to the FTP pixel through the online SSL interface!","You cant override the capacitor without indexing the bluetooth PNG pixel!","quantifying the microchip wont do anything, we need to index the online SQL hard drive!","connecting the port wont do anything, we need to program the haptic RSS pixel!","We need to back up the 1080p JBOD bandwidth!","If we index the card, we can get to the SMS hard drive through the bluetooth AGP bus!","Ill compress the optical SDD hard drive, that should interface the XSS bandwidth!","You cant copy the feed without compressing the primary JBOD circuit!","If we back up the application, we can get to the TCP bus through the auxiliary FTP hard drive!","Try to override the RSS port, maybe it will quantify the haptic port!","We need to calculate the bluetooth JBOD bus!","bypassing the bus wont do anything, we need to program the wireless SDD driver!","Try to parse the PCI capacitor, maybe it will quantify the bluetooth interface!","copying the monitor wont do anything, we need to synthesize the back-end ADP application!","Try to index the PNG card, maybe it will transmit the neural system!","Try to bypass the SCSI sensor, maybe it will generate the 1080p card!","We need to calculate the open-source SDD driver!","If we reboot the port, we can get to the RSS application through the 1080p SQL microchip!","Use the cross-platform AI system, then you can connect the digital card!","We need to navigate the virtual SSL transmitter!","The JSON hard drive is down, bypass the redundant firewall so we can copy the FTP port!","We need to navigate the haptic JBOD system!","We need to generate the virtual USB pixel!","Ill override the digital ADP alarm, that should microchip the USB firewall!","We need to bypass the redundant RAM pixel!","Ill compress the cross-platform EXE card, that should circuit the AGP sensor!","The AGP protocol is down, compress the open-source card so we can override the XML program!","Ill reboot the bluetooth GB capacitor, that should card the HDD panel!","Ill connect the neural IB matrix, that should array the CSS card!","The EXE matrix is down, transmit the wireless matrix so we can index the RAM pixel!","The THX monitor is down, reboot the auxiliary array so we can parse the XML microchip!","Try to override the HDD firewall, maybe it will generate the open-source panel!","We need to index the digital JBOD bus!","Use the multi-byte THX firewall, then you can back up the digital system!","Use the 1080p IB feed, then you can reboot the haptic feed!","Try to bypass the SAS card, maybe it will transmit the solid state system!","Try to quantify the TCP array, maybe it will index the virtual transmitter!","Ill override the cross-platform PCI port, that should driver the FTP card!","If we override the bandwidth, we can get to the SMTP capacitor through the cross-platform RSS alarm!","Use the redundant AGP transmitter, then you can generate the 1080p circuit!","Use the auxiliary EXE monitor, then you can hack the haptic port!","Try to synthesize the SCSI card, maybe it will back up the 1080p circuit!","We need to transmit the auxiliary GB sensor!","Use the mobile GB transmitter, then you can quantify the wireless system!","Try to quantify the SQL application, maybe it will bypass the primary pixel!","You cant override the protocol without programming the mobile RAM card!","The JBOD port is down, program the wireless array so we can input the PCI program!","Use the auxiliary JSON card, then you can copy the optical matrix!","We need to calculate the wireless TCP circuit!","Use the back-end AI firewall, then you can parse the optical program!","navigating the hard drive wont do anything, we need to synthesize the auxiliary USB circuit!","Ill quantify the redundant TCP bus, that should hard drive the ADP bandwidth!","If we back up the sensor, we can get to the JBOD matrix through the optical EXE alarm!","Try to generate the TCP bus, maybe it will override the neural bandwidth!","The ADP protocol is down, parse the 1080p card so we can reboot the ADP application!","calculating the driver wont do anything, we need to generate the optical SMTP feed!","Ill calculate the 1080p XML transmitter, that should alarm the RSS firewall!","You cant connect the interface without programming the virtual PNG protocol!","Use the cross-platform THX array, then you can parse the primary capacitor!","generating the sensor wont do anything, we need to hack the solid state AI bus!","Try to calculate the JBOD program, maybe it will synthesize the mobile system!","We need to program the back-end PNG pixel!","Ill program the virtual XML microchip, that should transmitter the SDD protocol!","If we hack the firewall, we can get to the USB application through the bluetooth SDD system!","Use the auxiliary SDD system, then you can input the redundant hard drive!","The GB port is down, quantify the mobile circuit so we can hack the SMTP system!","You cant quantify the driver without transmitting the multi-byte SQL microchip!","Try to parse the SMTP array, maybe it will generate the multi-byte port!","copying the system wont do anything, we need to calculate the virtual SSL circuit!","Use the bluetooth TCP capacitor, then you can reboot the open-source hard drive!","If we navigate the card, we can get to the ADP array through the open-source IB feed!","Try to input the HTTP feed, maybe it will reboot the mobile capacitor!","If we input the driver, we can get to the RAM monitor through the 1080p GB bus!","Ill calculate the wireless ADP port, that should bandwidth the SSL microchip!","Use the haptic XSS driver, then you can connect the wireless program!","quantifying the circuit wont do anything, we need to parse the back-end FTP interface!","Ill reboot the online COM interface, that should system the THX protocol!","Try to transmit the HTTP card, maybe it will override the multi-byte hard drive!","Ill program the back-end THX matrix, that should interface the HDD panel!","Ill generate the virtual SQL protocol, that should bus the AI hard drive!","We need to calculate the mobile AGP panel!","Ill compress the back-end PCI circuit, that should monitor the PNG driver!","We need to quantify the primary TCP matrix!","Ill synthesize the primary AI capacitor, that should array the JBOD sensor!","You cant hack the card without indexing the primary XSS capacitor!","The TCP feed is down, compress the cross-platform alarm so we can synthesize the XSS array!","The JSON interface is down, hack the haptic transmitter so we can bypass the XML system!","Use the online SDD protocol, then you can parse the open-source bandwidth!"];null==(Df=Object.keys({china:["Peking roasted duck","Kung pao chicken","Sweet and sour pork","Hot pot","Dim sum","Dumplings","Ma po tofu","Char siu","Chicken chow mein","Beef chow mein","vegetable chow mein","Chicken fried rice","Beef fried rice","Vegetable fried Rice","Special fried Rice","Sichuan pork","Xiaolongbao","Zhajiangmian","Wonton soup","Sweet and sour pork","Duck spring Rolls","Vegetable spring Rolls","Wonton","Peking duck","Lamb hot pot","Spicy crayfish","Guilin rice noodles","Lanzhou hand-pulled noodles","Steamed crab","Shredded pork with garlic sauce","Red braised pork","Sweet and sour Ribs","Xinjiang","Braised pork with vermicelli"],italy:["Butternut squash risotto","Mushroom risotto","Beetroot risotto","Courgette risotto","Pizza","Gnocchi","Spaghetti bolognese","Spaghetti carbonara","Pesto alla Genovese","Beef lasagne","Vegetable lasagne","Gelato","Prosciutto di Parma","Ribollita","Bagna cauda","Polenta","Tortelli and ravioli","Focaccia","Garlic bread","Arancini","Il tartufo","Panzerotto fritto","Fiorentina","Minestrone","Frico","Arrosticini","Olive ascolante","Fritto misto piemontes","Tiramis"],india:["Biryani","Dosa","Tandoori chicken","Samosas","Chaat","Plain naan","Garlic naan","Pilau rice","Steamed rice","Chicken madras","Vegetable madras","Chicken vindaloo","Chicken jalfrezi","Chicken roghan josh","Lamb roghan josh","Beef roghan josh","Butter chicken","Dosa","Gulab jamun","Chicken korma","Mutter paneer","Papadum","Paratha","Raita","Saag paneer","Tandoori chicken","Chicken tikka masala","Pakora","Dal","Chapati","Pasanda","Aloo gobi","Kofta","Chicken makhani","Paneer naan","Chana Aloo Curry"],mexico:["Chilaquiles","Pozole","Tacos al pastor","Tostadas","Chiles en nogada","Elote","Enchiladas","Mole","Guacamole","Tamales","Huevos rancheros","Machaca","Discada","Beef Burrito","Chicken Burrito","Pozole de pollo o duajolote","Menudo","Cochinita pibil","Tamale","Quesadilla","Frijoles puercos","Chile en nogada","Esquites","Alegria de amaranto","Pipin","Aguachile","Ceviche","Pescado zarandeado","Camarones a la diabla","Birria de chivo","Tlayuda","Guacamole con chapulines","Flautas","Torta Ahogada","Carnitas","Caldo Azteca","Gorditas de Nata"],japan:["Sushi","Udon","Tofu","Tempura","Yakitori","Sashimi","Ramen","Donburi","Natto","Oden","Tamagoyaki","Soba","Tonkatsu","Kashipan","Sukiyaki","Miso soup","Okonomiyaki","Mentaiko","Nikujaga","Unagi no kabayaki","Shabu Shabu","Onigiri","Gyoza","Takoyaki","aiseki ryori","Edamame","Yakisoba","Chawanmushi","Wagashi"],france:["Foie gras","Hutres","Cassoulet","Poulet basquaise","Escargots au beurre persill","Mouclade charentaise","Galettes bretonnes","Flemish carbonnade","Quiche lorraine","Raclette","Cheese fondue","Beef fondue","Gratin dauphinois","Tartiflette","Bouillabaisse","Ratatouille","Boeuf bourguignon","Blanquette de veau","Pot-au-feu","Coq-au-vin","Hachis parmentier","Steak tartare","Choucroute","Souffl au fromage","Cuisses de grenouilles","Soupe  loignon","Baguette","Croissant","French cheeses","Fondant au chocolat","Tarte tatin","Macarons","Crme brle","le flottante","Profiteroles","Pain au chocolat"],lebanon:["Kibbeh","Kafta","Kanafeh","Hummus","Rice pilaf","Fattoush","Manakish","Tabbouleh","Sfeeha","Fattoush","Labneh","Muhammara","Lahm bi ajin","Kaak","Chanklich","Mssabaha","Shawarma","Kebbe","Falafel","Halewit el jeben","Namoura","Maamoul","Foul mdammas","Balila","Kawarma","Fattouch"],thailand:["Pad kra pao moo","Tom kha gai","Khao Pad","Chicken pad Thai","Vegetable pad Thai","Moo satay","Tom yum goong","Khao niew mamuang","Kai yad sai","Khao soi","Pad see ew","Laab moo","Gaeng panang","Gai pad med ma muang","Som tam","Poh pia tod","Gaeng massaman","Pla kapung nueng manao","Tod mun pla","Gaeng ped","Gaeng garee","Gaeng keow wan","Moo ping","Durian","Sai ooah","Hoy tod","Kuay teow reua","Mu kratha","Kao ka moo","Yam nua"],greece:["Moussaka","Papoutsakia","Pastitsio","Souvlaki","Soutzoukakia","Stifado","Tomatokeftedes","Tzatziki","Kolokithokeftedes","Giouvetsi","Choriatiki","Kleftiko","Gemista","Fasolada","Bougatsa","Tiropita","Spanakopita","Feta Cheese with Honey","Horta","Tirokroketes","Briam","Saganaki","Gigantes","Dolmades","Fasolatha","Koulouri","Loukoumades","Gyros","Galaktoboureko","Baklava"],turkey:["i kebap","Dner","Kfte","Pide","Kumpir","Meze","Mant","Lahmacun","Menemen","i kebap","skender kebab","Corba","Kuzu tandir","i Kfte","Pilav","Yaprak sarma","Dolma","mam bayld","Borek","Durum","Kumpir","Balik ekmek","Simit","Kunefe","Baklava","Lokum","Halva","Mozzaik pasta","Glla","Mercimek Kftesi","Haydari","Tursu suyu","Kahvalti","Kazan dibi","Hunkar begendi","Islak burgers","Salep","Yogurtlu kebab"]}))||Df.length,function(t,e={}){"object"!=typeof e&&(e={name:e});const n=Object.assign({name:"[DEFAULT]",automaticDataCollectionEnabled:!1},e),i=n.name;if("string"!=typeof i||!i)throw B.create("bad-app-name",{appName:String(i)});const r=x.get(i);if(r){if(l(t,r.options)&&l(n,r.config))return r;throw B.create("duplicate-app",{appName:i})}const s=new b(i);for(const t of U.values())s.addComponent(t);const o=new j(t,n,s);x.set(i,o)}({apiKey:"AIzaSyBKTDzmJAPUli0WltkPXzq_j-0nPEXQgk0",authDomain:"fir-withfireship.firebaseapp.com",projectId:"fir-withfireship",storageBucket:"fir-withfireship.appspot.com",messagingSenderId:"387304577057",appId:"1:387304577057:web:62875e0645d449df95ab60",measurementId:"G-VD0E7C0T46"});const Of=function(t=H()){const e=q(t,"auth");return e.isInitialized()?e.getImmediate():function(t,e){const n=q(t,"auth");if(n.isInitialized()){const t=n.getImmediate();if(l(n.getOptions(),null!=e?e:{}))return t;Q(t,"already-initialized")}return n.initialize({options:e})}(t,{popupRedirectResolver:ln,persistence:[Oe,me,ye]})}(),Pf=document.getElementById("isSignedIn"),Lf=document.getElementById("isSignedOut"),Mf=document.getElementById("loginbtn"),xf=document.getElementById("logoutBtn"),Uf=document.getElementById("userDetails"),Ff=new se;Mf.onclick=()=>async function(t,e,n){const i=Kt(t);!function(t,e,n){if(!(e instanceof n))throw n.name!==e.constructor.name&&Q(t,"argument-error"),Z(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(t,e,ne);const r=Me(i,void 0);return new je(i,"signInViaPopup",e,r).executeNotNull()}(Of,Ff),xf.onclick=()=>{!function(t){v(t).signOut()}(Of),window.location.reload()},Of.onAuthStateChanged((t=>{t?(Pf.hidden=!1,Lf.hidden=!0,xf.hidden=!1,Bf.hidden=!1,Uf.innerHTML=`<h2>Hello ${t.displayName}!</h2>`):(Pf.hidden=!0,Lf.hidden=!1,Uf.innerHTML="")}));const Vf=function(t=H()){return q(t,"firestore").getImmediate()}(),qf=document.getElementById("alternateList"),Bf=document.getElementById("createAlternate");let jf;Of.onAuthStateChanged((t=>{if(t){Bf.onclick=()=>{Sf(xd(Vf,"Alternates"),{uid:t.uid,moto:Nf(Rf,undefined),createdAt:new Zd("serverTimestamp")})};const e=function(t,...e){for(const n of e)t=n._apply(t);return t}(xd(Vf,"Alternates"),function(t,e,n){const i=df("where","uid");return new wf(i,"==",n)}(0,0,t.uid),function(t,e="asc"){const n=e,i=df("orderBy","createdAt");return new Tf(i,n)}());jf=function(t,...e){var n,i,r;t=v(t);let s={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||Fd(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(Fd(e[o])){const t=e[o];e[o]=null===(n=t.next)||void 0===n?void 0:n.bind(t),e[o+1]=null===(i=t.error)||void 0===i?void 0:i.bind(t),e[o+2]=null===(r=t.complete)||void 0===r?void 0:r.bind(t)}let c,h,u;if(t instanceof Pd)h=Dd(t.firestore,Vd),u=sc(t._key.path),c={next:n=>{e[o]&&e[o](function(t,e,n){const i=n.docs.get(e._key),r=new _f(t);return new pf(t,r,e._key,i,new ff(n.hasPendingWrites,n.fromCache),e.converter)}(h,t,n))},error:e[o+1],complete:e[o+2]};else{const n=Dd(t,Ld);h=Dd(n.firestore,Vd),u=n._query;const i=new _f(h);c={next:t=>{e[o]&&e[o](new gf(h,i,n,t))},error:e[o+1],complete:e[o+2]},function(t){if(ac(t)&&0===t.explicitOrderBy.length)throw new qo(Vo.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(t._query)}return function(t,e,n,i){const r=new vd(i),s=new zl(e,r,n);return t.asyncQueue.enqueueAndForget((async()=>async function(t,e){const n=Fo(t),i=e.query;let r=!1,s=n.queries.get(i);if(s||(r=!0,s=new ql),r)try{s.so=await n.onListen(i)}catch(t){const n=xl(t,`Initialization of query '${mc(e.query)}' failed`);return void e.onError(n)}n.queries.set(i,s),s.listeners.push(e),e.ro(n.onlineState),s.so&&e.oo(s.so)&&Hl(n)}(await bd(t),s))),()=>{r.nc(),t.asyncQueue.enqueueAndForget((async()=>async function(t,e){const n=Fo(t),i=e.query;let r=!1;const s=n.queries.get(i);if(s){const t=s.listeners.indexOf(e);t>=0&&(s.listeners.splice(t,1),r=0===s.listeners.length)}if(r)return n.queries.delete(i),n.onUnlisten(i)}(await bd(t),s)))}}(qd(h),u,a,c)}(e,(t=>{const e=[];t.forEach((t=>{e.push(`<li>${t.data().moto}</li>`)})),qf.innerHTML=e.join("")}))}else jf&&jf()}))})()})();